var $h=g=>{throw TypeError(g)};var hl=(g,t,e)=>t.has(g)||$h("Cannot "+e);var Xe=(g,t,e)=>(hl(g,t,"read from private field"),e?e.call(g):t.get(g)),Pi=(g,t,e)=>t.has(g)?$h("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(g):t.set(g,e),Ss=(g,t,e,s)=>(hl(g,t,"write to private field"),s?s.call(g,e):t.set(g,e),e),qr=(g,t,e)=>(hl(g,t,"access private method"),e);var Vh=(g,t,e,s)=>({set _(r){Ss(g,t,r,e)},get _(){return Xe(g,t,s)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function e(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=e(r);fetch(r.href,o)}})();function Ad(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var dl={exports:{}},bs={},fl={exports:{}},At={},Gh;function Xp(){if(Gh)return At;Gh=1;/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g=Symbol.for("react.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function y(T){return T===null||typeof T!="object"?null:(T=v&&T[v]||T["@@iterator"],typeof T=="function"?T:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,S={};function x(T,F,nt){this.props=T,this.context=F,this.refs=S,this.updater=nt||w}x.prototype.isReactComponent={},x.prototype.setState=function(T,F){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,F,"setState")},x.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function E(){}E.prototype=x.prototype;function M(T,F,nt){this.props=T,this.context=F,this.refs=S,this.updater=nt||w}var P=M.prototype=new E;P.constructor=M,_(P,x.prototype),P.isPureReactComponent=!0;var N=Array.isArray,D=Object.prototype.hasOwnProperty,B={current:null},H={key:!0,ref:!0,__self:!0,__source:!0};function Z(T,F,nt){var pt,wt={},ct=null,ot=null;if(F!=null)for(pt in F.ref!==void 0&&(ot=F.ref),F.key!==void 0&&(ct=""+F.key),F)D.call(F,pt)&&!H.hasOwnProperty(pt)&&(wt[pt]=F[pt]);var bt=arguments.length-2;if(bt===1)wt.children=nt;else if(1<bt){for(var Pt=Array(bt),ce=0;ce<bt;ce++)Pt[ce]=arguments[ce+2];wt.children=Pt}if(T&&T.defaultProps)for(pt in bt=T.defaultProps,bt)wt[pt]===void 0&&(wt[pt]=bt[pt]);return{$$typeof:g,type:T,key:ct,ref:ot,props:wt,_owner:B.current}}function it(T,F){return{$$typeof:g,type:T.type,key:F,ref:T.ref,props:T.props,_owner:T._owner}}function gt(T){return typeof T=="object"&&T!==null&&T.$$typeof===g}function ft(T){var F={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(nt){return F[nt]})}var St=/\/+/g;function xt(T,F){return typeof T=="object"&&T!==null&&T.key!=null?ft(""+T.key):F.toString(36)}function yt(T,F,nt,pt,wt){var ct=typeof T;(ct==="undefined"||ct==="boolean")&&(T=null);var ot=!1;if(T===null)ot=!0;else switch(ct){case"string":case"number":ot=!0;break;case"object":switch(T.$$typeof){case g:case t:ot=!0}}if(ot)return ot=T,wt=wt(ot),T=pt===""?"."+xt(ot,0):pt,N(wt)?(nt="",T!=null&&(nt=T.replace(St,"$&/")+"/"),yt(wt,F,nt,"",function(ce){return ce})):wt!=null&&(gt(wt)&&(wt=it(wt,nt+(!wt.key||ot&&ot.key===wt.key?"":(""+wt.key).replace(St,"$&/")+"/")+T)),F.push(wt)),1;if(ot=0,pt=pt===""?".":pt+":",N(T))for(var bt=0;bt<T.length;bt++){ct=T[bt];var Pt=pt+xt(ct,bt);ot+=yt(ct,F,nt,Pt,wt)}else if(Pt=y(T),typeof Pt=="function")for(T=Pt.call(T),bt=0;!(ct=T.next()).done;)ct=ct.value,Pt=pt+xt(ct,bt++),ot+=yt(ct,F,nt,Pt,wt);else if(ct==="object")throw F=String(T),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.");return ot}function Mt(T,F,nt){if(T==null)return T;var pt=[],wt=0;return yt(T,pt,"","",function(ct){return F.call(nt,ct,wt++)}),pt}function G(T){if(T._status===-1){var F=T._result;F=F(),F.then(function(nt){(T._status===0||T._status===-1)&&(T._status=1,T._result=nt)},function(nt){(T._status===0||T._status===-1)&&(T._status=2,T._result=nt)}),T._status===-1&&(T._status=0,T._result=F)}if(T._status===1)return T._result.default;throw T._result}var X={current:null},V={transition:null},tt={ReactCurrentDispatcher:X,ReactCurrentBatchConfig:V,ReactCurrentOwner:B};function W(){throw Error("act(...) is not supported in production builds of React.")}return At.Children={map:Mt,forEach:function(T,F,nt){Mt(T,function(){F.apply(this,arguments)},nt)},count:function(T){var F=0;return Mt(T,function(){F++}),F},toArray:function(T){return Mt(T,function(F){return F})||[]},only:function(T){if(!gt(T))throw Error("React.Children.only expected to receive a single React element child.");return T}},At.Component=x,At.Fragment=e,At.Profiler=r,At.PureComponent=M,At.StrictMode=s,At.Suspense=h,At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tt,At.act=W,At.cloneElement=function(T,F,nt){if(T==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+T+".");var pt=_({},T.props),wt=T.key,ct=T.ref,ot=T._owner;if(F!=null){if(F.ref!==void 0&&(ct=F.ref,ot=B.current),F.key!==void 0&&(wt=""+F.key),T.type&&T.type.defaultProps)var bt=T.type.defaultProps;for(Pt in F)D.call(F,Pt)&&!H.hasOwnProperty(Pt)&&(pt[Pt]=F[Pt]===void 0&&bt!==void 0?bt[Pt]:F[Pt])}var Pt=arguments.length-2;if(Pt===1)pt.children=nt;else if(1<Pt){bt=Array(Pt);for(var ce=0;ce<Pt;ce++)bt[ce]=arguments[ce+2];pt.children=bt}return{$$typeof:g,type:T.type,key:wt,ref:ct,props:pt,_owner:ot}},At.createContext=function(T){return T={$$typeof:l,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},T.Provider={$$typeof:o,_context:T},T.Consumer=T},At.createElement=Z,At.createFactory=function(T){var F=Z.bind(null,T);return F.type=T,F},At.createRef=function(){return{current:null}},At.forwardRef=function(T){return{$$typeof:u,render:T}},At.isValidElement=gt,At.lazy=function(T){return{$$typeof:p,_payload:{_status:-1,_result:T},_init:G}},At.memo=function(T,F){return{$$typeof:f,type:T,compare:F===void 0?null:F}},At.startTransition=function(T){var F=V.transition;V.transition={};try{T()}finally{V.transition=F}},At.unstable_act=W,At.useCallback=function(T,F){return X.current.useCallback(T,F)},At.useContext=function(T){return X.current.useContext(T)},At.useDebugValue=function(){},At.useDeferredValue=function(T){return X.current.useDeferredValue(T)},At.useEffect=function(T,F){return X.current.useEffect(T,F)},At.useId=function(){return X.current.useId()},At.useImperativeHandle=function(T,F,nt){return X.current.useImperativeHandle(T,F,nt)},At.useInsertionEffect=function(T,F){return X.current.useInsertionEffect(T,F)},At.useLayoutEffect=function(T,F){return X.current.useLayoutEffect(T,F)},At.useMemo=function(T,F){return X.current.useMemo(T,F)},At.useReducer=function(T,F,nt){return X.current.useReducer(T,F,nt)},At.useRef=function(T){return X.current.useRef(T)},At.useState=function(T){return X.current.useState(T)},At.useSyncExternalStore=function(T,F,nt){return X.current.useSyncExternalStore(T,F,nt)},At.useTransition=function(){return X.current.useTransition()},At.version="18.3.1",At}var Wh;function Ll(){return Wh||(Wh=1,fl.exports=Xp()),fl.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xh;function qp(){if(Xh)return bs;Xh=1;var g=Ll(),t=Symbol.for("react.element"),e=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(u,h,f){var p,v={},y=null,w=null;f!==void 0&&(y=""+f),h.key!==void 0&&(y=""+h.key),h.ref!==void 0&&(w=h.ref);for(p in h)s.call(h,p)&&!o.hasOwnProperty(p)&&(v[p]=h[p]);if(u&&u.defaultProps)for(p in h=u.defaultProps,h)v[p]===void 0&&(v[p]=h[p]);return{$$typeof:t,type:u,key:y,ref:w,props:v,_owner:r.current}}return bs.Fragment=e,bs.jsx=l,bs.jsxs=l,bs}var qh;function Yp(){return qh||(qh=1,dl.exports=qp()),dl.exports}var U=Yp(),je=Ll();const Kp=Ad(je);var Yr={},pl={exports:{}},_e={},gl={exports:{}},ml={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yh;function Qp(){return Yh||(Yh=1,(function(g){function t(V,tt){var W=V.length;V.push(tt);t:for(;0<W;){var T=W-1>>>1,F=V[T];if(0<r(F,tt))V[T]=tt,V[W]=F,W=T;else break t}}function e(V){return V.length===0?null:V[0]}function s(V){if(V.length===0)return null;var tt=V[0],W=V.pop();if(W!==tt){V[0]=W;t:for(var T=0,F=V.length,nt=F>>>1;T<nt;){var pt=2*(T+1)-1,wt=V[pt],ct=pt+1,ot=V[ct];if(0>r(wt,W))ct<F&&0>r(ot,wt)?(V[T]=ot,V[ct]=W,T=ct):(V[T]=wt,V[pt]=W,T=pt);else if(ct<F&&0>r(ot,W))V[T]=ot,V[ct]=W,T=ct;else break t}}return tt}function r(V,tt){var W=V.sortIndex-tt.sortIndex;return W!==0?W:V.id-tt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;g.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();g.unstable_now=function(){return l.now()-u}}var h=[],f=[],p=1,v=null,y=3,w=!1,_=!1,S=!1,x=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(V){for(var tt=e(f);tt!==null;){if(tt.callback===null)s(f);else if(tt.startTime<=V)s(f),tt.sortIndex=tt.expirationTime,t(h,tt);else break;tt=e(f)}}function N(V){if(S=!1,P(V),!_)if(e(h)!==null)_=!0,G(D);else{var tt=e(f);tt!==null&&X(N,tt.startTime-V)}}function D(V,tt){_=!1,S&&(S=!1,E(Z),Z=-1),w=!0;var W=y;try{for(P(tt),v=e(h);v!==null&&(!(v.expirationTime>tt)||V&&!ft());){var T=v.callback;if(typeof T=="function"){v.callback=null,y=v.priorityLevel;var F=T(v.expirationTime<=tt);tt=g.unstable_now(),typeof F=="function"?v.callback=F:v===e(h)&&s(h),P(tt)}else s(h);v=e(h)}if(v!==null)var nt=!0;else{var pt=e(f);pt!==null&&X(N,pt.startTime-tt),nt=!1}return nt}finally{v=null,y=W,w=!1}}var B=!1,H=null,Z=-1,it=5,gt=-1;function ft(){return!(g.unstable_now()-gt<it)}function St(){if(H!==null){var V=g.unstable_now();gt=V;var tt=!0;try{tt=H(!0,V)}finally{tt?xt():(B=!1,H=null)}}else B=!1}var xt;if(typeof M=="function")xt=function(){M(St)};else if(typeof MessageChannel<"u"){var yt=new MessageChannel,Mt=yt.port2;yt.port1.onmessage=St,xt=function(){Mt.postMessage(null)}}else xt=function(){x(St,0)};function G(V){H=V,B||(B=!0,xt())}function X(V,tt){Z=x(function(){V(g.unstable_now())},tt)}g.unstable_IdlePriority=5,g.unstable_ImmediatePriority=1,g.unstable_LowPriority=4,g.unstable_NormalPriority=3,g.unstable_Profiling=null,g.unstable_UserBlockingPriority=2,g.unstable_cancelCallback=function(V){V.callback=null},g.unstable_continueExecution=function(){_||w||(_=!0,G(D))},g.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):it=0<V?Math.floor(1e3/V):5},g.unstable_getCurrentPriorityLevel=function(){return y},g.unstable_getFirstCallbackNode=function(){return e(h)},g.unstable_next=function(V){switch(y){case 1:case 2:case 3:var tt=3;break;default:tt=y}var W=y;y=tt;try{return V()}finally{y=W}},g.unstable_pauseExecution=function(){},g.unstable_requestPaint=function(){},g.unstable_runWithPriority=function(V,tt){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var W=y;y=V;try{return tt()}finally{y=W}},g.unstable_scheduleCallback=function(V,tt,W){var T=g.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?T+W:T):W=T,V){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=W+F,V={id:p++,callback:tt,priorityLevel:V,startTime:W,expirationTime:F,sortIndex:-1},W>T?(V.sortIndex=W,t(f,V),e(h)===null&&V===e(f)&&(S?(E(Z),Z=-1):S=!0,X(N,W-T))):(V.sortIndex=F,t(h,V),_||w||(_=!0,G(D))),V},g.unstable_shouldYield=ft,g.unstable_wrapCallback=function(V){var tt=y;return function(){var W=y;y=tt;try{return V.apply(this,arguments)}finally{y=W}}}})(ml)),ml}var Kh;function Zp(){return Kh||(Kh=1,gl.exports=Qp()),gl.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qh;function Jp(){if(Qh)return _e;Qh=1;var g=Ll(),t=Zp();function e(n){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+n,a=1;a<arguments.length;a++)i+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,r={};function o(n,i){l(n,i),l(n+"Capture",i)}function l(n,i){for(r[n]=i,n=0;n<i.length;n++)s.add(i[n])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},v={};function y(n){return h.call(v,n)?!0:h.call(p,n)?!1:f.test(n)?v[n]=!0:(p[n]=!0,!1)}function w(n,i,a,c){if(a!==null&&a.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return c?!1:a!==null?!a.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function _(n,i,a,c){if(i===null||typeof i>"u"||w(n,i,a,c))return!0;if(c)return!1;if(a!==null)switch(a.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function S(n,i,a,c,d,m,A){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=c,this.attributeNamespace=d,this.mustUseProperty=a,this.propertyName=n,this.type=i,this.sanitizeURL=m,this.removeEmptyString=A}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){x[n]=new S(n,0,!1,n,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var i=n[0];x[i]=new S(i,1,!1,n[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(n){x[n]=new S(n,2,!1,n.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){x[n]=new S(n,2,!1,n,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){x[n]=new S(n,3,!1,n.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(n){x[n]=new S(n,3,!0,n,null,!1,!1)}),["capture","download"].forEach(function(n){x[n]=new S(n,4,!1,n,null,!1,!1)}),["cols","rows","size","span"].forEach(function(n){x[n]=new S(n,6,!1,n,null,!1,!1)}),["rowSpan","start"].forEach(function(n){x[n]=new S(n,5,!1,n.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function M(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var i=n.replace(E,M);x[i]=new S(i,1,!1,n,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var i=n.replace(E,M);x[i]=new S(i,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(n){var i=n.replace(E,M);x[i]=new S(i,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(n){x[n]=new S(n,1,!1,n.toLowerCase(),null,!1,!1)}),x.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(n){x[n]=new S(n,1,!1,n.toLowerCase(),null,!0,!0)});function P(n,i,a,c){var d=x.hasOwnProperty(i)?x[i]:null;(d!==null?d.type!==0:c||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(_(i,a,d,c)&&(a=null),c||d===null?y(i)&&(a===null?n.removeAttribute(i):n.setAttribute(i,""+a)):d.mustUseProperty?n[d.propertyName]=a===null?d.type===3?!1:"":a:(i=d.attributeName,c=d.attributeNamespace,a===null?n.removeAttribute(i):(d=d.type,a=d===3||d===4&&a===!0?"":""+a,c?n.setAttributeNS(c,i,a):n.setAttribute(i,a))))}var N=g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),B=Symbol.for("react.portal"),H=Symbol.for("react.fragment"),Z=Symbol.for("react.strict_mode"),it=Symbol.for("react.profiler"),gt=Symbol.for("react.provider"),ft=Symbol.for("react.context"),St=Symbol.for("react.forward_ref"),xt=Symbol.for("react.suspense"),yt=Symbol.for("react.suspense_list"),Mt=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),X=Symbol.for("react.offscreen"),V=Symbol.iterator;function tt(n){return n===null||typeof n!="object"?null:(n=V&&n[V]||n["@@iterator"],typeof n=="function"?n:null)}var W=Object.assign,T;function F(n){if(T===void 0)try{throw Error()}catch(a){var i=a.stack.trim().match(/\n( *(at )?)/);T=i&&i[1]||""}return`
`+T+n}var nt=!1;function pt(n,i){if(!n||nt)return"";nt=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(I){var c=I}Reflect.construct(n,[],i)}else{try{i.call()}catch(I){c=I}n.call(i.prototype)}else{try{throw Error()}catch(I){c=I}n()}}catch(I){if(I&&c&&typeof I.stack=="string"){for(var d=I.stack.split(`
`),m=c.stack.split(`
`),A=d.length-1,b=m.length-1;1<=A&&0<=b&&d[A]!==m[b];)b--;for(;1<=A&&0<=b;A--,b--)if(d[A]!==m[b]){if(A!==1||b!==1)do if(A--,b--,0>b||d[A]!==m[b]){var C=`
`+d[A].replace(" at new "," at ");return n.displayName&&C.includes("<anonymous>")&&(C=C.replace("<anonymous>",n.displayName)),C}while(1<=A&&0<=b);break}}}finally{nt=!1,Error.prepareStackTrace=a}return(n=n?n.displayName||n.name:"")?F(n):""}function wt(n){switch(n.tag){case 5:return F(n.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return n=pt(n.type,!1),n;case 11:return n=pt(n.type.render,!1),n;case 1:return n=pt(n.type,!0),n;default:return""}}function ct(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case H:return"Fragment";case B:return"Portal";case it:return"Profiler";case Z:return"StrictMode";case xt:return"Suspense";case yt:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case ft:return(n.displayName||"Context")+".Consumer";case gt:return(n._context.displayName||"Context")+".Provider";case St:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Mt:return i=n.displayName||null,i!==null?i:ct(n.type)||"Memo";case G:i=n._payload,n=n._init;try{return ct(n(i))}catch{}}return null}function ot(n){var i=n.type;switch(n.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=i.render,n=n.displayName||n.name||"",i.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ct(i);case 8:return i===Z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function bt(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Pt(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function ce(n){var i=Pt(n)?"checked":"value",a=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),c=""+n[i];if(!n.hasOwnProperty(i)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var d=a.get,m=a.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return d.call(this)},set:function(A){c=""+A,m.call(this,A)}}),Object.defineProperty(n,i,{enumerable:a.enumerable}),{getValue:function(){return c},setValue:function(A){c=""+A},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function zs(n){n._valueTracker||(n._valueTracker=ce(n))}function Yl(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var a=i.getValue(),c="";return n&&(c=Pt(n)?n.checked?"true":"false":n.value),n=c,n!==a?(i.setValue(n),!0):!1}function js(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function va(n,i){var a=i.checked;return W({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??n._wrapperState.initialChecked})}function Kl(n,i){var a=i.defaultValue==null?"":i.defaultValue,c=i.checked!=null?i.checked:i.defaultChecked;a=bt(i.value!=null?i.value:a),n._wrapperState={initialChecked:c,initialValue:a,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function Ql(n,i){i=i.checked,i!=null&&P(n,"checked",i,!1)}function ya(n,i){Ql(n,i);var a=bt(i.value),c=i.type;if(a!=null)c==="number"?(a===0&&n.value===""||n.value!=a)&&(n.value=""+a):n.value!==""+a&&(n.value=""+a);else if(c==="submit"||c==="reset"){n.removeAttribute("value");return}i.hasOwnProperty("value")?wa(n,i.type,a):i.hasOwnProperty("defaultValue")&&wa(n,i.type,bt(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(n.defaultChecked=!!i.defaultChecked)}function Zl(n,i,a){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var c=i.type;if(!(c!=="submit"&&c!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+n._wrapperState.initialValue,a||i===n.value||(n.value=i),n.defaultValue=i}a=n.name,a!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,a!==""&&(n.name=a)}function wa(n,i,a){(i!=="number"||js(n.ownerDocument)!==n)&&(a==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+a&&(n.defaultValue=""+a))}var Oi=Array.isArray;function si(n,i,a,c){if(n=n.options,i){i={};for(var d=0;d<a.length;d++)i["$"+a[d]]=!0;for(a=0;a<n.length;a++)d=i.hasOwnProperty("$"+n[a].value),n[a].selected!==d&&(n[a].selected=d),d&&c&&(n[a].defaultSelected=!0)}else{for(a=""+bt(a),i=null,d=0;d<n.length;d++){if(n[d].value===a){n[d].selected=!0,c&&(n[d].defaultSelected=!0);return}i!==null||n[d].disabled||(i=n[d])}i!==null&&(i.selected=!0)}}function Aa(n,i){if(i.dangerouslySetInnerHTML!=null)throw Error(e(91));return W({},i,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Jl(n,i){var a=i.value;if(a==null){if(a=i.children,i=i.defaultValue,a!=null){if(i!=null)throw Error(e(92));if(Oi(a)){if(1<a.length)throw Error(e(93));a=a[0]}i=a}i==null&&(i=""),a=i}n._wrapperState={initialValue:bt(a)}}function tu(n,i){var a=bt(i.value),c=bt(i.defaultValue);a!=null&&(a=""+a,a!==n.value&&(n.value=a),i.defaultValue==null&&n.defaultValue!==a&&(n.defaultValue=a)),c!=null&&(n.defaultValue=""+c)}function eu(n){var i=n.textContent;i===n._wrapperState.initialValue&&i!==""&&i!==null&&(n.value=i)}function nu(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _a(n,i){return n==null||n==="http://www.w3.org/1999/xhtml"?nu(i):n==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Bs,iu=(function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,a,c,d){MSApp.execUnsafeLocalFunction(function(){return n(i,a,c,d)})}:n})(function(n,i){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=i;else{for(Bs=Bs||document.createElement("div"),Bs.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Bs.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;i.firstChild;)n.appendChild(i.firstChild)}});function zi(n,i){if(i){var a=n.firstChild;if(a&&a===n.lastChild&&a.nodeType===3){a.nodeValue=i;return}}n.textContent=i}var ji={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Kd=["Webkit","ms","Moz","O"];Object.keys(ji).forEach(function(n){Kd.forEach(function(i){i=i+n.charAt(0).toUpperCase()+n.substring(1),ji[i]=ji[n]})});function su(n,i,a){return i==null||typeof i=="boolean"||i===""?"":a||typeof i!="number"||i===0||ji.hasOwnProperty(n)&&ji[n]?(""+i).trim():i+"px"}function ru(n,i){n=n.style;for(var a in i)if(i.hasOwnProperty(a)){var c=a.indexOf("--")===0,d=su(a,i[a],c);a==="float"&&(a="cssFloat"),c?n.setProperty(a,d):n[a]=d}}var Qd=W({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sa(n,i){if(i){if(Qd[n]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(e(137,n));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(e(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(e(61))}if(i.style!=null&&typeof i.style!="object")throw Error(e(62))}}function ba(n,i){if(n.indexOf("-")===-1)return typeof i.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ea=null;function xa(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ca=null,ri=null,ai=null;function au(n){if(n=os(n)){if(typeof Ca!="function")throw Error(e(280));var i=n.stateNode;i&&(i=ur(i),Ca(n.stateNode,n.type,i))}}function ou(n){ri?ai?ai.push(n):ai=[n]:ri=n}function lu(){if(ri){var n=ri,i=ai;if(ai=ri=null,au(n),i)for(n=0;n<i.length;n++)au(i[n])}}function uu(n,i){return n(i)}function cu(){}var ka=!1;function hu(n,i,a){if(ka)return n(i,a);ka=!0;try{return uu(n,i,a)}finally{ka=!1,(ri!==null||ai!==null)&&(cu(),lu())}}function Bi(n,i){var a=n.stateNode;if(a===null)return null;var c=ur(a);if(c===null)return null;a=c[i];t:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break t;default:n=!1}if(n)return null;if(a&&typeof a!="function")throw Error(e(231,i,typeof a));return a}var Ta=!1;if(u)try{var Hi={};Object.defineProperty(Hi,"passive",{get:function(){Ta=!0}}),window.addEventListener("test",Hi,Hi),window.removeEventListener("test",Hi,Hi)}catch{Ta=!1}function Zd(n,i,a,c,d,m,A,b,C){var I=Array.prototype.slice.call(arguments,3);try{i.apply(a,I)}catch(z){this.onError(z)}}var Ui=!1,Hs=null,Us=!1,Pa=null,Jd={onError:function(n){Ui=!0,Hs=n}};function tf(n,i,a,c,d,m,A,b,C){Ui=!1,Hs=null,Zd.apply(Jd,arguments)}function ef(n,i,a,c,d,m,A,b,C){if(tf.apply(this,arguments),Ui){if(Ui){var I=Hs;Ui=!1,Hs=null}else throw Error(e(198));Us||(Us=!0,Pa=I)}}function jn(n){var i=n,a=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(a=i.return),n=i.return;while(n)}return i.tag===3?a:null}function du(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function fu(n){if(jn(n)!==n)throw Error(e(188))}function nf(n){var i=n.alternate;if(!i){if(i=jn(n),i===null)throw Error(e(188));return i!==n?null:n}for(var a=n,c=i;;){var d=a.return;if(d===null)break;var m=d.alternate;if(m===null){if(c=d.return,c!==null){a=c;continue}break}if(d.child===m.child){for(m=d.child;m;){if(m===a)return fu(d),n;if(m===c)return fu(d),i;m=m.sibling}throw Error(e(188))}if(a.return!==c.return)a=d,c=m;else{for(var A=!1,b=d.child;b;){if(b===a){A=!0,a=d,c=m;break}if(b===c){A=!0,c=d,a=m;break}b=b.sibling}if(!A){for(b=m.child;b;){if(b===a){A=!0,a=m,c=d;break}if(b===c){A=!0,c=m,a=d;break}b=b.sibling}if(!A)throw Error(e(189))}}if(a.alternate!==c)throw Error(e(190))}if(a.tag!==3)throw Error(e(188));return a.stateNode.current===a?n:i}function pu(n){return n=nf(n),n!==null?gu(n):null}function gu(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var i=gu(n);if(i!==null)return i;n=n.sibling}return null}var mu=t.unstable_scheduleCallback,vu=t.unstable_cancelCallback,sf=t.unstable_shouldYield,rf=t.unstable_requestPaint,Ht=t.unstable_now,af=t.unstable_getCurrentPriorityLevel,Ra=t.unstable_ImmediatePriority,yu=t.unstable_UserBlockingPriority,$s=t.unstable_NormalPriority,of=t.unstable_LowPriority,wu=t.unstable_IdlePriority,Vs=null,Ke=null;function lf(n){if(Ke&&typeof Ke.onCommitFiberRoot=="function")try{Ke.onCommitFiberRoot(Vs,n,void 0,(n.current.flags&128)===128)}catch{}}var Be=Math.clz32?Math.clz32:hf,uf=Math.log,cf=Math.LN2;function hf(n){return n>>>=0,n===0?32:31-(uf(n)/cf|0)|0}var Gs=64,Ws=4194304;function $i(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Xs(n,i){var a=n.pendingLanes;if(a===0)return 0;var c=0,d=n.suspendedLanes,m=n.pingedLanes,A=a&268435455;if(A!==0){var b=A&~d;b!==0?c=$i(b):(m&=A,m!==0&&(c=$i(m)))}else A=a&~d,A!==0?c=$i(A):m!==0&&(c=$i(m));if(c===0)return 0;if(i!==0&&i!==c&&(i&d)===0&&(d=c&-c,m=i&-i,d>=m||d===16&&(m&4194240)!==0))return i;if((c&4)!==0&&(c|=a&16),i=n.entangledLanes,i!==0)for(n=n.entanglements,i&=c;0<i;)a=31-Be(i),d=1<<a,c|=n[a],i&=~d;return c}function df(n,i){switch(n){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ff(n,i){for(var a=n.suspendedLanes,c=n.pingedLanes,d=n.expirationTimes,m=n.pendingLanes;0<m;){var A=31-Be(m),b=1<<A,C=d[A];C===-1?((b&a)===0||(b&c)!==0)&&(d[A]=df(b,i)):C<=i&&(n.expiredLanes|=b),m&=~b}}function Ma(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Au(){var n=Gs;return Gs<<=1,(Gs&4194240)===0&&(Gs=64),n}function La(n){for(var i=[],a=0;31>a;a++)i.push(n);return i}function Vi(n,i,a){n.pendingLanes|=i,i!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,i=31-Be(i),n[i]=a}function pf(n,i){var a=n.pendingLanes&~i;n.pendingLanes=i,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=i,n.mutableReadLanes&=i,n.entangledLanes&=i,i=n.entanglements;var c=n.eventTimes;for(n=n.expirationTimes;0<a;){var d=31-Be(a),m=1<<d;i[d]=0,c[d]=-1,n[d]=-1,a&=~m}}function Ia(n,i){var a=n.entangledLanes|=i;for(n=n.entanglements;a;){var c=31-Be(a),d=1<<c;d&i|n[c]&i&&(n[c]|=i),a&=~d}}var Tt=0;function _u(n){return n&=-n,1<n?4<n?(n&268435455)!==0?16:536870912:4:1}var Su,Na,bu,Eu,xu,Da=!1,qs=[],gn=null,mn=null,vn=null,Gi=new Map,Wi=new Map,yn=[],gf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Cu(n,i){switch(n){case"focusin":case"focusout":gn=null;break;case"dragenter":case"dragleave":mn=null;break;case"mouseover":case"mouseout":vn=null;break;case"pointerover":case"pointerout":Gi.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wi.delete(i.pointerId)}}function Xi(n,i,a,c,d,m){return n===null||n.nativeEvent!==m?(n={blockedOn:i,domEventName:a,eventSystemFlags:c,nativeEvent:m,targetContainers:[d]},i!==null&&(i=os(i),i!==null&&Na(i)),n):(n.eventSystemFlags|=c,i=n.targetContainers,d!==null&&i.indexOf(d)===-1&&i.push(d),n)}function mf(n,i,a,c,d){switch(i){case"focusin":return gn=Xi(gn,n,i,a,c,d),!0;case"dragenter":return mn=Xi(mn,n,i,a,c,d),!0;case"mouseover":return vn=Xi(vn,n,i,a,c,d),!0;case"pointerover":var m=d.pointerId;return Gi.set(m,Xi(Gi.get(m)||null,n,i,a,c,d)),!0;case"gotpointercapture":return m=d.pointerId,Wi.set(m,Xi(Wi.get(m)||null,n,i,a,c,d)),!0}return!1}function ku(n){var i=Bn(n.target);if(i!==null){var a=jn(i);if(a!==null){if(i=a.tag,i===13){if(i=du(a),i!==null){n.blockedOn=i,xu(n.priority,function(){bu(a)});return}}else if(i===3&&a.stateNode.current.memoizedState.isDehydrated){n.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Ys(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var a=Oa(n.domEventName,n.eventSystemFlags,i[0],n.nativeEvent);if(a===null){a=n.nativeEvent;var c=new a.constructor(a.type,a);Ea=c,a.target.dispatchEvent(c),Ea=null}else return i=os(a),i!==null&&Na(i),n.blockedOn=a,!1;i.shift()}return!0}function Tu(n,i,a){Ys(n)&&a.delete(i)}function vf(){Da=!1,gn!==null&&Ys(gn)&&(gn=null),mn!==null&&Ys(mn)&&(mn=null),vn!==null&&Ys(vn)&&(vn=null),Gi.forEach(Tu),Wi.forEach(Tu)}function qi(n,i){n.blockedOn===i&&(n.blockedOn=null,Da||(Da=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,vf)))}function Yi(n){function i(d){return qi(d,n)}if(0<qs.length){qi(qs[0],n);for(var a=1;a<qs.length;a++){var c=qs[a];c.blockedOn===n&&(c.blockedOn=null)}}for(gn!==null&&qi(gn,n),mn!==null&&qi(mn,n),vn!==null&&qi(vn,n),Gi.forEach(i),Wi.forEach(i),a=0;a<yn.length;a++)c=yn[a],c.blockedOn===n&&(c.blockedOn=null);for(;0<yn.length&&(a=yn[0],a.blockedOn===null);)ku(a),a.blockedOn===null&&yn.shift()}var oi=N.ReactCurrentBatchConfig,Ks=!0;function yf(n,i,a,c){var d=Tt,m=oi.transition;oi.transition=null;try{Tt=1,Fa(n,i,a,c)}finally{Tt=d,oi.transition=m}}function wf(n,i,a,c){var d=Tt,m=oi.transition;oi.transition=null;try{Tt=4,Fa(n,i,a,c)}finally{Tt=d,oi.transition=m}}function Fa(n,i,a,c){if(Ks){var d=Oa(n,i,a,c);if(d===null)to(n,i,c,Qs,a),Cu(n,c);else if(mf(d,n,i,a,c))c.stopPropagation();else if(Cu(n,c),i&4&&-1<gf.indexOf(n)){for(;d!==null;){var m=os(d);if(m!==null&&Su(m),m=Oa(n,i,a,c),m===null&&to(n,i,c,Qs,a),m===d)break;d=m}d!==null&&c.stopPropagation()}else to(n,i,c,null,a)}}var Qs=null;function Oa(n,i,a,c){if(Qs=null,n=xa(c),n=Bn(n),n!==null)if(i=jn(n),i===null)n=null;else if(a=i.tag,a===13){if(n=du(i),n!==null)return n;n=null}else if(a===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null);return Qs=n,null}function Pu(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(af()){case Ra:return 1;case yu:return 4;case $s:case of:return 16;case wu:return 536870912;default:return 16}default:return 16}}var wn=null,za=null,Zs=null;function Ru(){if(Zs)return Zs;var n,i=za,a=i.length,c,d="value"in wn?wn.value:wn.textContent,m=d.length;for(n=0;n<a&&i[n]===d[n];n++);var A=a-n;for(c=1;c<=A&&i[a-c]===d[m-c];c++);return Zs=d.slice(n,1<c?1-c:void 0)}function Js(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function tr(){return!0}function Mu(){return!1}function xe(n){function i(a,c,d,m,A){this._reactName=a,this._targetInst=d,this.type=c,this.nativeEvent=m,this.target=A,this.currentTarget=null;for(var b in n)n.hasOwnProperty(b)&&(a=n[b],this[b]=a?a(m):m[b]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?tr:Mu,this.isPropagationStopped=Mu,this}return W(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=tr)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=tr)},persist:function(){},isPersistent:tr}),i}var li={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ja=xe(li),Ki=W({},li,{view:0,detail:0}),Af=xe(Ki),Ba,Ha,Qi,er=W({},Ki,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$a,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Qi&&(Qi&&n.type==="mousemove"?(Ba=n.screenX-Qi.screenX,Ha=n.screenY-Qi.screenY):Ha=Ba=0,Qi=n),Ba)},movementY:function(n){return"movementY"in n?n.movementY:Ha}}),Lu=xe(er),_f=W({},er,{dataTransfer:0}),Sf=xe(_f),bf=W({},Ki,{relatedTarget:0}),Ua=xe(bf),Ef=W({},li,{animationName:0,elapsedTime:0,pseudoElement:0}),xf=xe(Ef),Cf=W({},li,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),kf=xe(Cf),Tf=W({},li,{data:0}),Iu=xe(Tf),Pf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lf(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=Mf[n])?!!i[n]:!1}function $a(){return Lf}var If=W({},Ki,{key:function(n){if(n.key){var i=Pf[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=Js(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Rf[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$a,charCode:function(n){return n.type==="keypress"?Js(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Js(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Nf=xe(If),Df=W({},er,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nu=xe(Df),Ff=W({},Ki,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$a}),Of=xe(Ff),zf=W({},li,{propertyName:0,elapsedTime:0,pseudoElement:0}),jf=xe(zf),Bf=W({},er,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Hf=xe(Bf),Uf=[9,13,27,32],Va=u&&"CompositionEvent"in window,Zi=null;u&&"documentMode"in document&&(Zi=document.documentMode);var $f=u&&"TextEvent"in window&&!Zi,Du=u&&(!Va||Zi&&8<Zi&&11>=Zi),Fu=" ",Ou=!1;function zu(n,i){switch(n){case"keyup":return Uf.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ju(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ui=!1;function Vf(n,i){switch(n){case"compositionend":return ju(i);case"keypress":return i.which!==32?null:(Ou=!0,Fu);case"textInput":return n=i.data,n===Fu&&Ou?null:n;default:return null}}function Gf(n,i){if(ui)return n==="compositionend"||!Va&&zu(n,i)?(n=Ru(),Zs=za=wn=null,ui=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Du&&i.locale!=="ko"?null:i.data;default:return null}}var Wf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bu(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!Wf[n.type]:i==="textarea"}function Hu(n,i,a,c){ou(c),i=ar(i,"onChange"),0<i.length&&(a=new ja("onChange","change",null,a,c),n.push({event:a,listeners:i}))}var Ji=null,ts=null;function Xf(n){rc(n,0)}function nr(n){var i=pi(n);if(Yl(i))return n}function qf(n,i){if(n==="change")return i}var Uu=!1;if(u){var Ga;if(u){var Wa="oninput"in document;if(!Wa){var $u=document.createElement("div");$u.setAttribute("oninput","return;"),Wa=typeof $u.oninput=="function"}Ga=Wa}else Ga=!1;Uu=Ga&&(!document.documentMode||9<document.documentMode)}function Vu(){Ji&&(Ji.detachEvent("onpropertychange",Gu),ts=Ji=null)}function Gu(n){if(n.propertyName==="value"&&nr(ts)){var i=[];Hu(i,ts,n,xa(n)),hu(Xf,i)}}function Yf(n,i,a){n==="focusin"?(Vu(),Ji=i,ts=a,Ji.attachEvent("onpropertychange",Gu)):n==="focusout"&&Vu()}function Kf(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return nr(ts)}function Qf(n,i){if(n==="click")return nr(i)}function Zf(n,i){if(n==="input"||n==="change")return nr(i)}function Jf(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var He=typeof Object.is=="function"?Object.is:Jf;function es(n,i){if(He(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var a=Object.keys(n),c=Object.keys(i);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var d=a[c];if(!h.call(i,d)||!He(n[d],i[d]))return!1}return!0}function Wu(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Xu(n,i){var a=Wu(n);n=0;for(var c;a;){if(a.nodeType===3){if(c=n+a.textContent.length,n<=i&&c>=i)return{node:a,offset:i-n};n=c}t:{for(;a;){if(a.nextSibling){a=a.nextSibling;break t}a=a.parentNode}a=void 0}a=Wu(a)}}function qu(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?qu(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Yu(){for(var n=window,i=js();i instanceof n.HTMLIFrameElement;){try{var a=typeof i.contentWindow.location.href=="string"}catch{a=!1}if(a)n=i.contentWindow;else break;i=js(n.document)}return i}function Xa(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}function tp(n){var i=Yu(),a=n.focusedElem,c=n.selectionRange;if(i!==a&&a&&a.ownerDocument&&qu(a.ownerDocument.documentElement,a)){if(c!==null&&Xa(a)){if(i=c.start,n=c.end,n===void 0&&(n=i),"selectionStart"in a)a.selectionStart=i,a.selectionEnd=Math.min(n,a.value.length);else if(n=(i=a.ownerDocument||document)&&i.defaultView||window,n.getSelection){n=n.getSelection();var d=a.textContent.length,m=Math.min(c.start,d);c=c.end===void 0?m:Math.min(c.end,d),!n.extend&&m>c&&(d=c,c=m,m=d),d=Xu(a,m);var A=Xu(a,c);d&&A&&(n.rangeCount!==1||n.anchorNode!==d.node||n.anchorOffset!==d.offset||n.focusNode!==A.node||n.focusOffset!==A.offset)&&(i=i.createRange(),i.setStart(d.node,d.offset),n.removeAllRanges(),m>c?(n.addRange(i),n.extend(A.node,A.offset)):(i.setEnd(A.node,A.offset),n.addRange(i)))}}for(i=[],n=a;n=n.parentNode;)n.nodeType===1&&i.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<i.length;a++)n=i[a],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var ep=u&&"documentMode"in document&&11>=document.documentMode,ci=null,qa=null,ns=null,Ya=!1;function Ku(n,i,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Ya||ci==null||ci!==js(c)||(c=ci,"selectionStart"in c&&Xa(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),ns&&es(ns,c)||(ns=c,c=ar(qa,"onSelect"),0<c.length&&(i=new ja("onSelect","select",null,i,a),n.push({event:i,listeners:c}),i.target=ci)))}function ir(n,i){var a={};return a[n.toLowerCase()]=i.toLowerCase(),a["Webkit"+n]="webkit"+i,a["Moz"+n]="moz"+i,a}var hi={animationend:ir("Animation","AnimationEnd"),animationiteration:ir("Animation","AnimationIteration"),animationstart:ir("Animation","AnimationStart"),transitionend:ir("Transition","TransitionEnd")},Ka={},Qu={};u&&(Qu=document.createElement("div").style,"AnimationEvent"in window||(delete hi.animationend.animation,delete hi.animationiteration.animation,delete hi.animationstart.animation),"TransitionEvent"in window||delete hi.transitionend.transition);function sr(n){if(Ka[n])return Ka[n];if(!hi[n])return n;var i=hi[n],a;for(a in i)if(i.hasOwnProperty(a)&&a in Qu)return Ka[n]=i[a];return n}var Zu=sr("animationend"),Ju=sr("animationiteration"),tc=sr("animationstart"),ec=sr("transitionend"),nc=new Map,ic="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function An(n,i){nc.set(n,i),o(i,[n])}for(var Qa=0;Qa<ic.length;Qa++){var Za=ic[Qa],np=Za.toLowerCase(),ip=Za[0].toUpperCase()+Za.slice(1);An(np,"on"+ip)}An(Zu,"onAnimationEnd"),An(Ju,"onAnimationIteration"),An(tc,"onAnimationStart"),An("dblclick","onDoubleClick"),An("focusin","onFocus"),An("focusout","onBlur"),An(ec,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var is="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),sp=new Set("cancel close invalid load scroll toggle".split(" ").concat(is));function sc(n,i,a){var c=n.type||"unknown-event";n.currentTarget=a,ef(c,i,void 0,n),n.currentTarget=null}function rc(n,i){i=(i&4)!==0;for(var a=0;a<n.length;a++){var c=n[a],d=c.event;c=c.listeners;t:{var m=void 0;if(i)for(var A=c.length-1;0<=A;A--){var b=c[A],C=b.instance,I=b.currentTarget;if(b=b.listener,C!==m&&d.isPropagationStopped())break t;sc(d,b,I),m=C}else for(A=0;A<c.length;A++){if(b=c[A],C=b.instance,I=b.currentTarget,b=b.listener,C!==m&&d.isPropagationStopped())break t;sc(d,b,I),m=C}}}if(Us)throw n=Pa,Us=!1,Pa=null,n}function It(n,i){var a=i[ao];a===void 0&&(a=i[ao]=new Set);var c=n+"__bubble";a.has(c)||(ac(i,n,2,!1),a.add(c))}function Ja(n,i,a){var c=0;i&&(c|=4),ac(a,n,c,i)}var rr="_reactListening"+Math.random().toString(36).slice(2);function ss(n){if(!n[rr]){n[rr]=!0,s.forEach(function(a){a!=="selectionchange"&&(sp.has(a)||Ja(a,!1,n),Ja(a,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[rr]||(i[rr]=!0,Ja("selectionchange",!1,i))}}function ac(n,i,a,c){switch(Pu(i)){case 1:var d=yf;break;case 4:d=wf;break;default:d=Fa}a=d.bind(null,i,a,n),d=void 0,!Ta||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(d=!0),c?d!==void 0?n.addEventListener(i,a,{capture:!0,passive:d}):n.addEventListener(i,a,!0):d!==void 0?n.addEventListener(i,a,{passive:d}):n.addEventListener(i,a,!1)}function to(n,i,a,c,d){var m=c;if((i&1)===0&&(i&2)===0&&c!==null)t:for(;;){if(c===null)return;var A=c.tag;if(A===3||A===4){var b=c.stateNode.containerInfo;if(b===d||b.nodeType===8&&b.parentNode===d)break;if(A===4)for(A=c.return;A!==null;){var C=A.tag;if((C===3||C===4)&&(C=A.stateNode.containerInfo,C===d||C.nodeType===8&&C.parentNode===d))return;A=A.return}for(;b!==null;){if(A=Bn(b),A===null)return;if(C=A.tag,C===5||C===6){c=m=A;continue t}b=b.parentNode}}c=c.return}hu(function(){var I=m,z=xa(a),j=[];t:{var O=nc.get(n);if(O!==void 0){var q=ja,Q=n;switch(n){case"keypress":if(Js(a)===0)break t;case"keydown":case"keyup":q=Nf;break;case"focusin":Q="focus",q=Ua;break;case"focusout":Q="blur",q=Ua;break;case"beforeblur":case"afterblur":q=Ua;break;case"click":if(a.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=Lu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=Sf;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=Of;break;case Zu:case Ju:case tc:q=xf;break;case ec:q=jf;break;case"scroll":q=Af;break;case"wheel":q=Hf;break;case"copy":case"cut":case"paste":q=kf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=Nu}var J=(i&4)!==0,Ut=!J&&n==="scroll",R=J?O!==null?O+"Capture":null:O;J=[];for(var k=I,L;k!==null;){L=k;var $=L.stateNode;if(L.tag===5&&$!==null&&(L=$,R!==null&&($=Bi(k,R),$!=null&&J.push(rs(k,$,L)))),Ut)break;k=k.return}0<J.length&&(O=new q(O,Q,null,a,z),j.push({event:O,listeners:J}))}}if((i&7)===0){t:{if(O=n==="mouseover"||n==="pointerover",q=n==="mouseout"||n==="pointerout",O&&a!==Ea&&(Q=a.relatedTarget||a.fromElement)&&(Bn(Q)||Q[rn]))break t;if((q||O)&&(O=z.window===z?z:(O=z.ownerDocument)?O.defaultView||O.parentWindow:window,q?(Q=a.relatedTarget||a.toElement,q=I,Q=Q?Bn(Q):null,Q!==null&&(Ut=jn(Q),Q!==Ut||Q.tag!==5&&Q.tag!==6)&&(Q=null)):(q=null,Q=I),q!==Q)){if(J=Lu,$="onMouseLeave",R="onMouseEnter",k="mouse",(n==="pointerout"||n==="pointerover")&&(J=Nu,$="onPointerLeave",R="onPointerEnter",k="pointer"),Ut=q==null?O:pi(q),L=Q==null?O:pi(Q),O=new J($,k+"leave",q,a,z),O.target=Ut,O.relatedTarget=L,$=null,Bn(z)===I&&(J=new J(R,k+"enter",Q,a,z),J.target=L,J.relatedTarget=Ut,$=J),Ut=$,q&&Q)e:{for(J=q,R=Q,k=0,L=J;L;L=di(L))k++;for(L=0,$=R;$;$=di($))L++;for(;0<k-L;)J=di(J),k--;for(;0<L-k;)R=di(R),L--;for(;k--;){if(J===R||R!==null&&J===R.alternate)break e;J=di(J),R=di(R)}J=null}else J=null;q!==null&&oc(j,O,q,J,!1),Q!==null&&Ut!==null&&oc(j,Ut,Q,J,!0)}}t:{if(O=I?pi(I):window,q=O.nodeName&&O.nodeName.toLowerCase(),q==="select"||q==="input"&&O.type==="file")var et=qf;else if(Bu(O))if(Uu)et=Zf;else{et=Kf;var rt=Yf}else(q=O.nodeName)&&q.toLowerCase()==="input"&&(O.type==="checkbox"||O.type==="radio")&&(et=Qf);if(et&&(et=et(n,I))){Hu(j,et,a,z);break t}rt&&rt(n,O,I),n==="focusout"&&(rt=O._wrapperState)&&rt.controlled&&O.type==="number"&&wa(O,"number",O.value)}switch(rt=I?pi(I):window,n){case"focusin":(Bu(rt)||rt.contentEditable==="true")&&(ci=rt,qa=I,ns=null);break;case"focusout":ns=qa=ci=null;break;case"mousedown":Ya=!0;break;case"contextmenu":case"mouseup":case"dragend":Ya=!1,Ku(j,a,z);break;case"selectionchange":if(ep)break;case"keydown":case"keyup":Ku(j,a,z)}var at;if(Va)t:{switch(n){case"compositionstart":var ht="onCompositionStart";break t;case"compositionend":ht="onCompositionEnd";break t;case"compositionupdate":ht="onCompositionUpdate";break t}ht=void 0}else ui?zu(n,a)&&(ht="onCompositionEnd"):n==="keydown"&&a.keyCode===229&&(ht="onCompositionStart");ht&&(Du&&a.locale!=="ko"&&(ui||ht!=="onCompositionStart"?ht==="onCompositionEnd"&&ui&&(at=Ru()):(wn=z,za="value"in wn?wn.value:wn.textContent,ui=!0)),rt=ar(I,ht),0<rt.length&&(ht=new Iu(ht,n,null,a,z),j.push({event:ht,listeners:rt}),at?ht.data=at:(at=ju(a),at!==null&&(ht.data=at)))),(at=$f?Vf(n,a):Gf(n,a))&&(I=ar(I,"onBeforeInput"),0<I.length&&(z=new Iu("onBeforeInput","beforeinput",null,a,z),j.push({event:z,listeners:I}),z.data=at))}rc(j,i)})}function rs(n,i,a){return{instance:n,listener:i,currentTarget:a}}function ar(n,i){for(var a=i+"Capture",c=[];n!==null;){var d=n,m=d.stateNode;d.tag===5&&m!==null&&(d=m,m=Bi(n,a),m!=null&&c.unshift(rs(n,m,d)),m=Bi(n,i),m!=null&&c.push(rs(n,m,d))),n=n.return}return c}function di(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function oc(n,i,a,c,d){for(var m=i._reactName,A=[];a!==null&&a!==c;){var b=a,C=b.alternate,I=b.stateNode;if(C!==null&&C===c)break;b.tag===5&&I!==null&&(b=I,d?(C=Bi(a,m),C!=null&&A.unshift(rs(a,C,b))):d||(C=Bi(a,m),C!=null&&A.push(rs(a,C,b)))),a=a.return}A.length!==0&&n.push({event:i,listeners:A})}var rp=/\r\n?/g,ap=/\u0000|\uFFFD/g;function lc(n){return(typeof n=="string"?n:""+n).replace(rp,`
`).replace(ap,"")}function or(n,i,a){if(i=lc(i),lc(n)!==i&&a)throw Error(e(425))}function lr(){}var eo=null,no=null;function io(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var so=typeof setTimeout=="function"?setTimeout:void 0,op=typeof clearTimeout=="function"?clearTimeout:void 0,uc=typeof Promise=="function"?Promise:void 0,lp=typeof queueMicrotask=="function"?queueMicrotask:typeof uc<"u"?function(n){return uc.resolve(null).then(n).catch(up)}:so;function up(n){setTimeout(function(){throw n})}function ro(n,i){var a=i,c=0;do{var d=a.nextSibling;if(n.removeChild(a),d&&d.nodeType===8)if(a=d.data,a==="/$"){if(c===0){n.removeChild(d),Yi(i);return}c--}else a!=="$"&&a!=="$?"&&a!=="$!"||c++;a=d}while(a);Yi(i)}function _n(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return n}function cc(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var a=n.data;if(a==="$"||a==="$!"||a==="$?"){if(i===0)return n;i--}else a==="/$"&&i++}n=n.previousSibling}return null}var fi=Math.random().toString(36).slice(2),Qe="__reactFiber$"+fi,as="__reactProps$"+fi,rn="__reactContainer$"+fi,ao="__reactEvents$"+fi,cp="__reactListeners$"+fi,hp="__reactHandles$"+fi;function Bn(n){var i=n[Qe];if(i)return i;for(var a=n.parentNode;a;){if(i=a[rn]||a[Qe]){if(a=i.alternate,i.child!==null||a!==null&&a.child!==null)for(n=cc(n);n!==null;){if(a=n[Qe])return a;n=cc(n)}return i}n=a,a=n.parentNode}return null}function os(n){return n=n[Qe]||n[rn],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function pi(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(e(33))}function ur(n){return n[as]||null}var oo=[],gi=-1;function Sn(n){return{current:n}}function Nt(n){0>gi||(n.current=oo[gi],oo[gi]=null,gi--)}function Lt(n,i){gi++,oo[gi]=n.current,n.current=i}var bn={},ie=Sn(bn),me=Sn(!1),Hn=bn;function mi(n,i){var a=n.type.contextTypes;if(!a)return bn;var c=n.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===i)return c.__reactInternalMemoizedMaskedChildContext;var d={},m;for(m in a)d[m]=i[m];return c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=d),d}function ve(n){return n=n.childContextTypes,n!=null}function cr(){Nt(me),Nt(ie)}function hc(n,i,a){if(ie.current!==bn)throw Error(e(168));Lt(ie,i),Lt(me,a)}function dc(n,i,a){var c=n.stateNode;if(i=i.childContextTypes,typeof c.getChildContext!="function")return a;c=c.getChildContext();for(var d in c)if(!(d in i))throw Error(e(108,ot(n)||"Unknown",d));return W({},a,c)}function hr(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||bn,Hn=ie.current,Lt(ie,n),Lt(me,me.current),!0}function fc(n,i,a){var c=n.stateNode;if(!c)throw Error(e(169));a?(n=dc(n,i,Hn),c.__reactInternalMemoizedMergedChildContext=n,Nt(me),Nt(ie),Lt(ie,n)):Nt(me),Lt(me,a)}var an=null,dr=!1,lo=!1;function pc(n){an===null?an=[n]:an.push(n)}function dp(n){dr=!0,pc(n)}function En(){if(!lo&&an!==null){lo=!0;var n=0,i=Tt;try{var a=an;for(Tt=1;n<a.length;n++){var c=a[n];do c=c(!0);while(c!==null)}an=null,dr=!1}catch(d){throw an!==null&&(an=an.slice(n+1)),mu(Ra,En),d}finally{Tt=i,lo=!1}}return null}var vi=[],yi=0,fr=null,pr=0,Me=[],Le=0,Un=null,on=1,ln="";function $n(n,i){vi[yi++]=pr,vi[yi++]=fr,fr=n,pr=i}function gc(n,i,a){Me[Le++]=on,Me[Le++]=ln,Me[Le++]=Un,Un=n;var c=on;n=ln;var d=32-Be(c)-1;c&=~(1<<d),a+=1;var m=32-Be(i)+d;if(30<m){var A=d-d%5;m=(c&(1<<A)-1).toString(32),c>>=A,d-=A,on=1<<32-Be(i)+d|a<<d|c,ln=m+n}else on=1<<m|a<<d|c,ln=n}function uo(n){n.return!==null&&($n(n,1),gc(n,1,0))}function co(n){for(;n===fr;)fr=vi[--yi],vi[yi]=null,pr=vi[--yi],vi[yi]=null;for(;n===Un;)Un=Me[--Le],Me[Le]=null,ln=Me[--Le],Me[Le]=null,on=Me[--Le],Me[Le]=null}var Ce=null,ke=null,Dt=!1,Ue=null;function mc(n,i){var a=Fe(5,null,null,0);a.elementType="DELETED",a.stateNode=i,a.return=n,i=n.deletions,i===null?(n.deletions=[a],n.flags|=16):i.push(a)}function vc(n,i){switch(n.tag){case 5:var a=n.type;return i=i.nodeType!==1||a.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(n.stateNode=i,Ce=n,ke=_n(i.firstChild),!0):!1;case 6:return i=n.pendingProps===""||i.nodeType!==3?null:i,i!==null?(n.stateNode=i,Ce=n,ke=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(a=Un!==null?{id:on,overflow:ln}:null,n.memoizedState={dehydrated:i,treeContext:a,retryLane:1073741824},a=Fe(18,null,null,0),a.stateNode=i,a.return=n,n.child=a,Ce=n,ke=null,!0):!1;default:return!1}}function ho(n){return(n.mode&1)!==0&&(n.flags&128)===0}function fo(n){if(Dt){var i=ke;if(i){var a=i;if(!vc(n,i)){if(ho(n))throw Error(e(418));i=_n(a.nextSibling);var c=Ce;i&&vc(n,i)?mc(c,a):(n.flags=n.flags&-4097|2,Dt=!1,Ce=n)}}else{if(ho(n))throw Error(e(418));n.flags=n.flags&-4097|2,Dt=!1,Ce=n}}}function yc(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ce=n}function gr(n){if(n!==Ce)return!1;if(!Dt)return yc(n),Dt=!0,!1;var i;if((i=n.tag!==3)&&!(i=n.tag!==5)&&(i=n.type,i=i!=="head"&&i!=="body"&&!io(n.type,n.memoizedProps)),i&&(i=ke)){if(ho(n))throw wc(),Error(e(418));for(;i;)mc(n,i),i=_n(i.nextSibling)}if(yc(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(e(317));t:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8){var a=n.data;if(a==="/$"){if(i===0){ke=_n(n.nextSibling);break t}i--}else a!=="$"&&a!=="$!"&&a!=="$?"||i++}n=n.nextSibling}ke=null}}else ke=Ce?_n(n.stateNode.nextSibling):null;return!0}function wc(){for(var n=ke;n;)n=_n(n.nextSibling)}function wi(){ke=Ce=null,Dt=!1}function po(n){Ue===null?Ue=[n]:Ue.push(n)}var fp=N.ReactCurrentBatchConfig;function ls(n,i,a){if(n=a.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(e(309));var c=a.stateNode}if(!c)throw Error(e(147,n));var d=c,m=""+n;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===m?i.ref:(i=function(A){var b=d.refs;A===null?delete b[m]:b[m]=A},i._stringRef=m,i)}if(typeof n!="string")throw Error(e(284));if(!a._owner)throw Error(e(290,n))}return n}function mr(n,i){throw n=Object.prototype.toString.call(i),Error(e(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n))}function Ac(n){var i=n._init;return i(n._payload)}function _c(n){function i(R,k){if(n){var L=R.deletions;L===null?(R.deletions=[k],R.flags|=16):L.push(k)}}function a(R,k){if(!n)return null;for(;k!==null;)i(R,k),k=k.sibling;return null}function c(R,k){for(R=new Map;k!==null;)k.key!==null?R.set(k.key,k):R.set(k.index,k),k=k.sibling;return R}function d(R,k){return R=Ln(R,k),R.index=0,R.sibling=null,R}function m(R,k,L){return R.index=L,n?(L=R.alternate,L!==null?(L=L.index,L<k?(R.flags|=2,k):L):(R.flags|=2,k)):(R.flags|=1048576,k)}function A(R){return n&&R.alternate===null&&(R.flags|=2),R}function b(R,k,L,$){return k===null||k.tag!==6?(k=rl(L,R.mode,$),k.return=R,k):(k=d(k,L),k.return=R,k)}function C(R,k,L,$){var et=L.type;return et===H?z(R,k,L.props.children,$,L.key):k!==null&&(k.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===G&&Ac(et)===k.type)?($=d(k,L.props),$.ref=ls(R,k,L),$.return=R,$):($=Br(L.type,L.key,L.props,null,R.mode,$),$.ref=ls(R,k,L),$.return=R,$)}function I(R,k,L,$){return k===null||k.tag!==4||k.stateNode.containerInfo!==L.containerInfo||k.stateNode.implementation!==L.implementation?(k=al(L,R.mode,$),k.return=R,k):(k=d(k,L.children||[]),k.return=R,k)}function z(R,k,L,$,et){return k===null||k.tag!==7?(k=Qn(L,R.mode,$,et),k.return=R,k):(k=d(k,L),k.return=R,k)}function j(R,k,L){if(typeof k=="string"&&k!==""||typeof k=="number")return k=rl(""+k,R.mode,L),k.return=R,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case D:return L=Br(k.type,k.key,k.props,null,R.mode,L),L.ref=ls(R,null,k),L.return=R,L;case B:return k=al(k,R.mode,L),k.return=R,k;case G:var $=k._init;return j(R,$(k._payload),L)}if(Oi(k)||tt(k))return k=Qn(k,R.mode,L,null),k.return=R,k;mr(R,k)}return null}function O(R,k,L,$){var et=k!==null?k.key:null;if(typeof L=="string"&&L!==""||typeof L=="number")return et!==null?null:b(R,k,""+L,$);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case D:return L.key===et?C(R,k,L,$):null;case B:return L.key===et?I(R,k,L,$):null;case G:return et=L._init,O(R,k,et(L._payload),$)}if(Oi(L)||tt(L))return et!==null?null:z(R,k,L,$,null);mr(R,L)}return null}function q(R,k,L,$,et){if(typeof $=="string"&&$!==""||typeof $=="number")return R=R.get(L)||null,b(k,R,""+$,et);if(typeof $=="object"&&$!==null){switch($.$$typeof){case D:return R=R.get($.key===null?L:$.key)||null,C(k,R,$,et);case B:return R=R.get($.key===null?L:$.key)||null,I(k,R,$,et);case G:var rt=$._init;return q(R,k,L,rt($._payload),et)}if(Oi($)||tt($))return R=R.get(L)||null,z(k,R,$,et,null);mr(k,$)}return null}function Q(R,k,L,$){for(var et=null,rt=null,at=k,ht=k=0,te=null;at!==null&&ht<L.length;ht++){at.index>ht?(te=at,at=null):te=at.sibling;var kt=O(R,at,L[ht],$);if(kt===null){at===null&&(at=te);break}n&&at&&kt.alternate===null&&i(R,at),k=m(kt,k,ht),rt===null?et=kt:rt.sibling=kt,rt=kt,at=te}if(ht===L.length)return a(R,at),Dt&&$n(R,ht),et;if(at===null){for(;ht<L.length;ht++)at=j(R,L[ht],$),at!==null&&(k=m(at,k,ht),rt===null?et=at:rt.sibling=at,rt=at);return Dt&&$n(R,ht),et}for(at=c(R,at);ht<L.length;ht++)te=q(at,R,ht,L[ht],$),te!==null&&(n&&te.alternate!==null&&at.delete(te.key===null?ht:te.key),k=m(te,k,ht),rt===null?et=te:rt.sibling=te,rt=te);return n&&at.forEach(function(In){return i(R,In)}),Dt&&$n(R,ht),et}function J(R,k,L,$){var et=tt(L);if(typeof et!="function")throw Error(e(150));if(L=et.call(L),L==null)throw Error(e(151));for(var rt=et=null,at=k,ht=k=0,te=null,kt=L.next();at!==null&&!kt.done;ht++,kt=L.next()){at.index>ht?(te=at,at=null):te=at.sibling;var In=O(R,at,kt.value,$);if(In===null){at===null&&(at=te);break}n&&at&&In.alternate===null&&i(R,at),k=m(In,k,ht),rt===null?et=In:rt.sibling=In,rt=In,at=te}if(kt.done)return a(R,at),Dt&&$n(R,ht),et;if(at===null){for(;!kt.done;ht++,kt=L.next())kt=j(R,kt.value,$),kt!==null&&(k=m(kt,k,ht),rt===null?et=kt:rt.sibling=kt,rt=kt);return Dt&&$n(R,ht),et}for(at=c(R,at);!kt.done;ht++,kt=L.next())kt=q(at,R,ht,kt.value,$),kt!==null&&(n&&kt.alternate!==null&&at.delete(kt.key===null?ht:kt.key),k=m(kt,k,ht),rt===null?et=kt:rt.sibling=kt,rt=kt);return n&&at.forEach(function(Wp){return i(R,Wp)}),Dt&&$n(R,ht),et}function Ut(R,k,L,$){if(typeof L=="object"&&L!==null&&L.type===H&&L.key===null&&(L=L.props.children),typeof L=="object"&&L!==null){switch(L.$$typeof){case D:t:{for(var et=L.key,rt=k;rt!==null;){if(rt.key===et){if(et=L.type,et===H){if(rt.tag===7){a(R,rt.sibling),k=d(rt,L.props.children),k.return=R,R=k;break t}}else if(rt.elementType===et||typeof et=="object"&&et!==null&&et.$$typeof===G&&Ac(et)===rt.type){a(R,rt.sibling),k=d(rt,L.props),k.ref=ls(R,rt,L),k.return=R,R=k;break t}a(R,rt);break}else i(R,rt);rt=rt.sibling}L.type===H?(k=Qn(L.props.children,R.mode,$,L.key),k.return=R,R=k):($=Br(L.type,L.key,L.props,null,R.mode,$),$.ref=ls(R,k,L),$.return=R,R=$)}return A(R);case B:t:{for(rt=L.key;k!==null;){if(k.key===rt)if(k.tag===4&&k.stateNode.containerInfo===L.containerInfo&&k.stateNode.implementation===L.implementation){a(R,k.sibling),k=d(k,L.children||[]),k.return=R,R=k;break t}else{a(R,k);break}else i(R,k);k=k.sibling}k=al(L,R.mode,$),k.return=R,R=k}return A(R);case G:return rt=L._init,Ut(R,k,rt(L._payload),$)}if(Oi(L))return Q(R,k,L,$);if(tt(L))return J(R,k,L,$);mr(R,L)}return typeof L=="string"&&L!==""||typeof L=="number"?(L=""+L,k!==null&&k.tag===6?(a(R,k.sibling),k=d(k,L),k.return=R,R=k):(a(R,k),k=rl(L,R.mode,$),k.return=R,R=k),A(R)):a(R,k)}return Ut}var Ai=_c(!0),Sc=_c(!1),vr=Sn(null),yr=null,_i=null,go=null;function mo(){go=_i=yr=null}function vo(n){var i=vr.current;Nt(vr),n._currentValue=i}function yo(n,i,a){for(;n!==null;){var c=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,c!==null&&(c.childLanes|=i)):c!==null&&(c.childLanes&i)!==i&&(c.childLanes|=i),n===a)break;n=n.return}}function Si(n,i){yr=n,go=_i=null,n=n.dependencies,n!==null&&n.firstContext!==null&&((n.lanes&i)!==0&&(ye=!0),n.firstContext=null)}function Ie(n){var i=n._currentValue;if(go!==n)if(n={context:n,memoizedValue:i,next:null},_i===null){if(yr===null)throw Error(e(308));_i=n,yr.dependencies={lanes:0,firstContext:n}}else _i=_i.next=n;return i}var Vn=null;function wo(n){Vn===null?Vn=[n]:Vn.push(n)}function bc(n,i,a,c){var d=i.interleaved;return d===null?(a.next=a,wo(i)):(a.next=d.next,d.next=a),i.interleaved=a,un(n,c)}function un(n,i){n.lanes|=i;var a=n.alternate;for(a!==null&&(a.lanes|=i),a=n,n=n.return;n!==null;)n.childLanes|=i,a=n.alternate,a!==null&&(a.childLanes|=i),a=n,n=n.return;return a.tag===3?a.stateNode:null}var xn=!1;function Ao(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ec(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function cn(n,i){return{eventTime:n,lane:i,tag:0,payload:null,callback:null,next:null}}function Cn(n,i,a){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(Ct&2)!==0){var d=c.pending;return d===null?i.next=i:(i.next=d.next,d.next=i),c.pending=i,un(n,a)}return d=c.interleaved,d===null?(i.next=i,wo(c)):(i.next=d.next,d.next=i),c.interleaved=i,un(n,a)}function wr(n,i,a){if(i=i.updateQueue,i!==null&&(i=i.shared,(a&4194240)!==0)){var c=i.lanes;c&=n.pendingLanes,a|=c,i.lanes=a,Ia(n,a)}}function xc(n,i){var a=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var d=null,m=null;if(a=a.firstBaseUpdate,a!==null){do{var A={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};m===null?d=m=A:m=m.next=A,a=a.next}while(a!==null);m===null?d=m=i:m=m.next=i}else d=m=i;a={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:m,shared:c.shared,effects:c.effects},n.updateQueue=a;return}n=a.lastBaseUpdate,n===null?a.firstBaseUpdate=i:n.next=i,a.lastBaseUpdate=i}function Ar(n,i,a,c){var d=n.updateQueue;xn=!1;var m=d.firstBaseUpdate,A=d.lastBaseUpdate,b=d.shared.pending;if(b!==null){d.shared.pending=null;var C=b,I=C.next;C.next=null,A===null?m=I:A.next=I,A=C;var z=n.alternate;z!==null&&(z=z.updateQueue,b=z.lastBaseUpdate,b!==A&&(b===null?z.firstBaseUpdate=I:b.next=I,z.lastBaseUpdate=C))}if(m!==null){var j=d.baseState;A=0,z=I=C=null,b=m;do{var O=b.lane,q=b.eventTime;if((c&O)===O){z!==null&&(z=z.next={eventTime:q,lane:0,tag:b.tag,payload:b.payload,callback:b.callback,next:null});t:{var Q=n,J=b;switch(O=i,q=a,J.tag){case 1:if(Q=J.payload,typeof Q=="function"){j=Q.call(q,j,O);break t}j=Q;break t;case 3:Q.flags=Q.flags&-65537|128;case 0:if(Q=J.payload,O=typeof Q=="function"?Q.call(q,j,O):Q,O==null)break t;j=W({},j,O);break t;case 2:xn=!0}}b.callback!==null&&b.lane!==0&&(n.flags|=64,O=d.effects,O===null?d.effects=[b]:O.push(b))}else q={eventTime:q,lane:O,tag:b.tag,payload:b.payload,callback:b.callback,next:null},z===null?(I=z=q,C=j):z=z.next=q,A|=O;if(b=b.next,b===null){if(b=d.shared.pending,b===null)break;O=b,b=O.next,O.next=null,d.lastBaseUpdate=O,d.shared.pending=null}}while(!0);if(z===null&&(C=j),d.baseState=C,d.firstBaseUpdate=I,d.lastBaseUpdate=z,i=d.shared.interleaved,i!==null){d=i;do A|=d.lane,d=d.next;while(d!==i)}else m===null&&(d.shared.lanes=0);Xn|=A,n.lanes=A,n.memoizedState=j}}function Cc(n,i,a){if(n=i.effects,i.effects=null,n!==null)for(i=0;i<n.length;i++){var c=n[i],d=c.callback;if(d!==null){if(c.callback=null,c=a,typeof d!="function")throw Error(e(191,d));d.call(c)}}}var us={},Ze=Sn(us),cs=Sn(us),hs=Sn(us);function Gn(n){if(n===us)throw Error(e(174));return n}function _o(n,i){switch(Lt(hs,i),Lt(cs,n),Lt(Ze,us),n=i.nodeType,n){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:_a(null,"");break;default:n=n===8?i.parentNode:i,i=n.namespaceURI||null,n=n.tagName,i=_a(i,n)}Nt(Ze),Lt(Ze,i)}function bi(){Nt(Ze),Nt(cs),Nt(hs)}function kc(n){Gn(hs.current);var i=Gn(Ze.current),a=_a(i,n.type);i!==a&&(Lt(cs,n),Lt(Ze,a))}function So(n){cs.current===n&&(Nt(Ze),Nt(cs))}var zt=Sn(0);function _r(n){for(var i=n;i!==null;){if(i.tag===13){var a=i.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var bo=[];function Eo(){for(var n=0;n<bo.length;n++)bo[n]._workInProgressVersionPrimary=null;bo.length=0}var Sr=N.ReactCurrentDispatcher,xo=N.ReactCurrentBatchConfig,Wn=0,jt=null,qt=null,Zt=null,br=!1,ds=!1,fs=0,pp=0;function se(){throw Error(e(321))}function Co(n,i){if(i===null)return!1;for(var a=0;a<i.length&&a<n.length;a++)if(!He(n[a],i[a]))return!1;return!0}function ko(n,i,a,c,d,m){if(Wn=m,jt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Sr.current=n===null||n.memoizedState===null?yp:wp,n=a(c,d),ds){m=0;do{if(ds=!1,fs=0,25<=m)throw Error(e(301));m+=1,Zt=qt=null,i.updateQueue=null,Sr.current=Ap,n=a(c,d)}while(ds)}if(Sr.current=Cr,i=qt!==null&&qt.next!==null,Wn=0,Zt=qt=jt=null,br=!1,i)throw Error(e(300));return n}function To(){var n=fs!==0;return fs=0,n}function Je(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?jt.memoizedState=Zt=n:Zt=Zt.next=n,Zt}function Ne(){if(qt===null){var n=jt.alternate;n=n!==null?n.memoizedState:null}else n=qt.next;var i=Zt===null?jt.memoizedState:Zt.next;if(i!==null)Zt=i,qt=n;else{if(n===null)throw Error(e(310));qt=n,n={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},Zt===null?jt.memoizedState=Zt=n:Zt=Zt.next=n}return Zt}function ps(n,i){return typeof i=="function"?i(n):i}function Po(n){var i=Ne(),a=i.queue;if(a===null)throw Error(e(311));a.lastRenderedReducer=n;var c=qt,d=c.baseQueue,m=a.pending;if(m!==null){if(d!==null){var A=d.next;d.next=m.next,m.next=A}c.baseQueue=d=m,a.pending=null}if(d!==null){m=d.next,c=c.baseState;var b=A=null,C=null,I=m;do{var z=I.lane;if((Wn&z)===z)C!==null&&(C=C.next={lane:0,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null}),c=I.hasEagerState?I.eagerState:n(c,I.action);else{var j={lane:z,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null};C===null?(b=C=j,A=c):C=C.next=j,jt.lanes|=z,Xn|=z}I=I.next}while(I!==null&&I!==m);C===null?A=c:C.next=b,He(c,i.memoizedState)||(ye=!0),i.memoizedState=c,i.baseState=A,i.baseQueue=C,a.lastRenderedState=c}if(n=a.interleaved,n!==null){d=n;do m=d.lane,jt.lanes|=m,Xn|=m,d=d.next;while(d!==n)}else d===null&&(a.lanes=0);return[i.memoizedState,a.dispatch]}function Ro(n){var i=Ne(),a=i.queue;if(a===null)throw Error(e(311));a.lastRenderedReducer=n;var c=a.dispatch,d=a.pending,m=i.memoizedState;if(d!==null){a.pending=null;var A=d=d.next;do m=n(m,A.action),A=A.next;while(A!==d);He(m,i.memoizedState)||(ye=!0),i.memoizedState=m,i.baseQueue===null&&(i.baseState=m),a.lastRenderedState=m}return[m,c]}function Tc(){}function Pc(n,i){var a=jt,c=Ne(),d=i(),m=!He(c.memoizedState,d);if(m&&(c.memoizedState=d,ye=!0),c=c.queue,Mo(Lc.bind(null,a,c,n),[n]),c.getSnapshot!==i||m||Zt!==null&&Zt.memoizedState.tag&1){if(a.flags|=2048,gs(9,Mc.bind(null,a,c,d,i),void 0,null),Jt===null)throw Error(e(349));(Wn&30)!==0||Rc(a,i,d)}return d}function Rc(n,i,a){n.flags|=16384,n={getSnapshot:i,value:a},i=jt.updateQueue,i===null?(i={lastEffect:null,stores:null},jt.updateQueue=i,i.stores=[n]):(a=i.stores,a===null?i.stores=[n]:a.push(n))}function Mc(n,i,a,c){i.value=a,i.getSnapshot=c,Ic(i)&&Nc(n)}function Lc(n,i,a){return a(function(){Ic(i)&&Nc(n)})}function Ic(n){var i=n.getSnapshot;n=n.value;try{var a=i();return!He(n,a)}catch{return!0}}function Nc(n){var i=un(n,1);i!==null&&We(i,n,1,-1)}function Dc(n){var i=Je();return typeof n=="function"&&(n=n()),i.memoizedState=i.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ps,lastRenderedState:n},i.queue=n,n=n.dispatch=vp.bind(null,jt,n),[i.memoizedState,n]}function gs(n,i,a,c){return n={tag:n,create:i,destroy:a,deps:c,next:null},i=jt.updateQueue,i===null?(i={lastEffect:null,stores:null},jt.updateQueue=i,i.lastEffect=n.next=n):(a=i.lastEffect,a===null?i.lastEffect=n.next=n:(c=a.next,a.next=n,n.next=c,i.lastEffect=n)),n}function Fc(){return Ne().memoizedState}function Er(n,i,a,c){var d=Je();jt.flags|=n,d.memoizedState=gs(1|i,a,void 0,c===void 0?null:c)}function xr(n,i,a,c){var d=Ne();c=c===void 0?null:c;var m=void 0;if(qt!==null){var A=qt.memoizedState;if(m=A.destroy,c!==null&&Co(c,A.deps)){d.memoizedState=gs(i,a,m,c);return}}jt.flags|=n,d.memoizedState=gs(1|i,a,m,c)}function Oc(n,i){return Er(8390656,8,n,i)}function Mo(n,i){return xr(2048,8,n,i)}function zc(n,i){return xr(4,2,n,i)}function jc(n,i){return xr(4,4,n,i)}function Bc(n,i){if(typeof i=="function")return n=n(),i(n),function(){i(null)};if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function Hc(n,i,a){return a=a!=null?a.concat([n]):null,xr(4,4,Bc.bind(null,i,n),a)}function Lo(){}function Uc(n,i){var a=Ne();i=i===void 0?null:i;var c=a.memoizedState;return c!==null&&i!==null&&Co(i,c[1])?c[0]:(a.memoizedState=[n,i],n)}function $c(n,i){var a=Ne();i=i===void 0?null:i;var c=a.memoizedState;return c!==null&&i!==null&&Co(i,c[1])?c[0]:(n=n(),a.memoizedState=[n,i],n)}function Vc(n,i,a){return(Wn&21)===0?(n.baseState&&(n.baseState=!1,ye=!0),n.memoizedState=a):(He(a,i)||(a=Au(),jt.lanes|=a,Xn|=a,n.baseState=!0),i)}function gp(n,i){var a=Tt;Tt=a!==0&&4>a?a:4,n(!0);var c=xo.transition;xo.transition={};try{n(!1),i()}finally{Tt=a,xo.transition=c}}function Gc(){return Ne().memoizedState}function mp(n,i,a){var c=Rn(n);if(a={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null},Wc(n))Xc(i,a);else if(a=bc(n,i,a,c),a!==null){var d=de();We(a,n,c,d),qc(a,i,c)}}function vp(n,i,a){var c=Rn(n),d={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null};if(Wc(n))Xc(i,d);else{var m=n.alternate;if(n.lanes===0&&(m===null||m.lanes===0)&&(m=i.lastRenderedReducer,m!==null))try{var A=i.lastRenderedState,b=m(A,a);if(d.hasEagerState=!0,d.eagerState=b,He(b,A)){var C=i.interleaved;C===null?(d.next=d,wo(i)):(d.next=C.next,C.next=d),i.interleaved=d;return}}catch{}finally{}a=bc(n,i,d,c),a!==null&&(d=de(),We(a,n,c,d),qc(a,i,c))}}function Wc(n){var i=n.alternate;return n===jt||i!==null&&i===jt}function Xc(n,i){ds=br=!0;var a=n.pending;a===null?i.next=i:(i.next=a.next,a.next=i),n.pending=i}function qc(n,i,a){if((a&4194240)!==0){var c=i.lanes;c&=n.pendingLanes,a|=c,i.lanes=a,Ia(n,a)}}var Cr={readContext:Ie,useCallback:se,useContext:se,useEffect:se,useImperativeHandle:se,useInsertionEffect:se,useLayoutEffect:se,useMemo:se,useReducer:se,useRef:se,useState:se,useDebugValue:se,useDeferredValue:se,useTransition:se,useMutableSource:se,useSyncExternalStore:se,useId:se,unstable_isNewReconciler:!1},yp={readContext:Ie,useCallback:function(n,i){return Je().memoizedState=[n,i===void 0?null:i],n},useContext:Ie,useEffect:Oc,useImperativeHandle:function(n,i,a){return a=a!=null?a.concat([n]):null,Er(4194308,4,Bc.bind(null,i,n),a)},useLayoutEffect:function(n,i){return Er(4194308,4,n,i)},useInsertionEffect:function(n,i){return Er(4,2,n,i)},useMemo:function(n,i){var a=Je();return i=i===void 0?null:i,n=n(),a.memoizedState=[n,i],n},useReducer:function(n,i,a){var c=Je();return i=a!==void 0?a(i):i,c.memoizedState=c.baseState=i,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:i},c.queue=n,n=n.dispatch=mp.bind(null,jt,n),[c.memoizedState,n]},useRef:function(n){var i=Je();return n={current:n},i.memoizedState=n},useState:Dc,useDebugValue:Lo,useDeferredValue:function(n){return Je().memoizedState=n},useTransition:function(){var n=Dc(!1),i=n[0];return n=gp.bind(null,n[1]),Je().memoizedState=n,[i,n]},useMutableSource:function(){},useSyncExternalStore:function(n,i,a){var c=jt,d=Je();if(Dt){if(a===void 0)throw Error(e(407));a=a()}else{if(a=i(),Jt===null)throw Error(e(349));(Wn&30)!==0||Rc(c,i,a)}d.memoizedState=a;var m={value:a,getSnapshot:i};return d.queue=m,Oc(Lc.bind(null,c,m,n),[n]),c.flags|=2048,gs(9,Mc.bind(null,c,m,a,i),void 0,null),a},useId:function(){var n=Je(),i=Jt.identifierPrefix;if(Dt){var a=ln,c=on;a=(c&~(1<<32-Be(c)-1)).toString(32)+a,i=":"+i+"R"+a,a=fs++,0<a&&(i+="H"+a.toString(32)),i+=":"}else a=pp++,i=":"+i+"r"+a.toString(32)+":";return n.memoizedState=i},unstable_isNewReconciler:!1},wp={readContext:Ie,useCallback:Uc,useContext:Ie,useEffect:Mo,useImperativeHandle:Hc,useInsertionEffect:zc,useLayoutEffect:jc,useMemo:$c,useReducer:Po,useRef:Fc,useState:function(){return Po(ps)},useDebugValue:Lo,useDeferredValue:function(n){var i=Ne();return Vc(i,qt.memoizedState,n)},useTransition:function(){var n=Po(ps)[0],i=Ne().memoizedState;return[n,i]},useMutableSource:Tc,useSyncExternalStore:Pc,useId:Gc,unstable_isNewReconciler:!1},Ap={readContext:Ie,useCallback:Uc,useContext:Ie,useEffect:Mo,useImperativeHandle:Hc,useInsertionEffect:zc,useLayoutEffect:jc,useMemo:$c,useReducer:Ro,useRef:Fc,useState:function(){return Ro(ps)},useDebugValue:Lo,useDeferredValue:function(n){var i=Ne();return qt===null?i.memoizedState=n:Vc(i,qt.memoizedState,n)},useTransition:function(){var n=Ro(ps)[0],i=Ne().memoizedState;return[n,i]},useMutableSource:Tc,useSyncExternalStore:Pc,useId:Gc,unstable_isNewReconciler:!1};function $e(n,i){if(n&&n.defaultProps){i=W({},i),n=n.defaultProps;for(var a in n)i[a]===void 0&&(i[a]=n[a]);return i}return i}function Io(n,i,a,c){i=n.memoizedState,a=a(c,i),a=a==null?i:W({},i,a),n.memoizedState=a,n.lanes===0&&(n.updateQueue.baseState=a)}var kr={isMounted:function(n){return(n=n._reactInternals)?jn(n)===n:!1},enqueueSetState:function(n,i,a){n=n._reactInternals;var c=de(),d=Rn(n),m=cn(c,d);m.payload=i,a!=null&&(m.callback=a),i=Cn(n,m,d),i!==null&&(We(i,n,d,c),wr(i,n,d))},enqueueReplaceState:function(n,i,a){n=n._reactInternals;var c=de(),d=Rn(n),m=cn(c,d);m.tag=1,m.payload=i,a!=null&&(m.callback=a),i=Cn(n,m,d),i!==null&&(We(i,n,d,c),wr(i,n,d))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var a=de(),c=Rn(n),d=cn(a,c);d.tag=2,i!=null&&(d.callback=i),i=Cn(n,d,c),i!==null&&(We(i,n,c,a),wr(i,n,c))}};function Yc(n,i,a,c,d,m,A){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,m,A):i.prototype&&i.prototype.isPureReactComponent?!es(a,c)||!es(d,m):!0}function Kc(n,i,a){var c=!1,d=bn,m=i.contextType;return typeof m=="object"&&m!==null?m=Ie(m):(d=ve(i)?Hn:ie.current,c=i.contextTypes,m=(c=c!=null)?mi(n,d):bn),i=new i(a,m),n.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=kr,n.stateNode=i,i._reactInternals=n,c&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=d,n.__reactInternalMemoizedMaskedChildContext=m),i}function Qc(n,i,a,c){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(a,c),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(a,c),i.state!==n&&kr.enqueueReplaceState(i,i.state,null)}function No(n,i,a,c){var d=n.stateNode;d.props=a,d.state=n.memoizedState,d.refs={},Ao(n);var m=i.contextType;typeof m=="object"&&m!==null?d.context=Ie(m):(m=ve(i)?Hn:ie.current,d.context=mi(n,m)),d.state=n.memoizedState,m=i.getDerivedStateFromProps,typeof m=="function"&&(Io(n,i,m,a),d.state=n.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(i=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),i!==d.state&&kr.enqueueReplaceState(d,d.state,null),Ar(n,a,d,c),d.state=n.memoizedState),typeof d.componentDidMount=="function"&&(n.flags|=4194308)}function Ei(n,i){try{var a="",c=i;do a+=wt(c),c=c.return;while(c);var d=a}catch(m){d=`
Error generating stack: `+m.message+`
`+m.stack}return{value:n,source:i,stack:d,digest:null}}function Do(n,i,a){return{value:n,source:null,stack:a??null,digest:i??null}}function Fo(n,i){try{console.error(i.value)}catch(a){setTimeout(function(){throw a})}}var _p=typeof WeakMap=="function"?WeakMap:Map;function Zc(n,i,a){a=cn(-1,a),a.tag=3,a.payload={element:null};var c=i.value;return a.callback=function(){Nr||(Nr=!0,Qo=c),Fo(n,i)},a}function Jc(n,i,a){a=cn(-1,a),a.tag=3;var c=n.type.getDerivedStateFromError;if(typeof c=="function"){var d=i.value;a.payload=function(){return c(d)},a.callback=function(){Fo(n,i)}}var m=n.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(a.callback=function(){Fo(n,i),typeof c!="function"&&(Tn===null?Tn=new Set([this]):Tn.add(this));var A=i.stack;this.componentDidCatch(i.value,{componentStack:A!==null?A:""})}),a}function th(n,i,a){var c=n.pingCache;if(c===null){c=n.pingCache=new _p;var d=new Set;c.set(i,d)}else d=c.get(i),d===void 0&&(d=new Set,c.set(i,d));d.has(a)||(d.add(a),n=Dp.bind(null,n,i,a),i.then(n,n))}function eh(n){do{var i;if((i=n.tag===13)&&(i=n.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return n;n=n.return}while(n!==null);return null}function nh(n,i,a,c,d){return(n.mode&1)===0?(n===i?n.flags|=65536:(n.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(i=cn(-1,1),i.tag=2,Cn(a,i,1))),a.lanes|=1),n):(n.flags|=65536,n.lanes=d,n)}var Sp=N.ReactCurrentOwner,ye=!1;function he(n,i,a,c){i.child=n===null?Sc(i,null,a,c):Ai(i,n.child,a,c)}function ih(n,i,a,c,d){a=a.render;var m=i.ref;return Si(i,d),c=ko(n,i,a,c,m,d),a=To(),n!==null&&!ye?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~d,hn(n,i,d)):(Dt&&a&&uo(i),i.flags|=1,he(n,i,c,d),i.child)}function sh(n,i,a,c,d){if(n===null){var m=a.type;return typeof m=="function"&&!sl(m)&&m.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(i.tag=15,i.type=m,rh(n,i,m,c,d)):(n=Br(a.type,null,c,i,i.mode,d),n.ref=i.ref,n.return=i,i.child=n)}if(m=n.child,(n.lanes&d)===0){var A=m.memoizedProps;if(a=a.compare,a=a!==null?a:es,a(A,c)&&n.ref===i.ref)return hn(n,i,d)}return i.flags|=1,n=Ln(m,c),n.ref=i.ref,n.return=i,i.child=n}function rh(n,i,a,c,d){if(n!==null){var m=n.memoizedProps;if(es(m,c)&&n.ref===i.ref)if(ye=!1,i.pendingProps=c=m,(n.lanes&d)!==0)(n.flags&131072)!==0&&(ye=!0);else return i.lanes=n.lanes,hn(n,i,d)}return Oo(n,i,a,c,d)}function ah(n,i,a){var c=i.pendingProps,d=c.children,m=n!==null?n.memoizedState:null;if(c.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Lt(Ci,Te),Te|=a;else{if((a&1073741824)===0)return n=m!==null?m.baseLanes|a:a,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:n,cachePool:null,transitions:null},i.updateQueue=null,Lt(Ci,Te),Te|=n,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=m!==null?m.baseLanes:a,Lt(Ci,Te),Te|=c}else m!==null?(c=m.baseLanes|a,i.memoizedState=null):c=a,Lt(Ci,Te),Te|=c;return he(n,i,d,a),i.child}function oh(n,i){var a=i.ref;(n===null&&a!==null||n!==null&&n.ref!==a)&&(i.flags|=512,i.flags|=2097152)}function Oo(n,i,a,c,d){var m=ve(a)?Hn:ie.current;return m=mi(i,m),Si(i,d),a=ko(n,i,a,c,m,d),c=To(),n!==null&&!ye?(i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~d,hn(n,i,d)):(Dt&&c&&uo(i),i.flags|=1,he(n,i,a,d),i.child)}function lh(n,i,a,c,d){if(ve(a)){var m=!0;hr(i)}else m=!1;if(Si(i,d),i.stateNode===null)Pr(n,i),Kc(i,a,c),No(i,a,c,d),c=!0;else if(n===null){var A=i.stateNode,b=i.memoizedProps;A.props=b;var C=A.context,I=a.contextType;typeof I=="object"&&I!==null?I=Ie(I):(I=ve(a)?Hn:ie.current,I=mi(i,I));var z=a.getDerivedStateFromProps,j=typeof z=="function"||typeof A.getSnapshotBeforeUpdate=="function";j||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(b!==c||C!==I)&&Qc(i,A,c,I),xn=!1;var O=i.memoizedState;A.state=O,Ar(i,c,A,d),C=i.memoizedState,b!==c||O!==C||me.current||xn?(typeof z=="function"&&(Io(i,a,z,c),C=i.memoizedState),(b=xn||Yc(i,a,b,c,O,C,I))?(j||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(i.flags|=4194308)):(typeof A.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=c,i.memoizedState=C),A.props=c,A.state=C,A.context=I,c=b):(typeof A.componentDidMount=="function"&&(i.flags|=4194308),c=!1)}else{A=i.stateNode,Ec(n,i),b=i.memoizedProps,I=i.type===i.elementType?b:$e(i.type,b),A.props=I,j=i.pendingProps,O=A.context,C=a.contextType,typeof C=="object"&&C!==null?C=Ie(C):(C=ve(a)?Hn:ie.current,C=mi(i,C));var q=a.getDerivedStateFromProps;(z=typeof q=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(b!==j||O!==C)&&Qc(i,A,c,C),xn=!1,O=i.memoizedState,A.state=O,Ar(i,c,A,d);var Q=i.memoizedState;b!==j||O!==Q||me.current||xn?(typeof q=="function"&&(Io(i,a,q,c),Q=i.memoizedState),(I=xn||Yc(i,a,I,c,O,Q,C)||!1)?(z||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(c,Q,C),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(c,Q,C)),typeof A.componentDidUpdate=="function"&&(i.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof A.componentDidUpdate!="function"||b===n.memoizedProps&&O===n.memoizedState||(i.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||b===n.memoizedProps&&O===n.memoizedState||(i.flags|=1024),i.memoizedProps=c,i.memoizedState=Q),A.props=c,A.state=Q,A.context=C,c=I):(typeof A.componentDidUpdate!="function"||b===n.memoizedProps&&O===n.memoizedState||(i.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||b===n.memoizedProps&&O===n.memoizedState||(i.flags|=1024),c=!1)}return zo(n,i,a,c,m,d)}function zo(n,i,a,c,d,m){oh(n,i);var A=(i.flags&128)!==0;if(!c&&!A)return d&&fc(i,a,!1),hn(n,i,m);c=i.stateNode,Sp.current=i;var b=A&&typeof a.getDerivedStateFromError!="function"?null:c.render();return i.flags|=1,n!==null&&A?(i.child=Ai(i,n.child,null,m),i.child=Ai(i,null,b,m)):he(n,i,b,m),i.memoizedState=c.state,d&&fc(i,a,!0),i.child}function uh(n){var i=n.stateNode;i.pendingContext?hc(n,i.pendingContext,i.pendingContext!==i.context):i.context&&hc(n,i.context,!1),_o(n,i.containerInfo)}function ch(n,i,a,c,d){return wi(),po(d),i.flags|=256,he(n,i,a,c),i.child}var jo={dehydrated:null,treeContext:null,retryLane:0};function Bo(n){return{baseLanes:n,cachePool:null,transitions:null}}function hh(n,i,a){var c=i.pendingProps,d=zt.current,m=!1,A=(i.flags&128)!==0,b;if((b=A)||(b=n!==null&&n.memoizedState===null?!1:(d&2)!==0),b?(m=!0,i.flags&=-129):(n===null||n.memoizedState!==null)&&(d|=1),Lt(zt,d&1),n===null)return fo(i),n=i.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?((i.mode&1)===0?i.lanes=1:n.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(A=c.children,n=c.fallback,m?(c=i.mode,m=i.child,A={mode:"hidden",children:A},(c&1)===0&&m!==null?(m.childLanes=0,m.pendingProps=A):m=Hr(A,c,0,null),n=Qn(n,c,a,null),m.return=i,n.return=i,m.sibling=n,i.child=m,i.child.memoizedState=Bo(a),i.memoizedState=jo,n):Ho(i,A));if(d=n.memoizedState,d!==null&&(b=d.dehydrated,b!==null))return bp(n,i,A,c,b,d,a);if(m){m=c.fallback,A=i.mode,d=n.child,b=d.sibling;var C={mode:"hidden",children:c.children};return(A&1)===0&&i.child!==d?(c=i.child,c.childLanes=0,c.pendingProps=C,i.deletions=null):(c=Ln(d,C),c.subtreeFlags=d.subtreeFlags&14680064),b!==null?m=Ln(b,m):(m=Qn(m,A,a,null),m.flags|=2),m.return=i,c.return=i,c.sibling=m,i.child=c,c=m,m=i.child,A=n.child.memoizedState,A=A===null?Bo(a):{baseLanes:A.baseLanes|a,cachePool:null,transitions:A.transitions},m.memoizedState=A,m.childLanes=n.childLanes&~a,i.memoizedState=jo,c}return m=n.child,n=m.sibling,c=Ln(m,{mode:"visible",children:c.children}),(i.mode&1)===0&&(c.lanes=a),c.return=i,c.sibling=null,n!==null&&(a=i.deletions,a===null?(i.deletions=[n],i.flags|=16):a.push(n)),i.child=c,i.memoizedState=null,c}function Ho(n,i){return i=Hr({mode:"visible",children:i},n.mode,0,null),i.return=n,n.child=i}function Tr(n,i,a,c){return c!==null&&po(c),Ai(i,n.child,null,a),n=Ho(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function bp(n,i,a,c,d,m,A){if(a)return i.flags&256?(i.flags&=-257,c=Do(Error(e(422))),Tr(n,i,A,c)):i.memoizedState!==null?(i.child=n.child,i.flags|=128,null):(m=c.fallback,d=i.mode,c=Hr({mode:"visible",children:c.children},d,0,null),m=Qn(m,d,A,null),m.flags|=2,c.return=i,m.return=i,c.sibling=m,i.child=c,(i.mode&1)!==0&&Ai(i,n.child,null,A),i.child.memoizedState=Bo(A),i.memoizedState=jo,m);if((i.mode&1)===0)return Tr(n,i,A,null);if(d.data==="$!"){if(c=d.nextSibling&&d.nextSibling.dataset,c)var b=c.dgst;return c=b,m=Error(e(419)),c=Do(m,c,void 0),Tr(n,i,A,c)}if(b=(A&n.childLanes)!==0,ye||b){if(c=Jt,c!==null){switch(A&-A){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=(d&(c.suspendedLanes|A))!==0?0:d,d!==0&&d!==m.retryLane&&(m.retryLane=d,un(n,d),We(c,n,d,-1))}return il(),c=Do(Error(e(421))),Tr(n,i,A,c)}return d.data==="$?"?(i.flags|=128,i.child=n.child,i=Fp.bind(null,n),d._reactRetry=i,null):(n=m.treeContext,ke=_n(d.nextSibling),Ce=i,Dt=!0,Ue=null,n!==null&&(Me[Le++]=on,Me[Le++]=ln,Me[Le++]=Un,on=n.id,ln=n.overflow,Un=i),i=Ho(i,c.children),i.flags|=4096,i)}function dh(n,i,a){n.lanes|=i;var c=n.alternate;c!==null&&(c.lanes|=i),yo(n.return,i,a)}function Uo(n,i,a,c,d){var m=n.memoizedState;m===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:d}:(m.isBackwards=i,m.rendering=null,m.renderingStartTime=0,m.last=c,m.tail=a,m.tailMode=d)}function fh(n,i,a){var c=i.pendingProps,d=c.revealOrder,m=c.tail;if(he(n,i,c.children,a),c=zt.current,(c&2)!==0)c=c&1|2,i.flags|=128;else{if(n!==null&&(n.flags&128)!==0)t:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&dh(n,a,i);else if(n.tag===19)dh(n,a,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break t;for(;n.sibling===null;){if(n.return===null||n.return===i)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}c&=1}if(Lt(zt,c),(i.mode&1)===0)i.memoizedState=null;else switch(d){case"forwards":for(a=i.child,d=null;a!==null;)n=a.alternate,n!==null&&_r(n)===null&&(d=a),a=a.sibling;a=d,a===null?(d=i.child,i.child=null):(d=a.sibling,a.sibling=null),Uo(i,!1,d,a,m);break;case"backwards":for(a=null,d=i.child,i.child=null;d!==null;){if(n=d.alternate,n!==null&&_r(n)===null){i.child=d;break}n=d.sibling,d.sibling=a,a=d,d=n}Uo(i,!0,a,null,m);break;case"together":Uo(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Pr(n,i){(i.mode&1)===0&&n!==null&&(n.alternate=null,i.alternate=null,i.flags|=2)}function hn(n,i,a){if(n!==null&&(i.dependencies=n.dependencies),Xn|=i.lanes,(a&i.childLanes)===0)return null;if(n!==null&&i.child!==n.child)throw Error(e(153));if(i.child!==null){for(n=i.child,a=Ln(n,n.pendingProps),i.child=a,a.return=i;n.sibling!==null;)n=n.sibling,a=a.sibling=Ln(n,n.pendingProps),a.return=i;a.sibling=null}return i.child}function Ep(n,i,a){switch(i.tag){case 3:uh(i),wi();break;case 5:kc(i);break;case 1:ve(i.type)&&hr(i);break;case 4:_o(i,i.stateNode.containerInfo);break;case 10:var c=i.type._context,d=i.memoizedProps.value;Lt(vr,c._currentValue),c._currentValue=d;break;case 13:if(c=i.memoizedState,c!==null)return c.dehydrated!==null?(Lt(zt,zt.current&1),i.flags|=128,null):(a&i.child.childLanes)!==0?hh(n,i,a):(Lt(zt,zt.current&1),n=hn(n,i,a),n!==null?n.sibling:null);Lt(zt,zt.current&1);break;case 19:if(c=(a&i.childLanes)!==0,(n.flags&128)!==0){if(c)return fh(n,i,a);i.flags|=128}if(d=i.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),Lt(zt,zt.current),c)break;return null;case 22:case 23:return i.lanes=0,ah(n,i,a)}return hn(n,i,a)}var ph,$o,gh,mh;ph=function(n,i){for(var a=i.child;a!==null;){if(a.tag===5||a.tag===6)n.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},$o=function(){},gh=function(n,i,a,c){var d=n.memoizedProps;if(d!==c){n=i.stateNode,Gn(Ze.current);var m=null;switch(a){case"input":d=va(n,d),c=va(n,c),m=[];break;case"select":d=W({},d,{value:void 0}),c=W({},c,{value:void 0}),m=[];break;case"textarea":d=Aa(n,d),c=Aa(n,c),m=[];break;default:typeof d.onClick!="function"&&typeof c.onClick=="function"&&(n.onclick=lr)}Sa(a,c);var A;a=null;for(I in d)if(!c.hasOwnProperty(I)&&d.hasOwnProperty(I)&&d[I]!=null)if(I==="style"){var b=d[I];for(A in b)b.hasOwnProperty(A)&&(a||(a={}),a[A]="")}else I!=="dangerouslySetInnerHTML"&&I!=="children"&&I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(r.hasOwnProperty(I)?m||(m=[]):(m=m||[]).push(I,null));for(I in c){var C=c[I];if(b=d?.[I],c.hasOwnProperty(I)&&C!==b&&(C!=null||b!=null))if(I==="style")if(b){for(A in b)!b.hasOwnProperty(A)||C&&C.hasOwnProperty(A)||(a||(a={}),a[A]="");for(A in C)C.hasOwnProperty(A)&&b[A]!==C[A]&&(a||(a={}),a[A]=C[A])}else a||(m||(m=[]),m.push(I,a)),a=C;else I==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,b=b?b.__html:void 0,C!=null&&b!==C&&(m=m||[]).push(I,C)):I==="children"?typeof C!="string"&&typeof C!="number"||(m=m||[]).push(I,""+C):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&(r.hasOwnProperty(I)?(C!=null&&I==="onScroll"&&It("scroll",n),m||b===C||(m=[])):(m=m||[]).push(I,C))}a&&(m=m||[]).push("style",a);var I=m;(i.updateQueue=I)&&(i.flags|=4)}},mh=function(n,i,a,c){a!==c&&(i.flags|=4)};function ms(n,i){if(!Dt)switch(n.tailMode){case"hidden":i=n.tail;for(var a=null;i!==null;)i.alternate!==null&&(a=i),i=i.sibling;a===null?n.tail=null:a.sibling=null;break;case"collapsed":a=n.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function re(n){var i=n.alternate!==null&&n.alternate.child===n.child,a=0,c=0;if(i)for(var d=n.child;d!==null;)a|=d.lanes|d.childLanes,c|=d.subtreeFlags&14680064,c|=d.flags&14680064,d.return=n,d=d.sibling;else for(d=n.child;d!==null;)a|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=n,d=d.sibling;return n.subtreeFlags|=c,n.childLanes=a,i}function xp(n,i,a){var c=i.pendingProps;switch(co(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return re(i),null;case 1:return ve(i.type)&&cr(),re(i),null;case 3:return c=i.stateNode,bi(),Nt(me),Nt(ie),Eo(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(n===null||n.child===null)&&(gr(i)?i.flags|=4:n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Ue!==null&&(tl(Ue),Ue=null))),$o(n,i),re(i),null;case 5:So(i);var d=Gn(hs.current);if(a=i.type,n!==null&&i.stateNode!=null)gh(n,i,a,c,d),n.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!c){if(i.stateNode===null)throw Error(e(166));return re(i),null}if(n=Gn(Ze.current),gr(i)){c=i.stateNode,a=i.type;var m=i.memoizedProps;switch(c[Qe]=i,c[as]=m,n=(i.mode&1)!==0,a){case"dialog":It("cancel",c),It("close",c);break;case"iframe":case"object":case"embed":It("load",c);break;case"video":case"audio":for(d=0;d<is.length;d++)It(is[d],c);break;case"source":It("error",c);break;case"img":case"image":case"link":It("error",c),It("load",c);break;case"details":It("toggle",c);break;case"input":Kl(c,m),It("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!m.multiple},It("invalid",c);break;case"textarea":Jl(c,m),It("invalid",c)}Sa(a,m),d=null;for(var A in m)if(m.hasOwnProperty(A)){var b=m[A];A==="children"?typeof b=="string"?c.textContent!==b&&(m.suppressHydrationWarning!==!0&&or(c.textContent,b,n),d=["children",b]):typeof b=="number"&&c.textContent!==""+b&&(m.suppressHydrationWarning!==!0&&or(c.textContent,b,n),d=["children",""+b]):r.hasOwnProperty(A)&&b!=null&&A==="onScroll"&&It("scroll",c)}switch(a){case"input":zs(c),Zl(c,m,!0);break;case"textarea":zs(c),eu(c);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(c.onclick=lr)}c=d,i.updateQueue=c,c!==null&&(i.flags|=4)}else{A=d.nodeType===9?d:d.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=nu(a)),n==="http://www.w3.org/1999/xhtml"?a==="script"?(n=A.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof c.is=="string"?n=A.createElement(a,{is:c.is}):(n=A.createElement(a),a==="select"&&(A=n,c.multiple?A.multiple=!0:c.size&&(A.size=c.size))):n=A.createElementNS(n,a),n[Qe]=i,n[as]=c,ph(n,i,!1,!1),i.stateNode=n;t:{switch(A=ba(a,c),a){case"dialog":It("cancel",n),It("close",n),d=c;break;case"iframe":case"object":case"embed":It("load",n),d=c;break;case"video":case"audio":for(d=0;d<is.length;d++)It(is[d],n);d=c;break;case"source":It("error",n),d=c;break;case"img":case"image":case"link":It("error",n),It("load",n),d=c;break;case"details":It("toggle",n),d=c;break;case"input":Kl(n,c),d=va(n,c),It("invalid",n);break;case"option":d=c;break;case"select":n._wrapperState={wasMultiple:!!c.multiple},d=W({},c,{value:void 0}),It("invalid",n);break;case"textarea":Jl(n,c),d=Aa(n,c),It("invalid",n);break;default:d=c}Sa(a,d),b=d;for(m in b)if(b.hasOwnProperty(m)){var C=b[m];m==="style"?ru(n,C):m==="dangerouslySetInnerHTML"?(C=C?C.__html:void 0,C!=null&&iu(n,C)):m==="children"?typeof C=="string"?(a!=="textarea"||C!=="")&&zi(n,C):typeof C=="number"&&zi(n,""+C):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(r.hasOwnProperty(m)?C!=null&&m==="onScroll"&&It("scroll",n):C!=null&&P(n,m,C,A))}switch(a){case"input":zs(n),Zl(n,c,!1);break;case"textarea":zs(n),eu(n);break;case"option":c.value!=null&&n.setAttribute("value",""+bt(c.value));break;case"select":n.multiple=!!c.multiple,m=c.value,m!=null?si(n,!!c.multiple,m,!1):c.defaultValue!=null&&si(n,!!c.multiple,c.defaultValue,!0);break;default:typeof d.onClick=="function"&&(n.onclick=lr)}switch(a){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break t;case"img":c=!0;break t;default:c=!1}}c&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return re(i),null;case 6:if(n&&i.stateNode!=null)mh(n,i,n.memoizedProps,c);else{if(typeof c!="string"&&i.stateNode===null)throw Error(e(166));if(a=Gn(hs.current),Gn(Ze.current),gr(i)){if(c=i.stateNode,a=i.memoizedProps,c[Qe]=i,(m=c.nodeValue!==a)&&(n=Ce,n!==null))switch(n.tag){case 3:or(c.nodeValue,a,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&or(c.nodeValue,a,(n.mode&1)!==0)}m&&(i.flags|=4)}else c=(a.nodeType===9?a:a.ownerDocument).createTextNode(c),c[Qe]=i,i.stateNode=c}return re(i),null;case 13:if(Nt(zt),c=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Dt&&ke!==null&&(i.mode&1)!==0&&(i.flags&128)===0)wc(),wi(),i.flags|=98560,m=!1;else if(m=gr(i),c!==null&&c.dehydrated!==null){if(n===null){if(!m)throw Error(e(318));if(m=i.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(e(317));m[Qe]=i}else wi(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;re(i),m=!1}else Ue!==null&&(tl(Ue),Ue=null),m=!0;if(!m)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=a,i):(c=c!==null,c!==(n!==null&&n.memoizedState!==null)&&c&&(i.child.flags|=8192,(i.mode&1)!==0&&(n===null||(zt.current&1)!==0?Yt===0&&(Yt=3):il())),i.updateQueue!==null&&(i.flags|=4),re(i),null);case 4:return bi(),$o(n,i),n===null&&ss(i.stateNode.containerInfo),re(i),null;case 10:return vo(i.type._context),re(i),null;case 17:return ve(i.type)&&cr(),re(i),null;case 19:if(Nt(zt),m=i.memoizedState,m===null)return re(i),null;if(c=(i.flags&128)!==0,A=m.rendering,A===null)if(c)ms(m,!1);else{if(Yt!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(A=_r(n),A!==null){for(i.flags|=128,ms(m,!1),c=A.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),i.subtreeFlags=0,c=a,a=i.child;a!==null;)m=a,n=c,m.flags&=14680066,A=m.alternate,A===null?(m.childLanes=0,m.lanes=n,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=A.childLanes,m.lanes=A.lanes,m.child=A.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=A.memoizedProps,m.memoizedState=A.memoizedState,m.updateQueue=A.updateQueue,m.type=A.type,n=A.dependencies,m.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),a=a.sibling;return Lt(zt,zt.current&1|2),i.child}n=n.sibling}m.tail!==null&&Ht()>ki&&(i.flags|=128,c=!0,ms(m,!1),i.lanes=4194304)}else{if(!c)if(n=_r(A),n!==null){if(i.flags|=128,c=!0,a=n.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),ms(m,!0),m.tail===null&&m.tailMode==="hidden"&&!A.alternate&&!Dt)return re(i),null}else 2*Ht()-m.renderingStartTime>ki&&a!==1073741824&&(i.flags|=128,c=!0,ms(m,!1),i.lanes=4194304);m.isBackwards?(A.sibling=i.child,i.child=A):(a=m.last,a!==null?a.sibling=A:i.child=A,m.last=A)}return m.tail!==null?(i=m.tail,m.rendering=i,m.tail=i.sibling,m.renderingStartTime=Ht(),i.sibling=null,a=zt.current,Lt(zt,c?a&1|2:a&1),i):(re(i),null);case 22:case 23:return nl(),c=i.memoizedState!==null,n!==null&&n.memoizedState!==null!==c&&(i.flags|=8192),c&&(i.mode&1)!==0?(Te&1073741824)!==0&&(re(i),i.subtreeFlags&6&&(i.flags|=8192)):re(i),null;case 24:return null;case 25:return null}throw Error(e(156,i.tag))}function Cp(n,i){switch(co(i),i.tag){case 1:return ve(i.type)&&cr(),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return bi(),Nt(me),Nt(ie),Eo(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 5:return So(i),null;case 13:if(Nt(zt),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(e(340));wi()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return Nt(zt),null;case 4:return bi(),null;case 10:return vo(i.type._context),null;case 22:case 23:return nl(),null;case 24:return null;default:return null}}var Rr=!1,ae=!1,kp=typeof WeakSet=="function"?WeakSet:Set,Y=null;function xi(n,i){var a=n.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(c){Bt(n,i,c)}else a.current=null}function Vo(n,i,a){try{a()}catch(c){Bt(n,i,c)}}var vh=!1;function Tp(n,i){if(eo=Ks,n=Yu(),Xa(n)){if("selectionStart"in n)var a={start:n.selectionStart,end:n.selectionEnd};else t:{a=(a=n.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var d=c.anchorOffset,m=c.focusNode;c=c.focusOffset;try{a.nodeType,m.nodeType}catch{a=null;break t}var A=0,b=-1,C=-1,I=0,z=0,j=n,O=null;e:for(;;){for(var q;j!==a||d!==0&&j.nodeType!==3||(b=A+d),j!==m||c!==0&&j.nodeType!==3||(C=A+c),j.nodeType===3&&(A+=j.nodeValue.length),(q=j.firstChild)!==null;)O=j,j=q;for(;;){if(j===n)break e;if(O===a&&++I===d&&(b=A),O===m&&++z===c&&(C=A),(q=j.nextSibling)!==null)break;j=O,O=j.parentNode}j=q}a=b===-1||C===-1?null:{start:b,end:C}}else a=null}a=a||{start:0,end:0}}else a=null;for(no={focusedElem:n,selectionRange:a},Ks=!1,Y=i;Y!==null;)if(i=Y,n=i.child,(i.subtreeFlags&1028)!==0&&n!==null)n.return=i,Y=n;else for(;Y!==null;){i=Y;try{var Q=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(Q!==null){var J=Q.memoizedProps,Ut=Q.memoizedState,R=i.stateNode,k=R.getSnapshotBeforeUpdate(i.elementType===i.type?J:$e(i.type,J),Ut);R.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var L=i.stateNode.containerInfo;L.nodeType===1?L.textContent="":L.nodeType===9&&L.documentElement&&L.removeChild(L.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(e(163))}}catch($){Bt(i,i.return,$)}if(n=i.sibling,n!==null){n.return=i.return,Y=n;break}Y=i.return}return Q=vh,vh=!1,Q}function vs(n,i,a){var c=i.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&n)===n){var m=d.destroy;d.destroy=void 0,m!==void 0&&Vo(i,a,m)}d=d.next}while(d!==c)}}function Mr(n,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var a=i=i.next;do{if((a.tag&n)===n){var c=a.create;a.destroy=c()}a=a.next}while(a!==i)}}function Go(n){var i=n.ref;if(i!==null){var a=n.stateNode;switch(n.tag){case 5:n=a;break;default:n=a}typeof i=="function"?i(n):i.current=n}}function yh(n){var i=n.alternate;i!==null&&(n.alternate=null,yh(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&(delete i[Qe],delete i[as],delete i[ao],delete i[cp],delete i[hp])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function wh(n){return n.tag===5||n.tag===3||n.tag===4}function Ah(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||wh(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Wo(n,i,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?a.nodeType===8?a.parentNode.insertBefore(n,i):a.insertBefore(n,i):(a.nodeType===8?(i=a.parentNode,i.insertBefore(n,a)):(i=a,i.appendChild(n)),a=a._reactRootContainer,a!=null||i.onclick!==null||(i.onclick=lr));else if(c!==4&&(n=n.child,n!==null))for(Wo(n,i,a),n=n.sibling;n!==null;)Wo(n,i,a),n=n.sibling}function Xo(n,i,a){var c=n.tag;if(c===5||c===6)n=n.stateNode,i?a.insertBefore(n,i):a.appendChild(n);else if(c!==4&&(n=n.child,n!==null))for(Xo(n,i,a),n=n.sibling;n!==null;)Xo(n,i,a),n=n.sibling}var ee=null,Ve=!1;function kn(n,i,a){for(a=a.child;a!==null;)_h(n,i,a),a=a.sibling}function _h(n,i,a){if(Ke&&typeof Ke.onCommitFiberUnmount=="function")try{Ke.onCommitFiberUnmount(Vs,a)}catch{}switch(a.tag){case 5:ae||xi(a,i);case 6:var c=ee,d=Ve;ee=null,kn(n,i,a),ee=c,Ve=d,ee!==null&&(Ve?(n=ee,a=a.stateNode,n.nodeType===8?n.parentNode.removeChild(a):n.removeChild(a)):ee.removeChild(a.stateNode));break;case 18:ee!==null&&(Ve?(n=ee,a=a.stateNode,n.nodeType===8?ro(n.parentNode,a):n.nodeType===1&&ro(n,a),Yi(n)):ro(ee,a.stateNode));break;case 4:c=ee,d=Ve,ee=a.stateNode.containerInfo,Ve=!0,kn(n,i,a),ee=c,Ve=d;break;case 0:case 11:case 14:case 15:if(!ae&&(c=a.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){d=c=c.next;do{var m=d,A=m.destroy;m=m.tag,A!==void 0&&((m&2)!==0||(m&4)!==0)&&Vo(a,i,A),d=d.next}while(d!==c)}kn(n,i,a);break;case 1:if(!ae&&(xi(a,i),c=a.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=a.memoizedProps,c.state=a.memoizedState,c.componentWillUnmount()}catch(b){Bt(a,i,b)}kn(n,i,a);break;case 21:kn(n,i,a);break;case 22:a.mode&1?(ae=(c=ae)||a.memoizedState!==null,kn(n,i,a),ae=c):kn(n,i,a);break;default:kn(n,i,a)}}function Sh(n){var i=n.updateQueue;if(i!==null){n.updateQueue=null;var a=n.stateNode;a===null&&(a=n.stateNode=new kp),i.forEach(function(c){var d=Op.bind(null,n,c);a.has(c)||(a.add(c),c.then(d,d))})}}function Ge(n,i){var a=i.deletions;if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];try{var m=n,A=i,b=A;t:for(;b!==null;){switch(b.tag){case 5:ee=b.stateNode,Ve=!1;break t;case 3:ee=b.stateNode.containerInfo,Ve=!0;break t;case 4:ee=b.stateNode.containerInfo,Ve=!0;break t}b=b.return}if(ee===null)throw Error(e(160));_h(m,A,d),ee=null,Ve=!1;var C=d.alternate;C!==null&&(C.return=null),d.return=null}catch(I){Bt(d,i,I)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)bh(i,n),i=i.sibling}function bh(n,i){var a=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Ge(i,n),tn(n),c&4){try{vs(3,n,n.return),Mr(3,n)}catch(J){Bt(n,n.return,J)}try{vs(5,n,n.return)}catch(J){Bt(n,n.return,J)}}break;case 1:Ge(i,n),tn(n),c&512&&a!==null&&xi(a,a.return);break;case 5:if(Ge(i,n),tn(n),c&512&&a!==null&&xi(a,a.return),n.flags&32){var d=n.stateNode;try{zi(d,"")}catch(J){Bt(n,n.return,J)}}if(c&4&&(d=n.stateNode,d!=null)){var m=n.memoizedProps,A=a!==null?a.memoizedProps:m,b=n.type,C=n.updateQueue;if(n.updateQueue=null,C!==null)try{b==="input"&&m.type==="radio"&&m.name!=null&&Ql(d,m),ba(b,A);var I=ba(b,m);for(A=0;A<C.length;A+=2){var z=C[A],j=C[A+1];z==="style"?ru(d,j):z==="dangerouslySetInnerHTML"?iu(d,j):z==="children"?zi(d,j):P(d,z,j,I)}switch(b){case"input":ya(d,m);break;case"textarea":tu(d,m);break;case"select":var O=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!m.multiple;var q=m.value;q!=null?si(d,!!m.multiple,q,!1):O!==!!m.multiple&&(m.defaultValue!=null?si(d,!!m.multiple,m.defaultValue,!0):si(d,!!m.multiple,m.multiple?[]:"",!1))}d[as]=m}catch(J){Bt(n,n.return,J)}}break;case 6:if(Ge(i,n),tn(n),c&4){if(n.stateNode===null)throw Error(e(162));d=n.stateNode,m=n.memoizedProps;try{d.nodeValue=m}catch(J){Bt(n,n.return,J)}}break;case 3:if(Ge(i,n),tn(n),c&4&&a!==null&&a.memoizedState.isDehydrated)try{Yi(i.containerInfo)}catch(J){Bt(n,n.return,J)}break;case 4:Ge(i,n),tn(n);break;case 13:Ge(i,n),tn(n),d=n.child,d.flags&8192&&(m=d.memoizedState!==null,d.stateNode.isHidden=m,!m||d.alternate!==null&&d.alternate.memoizedState!==null||(Ko=Ht())),c&4&&Sh(n);break;case 22:if(z=a!==null&&a.memoizedState!==null,n.mode&1?(ae=(I=ae)||z,Ge(i,n),ae=I):Ge(i,n),tn(n),c&8192){if(I=n.memoizedState!==null,(n.stateNode.isHidden=I)&&!z&&(n.mode&1)!==0)for(Y=n,z=n.child;z!==null;){for(j=Y=z;Y!==null;){switch(O=Y,q=O.child,O.tag){case 0:case 11:case 14:case 15:vs(4,O,O.return);break;case 1:xi(O,O.return);var Q=O.stateNode;if(typeof Q.componentWillUnmount=="function"){c=O,a=O.return;try{i=c,Q.props=i.memoizedProps,Q.state=i.memoizedState,Q.componentWillUnmount()}catch(J){Bt(c,a,J)}}break;case 5:xi(O,O.return);break;case 22:if(O.memoizedState!==null){Ch(j);continue}}q!==null?(q.return=O,Y=q):Ch(j)}z=z.sibling}t:for(z=null,j=n;;){if(j.tag===5){if(z===null){z=j;try{d=j.stateNode,I?(m=d.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none"):(b=j.stateNode,C=j.memoizedProps.style,A=C!=null&&C.hasOwnProperty("display")?C.display:null,b.style.display=su("display",A))}catch(J){Bt(n,n.return,J)}}}else if(j.tag===6){if(z===null)try{j.stateNode.nodeValue=I?"":j.memoizedProps}catch(J){Bt(n,n.return,J)}}else if((j.tag!==22&&j.tag!==23||j.memoizedState===null||j===n)&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===n)break t;for(;j.sibling===null;){if(j.return===null||j.return===n)break t;z===j&&(z=null),j=j.return}z===j&&(z=null),j.sibling.return=j.return,j=j.sibling}}break;case 19:Ge(i,n),tn(n),c&4&&Sh(n);break;case 21:break;default:Ge(i,n),tn(n)}}function tn(n){var i=n.flags;if(i&2){try{t:{for(var a=n.return;a!==null;){if(wh(a)){var c=a;break t}a=a.return}throw Error(e(160))}switch(c.tag){case 5:var d=c.stateNode;c.flags&32&&(zi(d,""),c.flags&=-33);var m=Ah(n);Xo(n,m,d);break;case 3:case 4:var A=c.stateNode.containerInfo,b=Ah(n);Wo(n,b,A);break;default:throw Error(e(161))}}catch(C){Bt(n,n.return,C)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function Pp(n,i,a){Y=n,Eh(n)}function Eh(n,i,a){for(var c=(n.mode&1)!==0;Y!==null;){var d=Y,m=d.child;if(d.tag===22&&c){var A=d.memoizedState!==null||Rr;if(!A){var b=d.alternate,C=b!==null&&b.memoizedState!==null||ae;b=Rr;var I=ae;if(Rr=A,(ae=C)&&!I)for(Y=d;Y!==null;)A=Y,C=A.child,A.tag===22&&A.memoizedState!==null?kh(d):C!==null?(C.return=A,Y=C):kh(d);for(;m!==null;)Y=m,Eh(m),m=m.sibling;Y=d,Rr=b,ae=I}xh(n)}else(d.subtreeFlags&8772)!==0&&m!==null?(m.return=d,Y=m):xh(n)}}function xh(n){for(;Y!==null;){var i=Y;if((i.flags&8772)!==0){var a=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:ae||Mr(5,i);break;case 1:var c=i.stateNode;if(i.flags&4&&!ae)if(a===null)c.componentDidMount();else{var d=i.elementType===i.type?a.memoizedProps:$e(i.type,a.memoizedProps);c.componentDidUpdate(d,a.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var m=i.updateQueue;m!==null&&Cc(i,m,c);break;case 3:var A=i.updateQueue;if(A!==null){if(a=null,i.child!==null)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}Cc(i,A,a)}break;case 5:var b=i.stateNode;if(a===null&&i.flags&4){a=b;var C=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":C.autoFocus&&a.focus();break;case"img":C.src&&(a.src=C.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var I=i.alternate;if(I!==null){var z=I.memoizedState;if(z!==null){var j=z.dehydrated;j!==null&&Yi(j)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(e(163))}ae||i.flags&512&&Go(i)}catch(O){Bt(i,i.return,O)}}if(i===n){Y=null;break}if(a=i.sibling,a!==null){a.return=i.return,Y=a;break}Y=i.return}}function Ch(n){for(;Y!==null;){var i=Y;if(i===n){Y=null;break}var a=i.sibling;if(a!==null){a.return=i.return,Y=a;break}Y=i.return}}function kh(n){for(;Y!==null;){var i=Y;try{switch(i.tag){case 0:case 11:case 15:var a=i.return;try{Mr(4,i)}catch(C){Bt(i,a,C)}break;case 1:var c=i.stateNode;if(typeof c.componentDidMount=="function"){var d=i.return;try{c.componentDidMount()}catch(C){Bt(i,d,C)}}var m=i.return;try{Go(i)}catch(C){Bt(i,m,C)}break;case 5:var A=i.return;try{Go(i)}catch(C){Bt(i,A,C)}}}catch(C){Bt(i,i.return,C)}if(i===n){Y=null;break}var b=i.sibling;if(b!==null){b.return=i.return,Y=b;break}Y=i.return}}var Rp=Math.ceil,Lr=N.ReactCurrentDispatcher,qo=N.ReactCurrentOwner,De=N.ReactCurrentBatchConfig,Ct=0,Jt=null,Gt=null,ne=0,Te=0,Ci=Sn(0),Yt=0,ys=null,Xn=0,Ir=0,Yo=0,ws=null,we=null,Ko=0,ki=1/0,dn=null,Nr=!1,Qo=null,Tn=null,Dr=!1,Pn=null,Fr=0,As=0,Zo=null,Or=-1,zr=0;function de(){return(Ct&6)!==0?Ht():Or!==-1?Or:Or=Ht()}function Rn(n){return(n.mode&1)===0?1:(Ct&2)!==0&&ne!==0?ne&-ne:fp.transition!==null?(zr===0&&(zr=Au()),zr):(n=Tt,n!==0||(n=window.event,n=n===void 0?16:Pu(n.type)),n)}function We(n,i,a,c){if(50<As)throw As=0,Zo=null,Error(e(185));Vi(n,a,c),((Ct&2)===0||n!==Jt)&&(n===Jt&&((Ct&2)===0&&(Ir|=a),Yt===4&&Mn(n,ne)),Ae(n,c),a===1&&Ct===0&&(i.mode&1)===0&&(ki=Ht()+500,dr&&En()))}function Ae(n,i){var a=n.callbackNode;ff(n,i);var c=Xs(n,n===Jt?ne:0);if(c===0)a!==null&&vu(a),n.callbackNode=null,n.callbackPriority=0;else if(i=c&-c,n.callbackPriority!==i){if(a!=null&&vu(a),i===1)n.tag===0?dp(Ph.bind(null,n)):pc(Ph.bind(null,n)),lp(function(){(Ct&6)===0&&En()}),a=null;else{switch(_u(c)){case 1:a=Ra;break;case 4:a=yu;break;case 16:a=$s;break;case 536870912:a=wu;break;default:a=$s}a=Oh(a,Th.bind(null,n))}n.callbackPriority=i,n.callbackNode=a}}function Th(n,i){if(Or=-1,zr=0,(Ct&6)!==0)throw Error(e(327));var a=n.callbackNode;if(Ti()&&n.callbackNode!==a)return null;var c=Xs(n,n===Jt?ne:0);if(c===0)return null;if((c&30)!==0||(c&n.expiredLanes)!==0||i)i=jr(n,c);else{i=c;var d=Ct;Ct|=2;var m=Mh();(Jt!==n||ne!==i)&&(dn=null,ki=Ht()+500,Yn(n,i));do try{Ip();break}catch(b){Rh(n,b)}while(!0);mo(),Lr.current=m,Ct=d,Gt!==null?i=0:(Jt=null,ne=0,i=Yt)}if(i!==0){if(i===2&&(d=Ma(n),d!==0&&(c=d,i=Jo(n,d))),i===1)throw a=ys,Yn(n,0),Mn(n,c),Ae(n,Ht()),a;if(i===6)Mn(n,c);else{if(d=n.current.alternate,(c&30)===0&&!Mp(d)&&(i=jr(n,c),i===2&&(m=Ma(n),m!==0&&(c=m,i=Jo(n,m))),i===1))throw a=ys,Yn(n,0),Mn(n,c),Ae(n,Ht()),a;switch(n.finishedWork=d,n.finishedLanes=c,i){case 0:case 1:throw Error(e(345));case 2:Kn(n,we,dn);break;case 3:if(Mn(n,c),(c&130023424)===c&&(i=Ko+500-Ht(),10<i)){if(Xs(n,0)!==0)break;if(d=n.suspendedLanes,(d&c)!==c){de(),n.pingedLanes|=n.suspendedLanes&d;break}n.timeoutHandle=so(Kn.bind(null,n,we,dn),i);break}Kn(n,we,dn);break;case 4:if(Mn(n,c),(c&4194240)===c)break;for(i=n.eventTimes,d=-1;0<c;){var A=31-Be(c);m=1<<A,A=i[A],A>d&&(d=A),c&=~m}if(c=d,c=Ht()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*Rp(c/1960))-c,10<c){n.timeoutHandle=so(Kn.bind(null,n,we,dn),c);break}Kn(n,we,dn);break;case 5:Kn(n,we,dn);break;default:throw Error(e(329))}}}return Ae(n,Ht()),n.callbackNode===a?Th.bind(null,n):null}function Jo(n,i){var a=ws;return n.current.memoizedState.isDehydrated&&(Yn(n,i).flags|=256),n=jr(n,i),n!==2&&(i=we,we=a,i!==null&&tl(i)),n}function tl(n){we===null?we=n:we.push.apply(we,n)}function Mp(n){for(var i=n;;){if(i.flags&16384){var a=i.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var c=0;c<a.length;c++){var d=a[c],m=d.getSnapshot;d=d.value;try{if(!He(m(),d))return!1}catch{return!1}}}if(a=i.child,i.subtreeFlags&16384&&a!==null)a.return=i,i=a;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Mn(n,i){for(i&=~Yo,i&=~Ir,n.suspendedLanes|=i,n.pingedLanes&=~i,n=n.expirationTimes;0<i;){var a=31-Be(i),c=1<<a;n[a]=-1,i&=~c}}function Ph(n){if((Ct&6)!==0)throw Error(e(327));Ti();var i=Xs(n,0);if((i&1)===0)return Ae(n,Ht()),null;var a=jr(n,i);if(n.tag!==0&&a===2){var c=Ma(n);c!==0&&(i=c,a=Jo(n,c))}if(a===1)throw a=ys,Yn(n,0),Mn(n,i),Ae(n,Ht()),a;if(a===6)throw Error(e(345));return n.finishedWork=n.current.alternate,n.finishedLanes=i,Kn(n,we,dn),Ae(n,Ht()),null}function el(n,i){var a=Ct;Ct|=1;try{return n(i)}finally{Ct=a,Ct===0&&(ki=Ht()+500,dr&&En())}}function qn(n){Pn!==null&&Pn.tag===0&&(Ct&6)===0&&Ti();var i=Ct;Ct|=1;var a=De.transition,c=Tt;try{if(De.transition=null,Tt=1,n)return n()}finally{Tt=c,De.transition=a,Ct=i,(Ct&6)===0&&En()}}function nl(){Te=Ci.current,Nt(Ci)}function Yn(n,i){n.finishedWork=null,n.finishedLanes=0;var a=n.timeoutHandle;if(a!==-1&&(n.timeoutHandle=-1,op(a)),Gt!==null)for(a=Gt.return;a!==null;){var c=a;switch(co(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&cr();break;case 3:bi(),Nt(me),Nt(ie),Eo();break;case 5:So(c);break;case 4:bi();break;case 13:Nt(zt);break;case 19:Nt(zt);break;case 10:vo(c.type._context);break;case 22:case 23:nl()}a=a.return}if(Jt=n,Gt=n=Ln(n.current,null),ne=Te=i,Yt=0,ys=null,Yo=Ir=Xn=0,we=ws=null,Vn!==null){for(i=0;i<Vn.length;i++)if(a=Vn[i],c=a.interleaved,c!==null){a.interleaved=null;var d=c.next,m=a.pending;if(m!==null){var A=m.next;m.next=d,c.next=A}a.pending=c}Vn=null}return n}function Rh(n,i){do{var a=Gt;try{if(mo(),Sr.current=Cr,br){for(var c=jt.memoizedState;c!==null;){var d=c.queue;d!==null&&(d.pending=null),c=c.next}br=!1}if(Wn=0,Zt=qt=jt=null,ds=!1,fs=0,qo.current=null,a===null||a.return===null){Yt=1,ys=i,Gt=null;break}t:{var m=n,A=a.return,b=a,C=i;if(i=ne,b.flags|=32768,C!==null&&typeof C=="object"&&typeof C.then=="function"){var I=C,z=b,j=z.tag;if((z.mode&1)===0&&(j===0||j===11||j===15)){var O=z.alternate;O?(z.updateQueue=O.updateQueue,z.memoizedState=O.memoizedState,z.lanes=O.lanes):(z.updateQueue=null,z.memoizedState=null)}var q=eh(A);if(q!==null){q.flags&=-257,nh(q,A,b,m,i),q.mode&1&&th(m,I,i),i=q,C=I;var Q=i.updateQueue;if(Q===null){var J=new Set;J.add(C),i.updateQueue=J}else Q.add(C);break t}else{if((i&1)===0){th(m,I,i),il();break t}C=Error(e(426))}}else if(Dt&&b.mode&1){var Ut=eh(A);if(Ut!==null){(Ut.flags&65536)===0&&(Ut.flags|=256),nh(Ut,A,b,m,i),po(Ei(C,b));break t}}m=C=Ei(C,b),Yt!==4&&(Yt=2),ws===null?ws=[m]:ws.push(m),m=A;do{switch(m.tag){case 3:m.flags|=65536,i&=-i,m.lanes|=i;var R=Zc(m,C,i);xc(m,R);break t;case 1:b=C;var k=m.type,L=m.stateNode;if((m.flags&128)===0&&(typeof k.getDerivedStateFromError=="function"||L!==null&&typeof L.componentDidCatch=="function"&&(Tn===null||!Tn.has(L)))){m.flags|=65536,i&=-i,m.lanes|=i;var $=Jc(m,b,i);xc(m,$);break t}}m=m.return}while(m!==null)}Ih(a)}catch(et){i=et,Gt===a&&a!==null&&(Gt=a=a.return);continue}break}while(!0)}function Mh(){var n=Lr.current;return Lr.current=Cr,n===null?Cr:n}function il(){(Yt===0||Yt===3||Yt===2)&&(Yt=4),Jt===null||(Xn&268435455)===0&&(Ir&268435455)===0||Mn(Jt,ne)}function jr(n,i){var a=Ct;Ct|=2;var c=Mh();(Jt!==n||ne!==i)&&(dn=null,Yn(n,i));do try{Lp();break}catch(d){Rh(n,d)}while(!0);if(mo(),Ct=a,Lr.current=c,Gt!==null)throw Error(e(261));return Jt=null,ne=0,Yt}function Lp(){for(;Gt!==null;)Lh(Gt)}function Ip(){for(;Gt!==null&&!sf();)Lh(Gt)}function Lh(n){var i=Fh(n.alternate,n,Te);n.memoizedProps=n.pendingProps,i===null?Ih(n):Gt=i,qo.current=null}function Ih(n){var i=n;do{var a=i.alternate;if(n=i.return,(i.flags&32768)===0){if(a=xp(a,i,Te),a!==null){Gt=a;return}}else{if(a=Cp(a,i),a!==null){a.flags&=32767,Gt=a;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Yt=6,Gt=null;return}}if(i=i.sibling,i!==null){Gt=i;return}Gt=i=n}while(i!==null);Yt===0&&(Yt=5)}function Kn(n,i,a){var c=Tt,d=De.transition;try{De.transition=null,Tt=1,Np(n,i,a,c)}finally{De.transition=d,Tt=c}return null}function Np(n,i,a,c){do Ti();while(Pn!==null);if((Ct&6)!==0)throw Error(e(327));a=n.finishedWork;var d=n.finishedLanes;if(a===null)return null;if(n.finishedWork=null,n.finishedLanes=0,a===n.current)throw Error(e(177));n.callbackNode=null,n.callbackPriority=0;var m=a.lanes|a.childLanes;if(pf(n,m),n===Jt&&(Gt=Jt=null,ne=0),(a.subtreeFlags&2064)===0&&(a.flags&2064)===0||Dr||(Dr=!0,Oh($s,function(){return Ti(),null})),m=(a.flags&15990)!==0,(a.subtreeFlags&15990)!==0||m){m=De.transition,De.transition=null;var A=Tt;Tt=1;var b=Ct;Ct|=4,qo.current=null,Tp(n,a),bh(a,n),tp(no),Ks=!!eo,no=eo=null,n.current=a,Pp(a),rf(),Ct=b,Tt=A,De.transition=m}else n.current=a;if(Dr&&(Dr=!1,Pn=n,Fr=d),m=n.pendingLanes,m===0&&(Tn=null),lf(a.stateNode),Ae(n,Ht()),i!==null)for(c=n.onRecoverableError,a=0;a<i.length;a++)d=i[a],c(d.value,{componentStack:d.stack,digest:d.digest});if(Nr)throw Nr=!1,n=Qo,Qo=null,n;return(Fr&1)!==0&&n.tag!==0&&Ti(),m=n.pendingLanes,(m&1)!==0?n===Zo?As++:(As=0,Zo=n):As=0,En(),null}function Ti(){if(Pn!==null){var n=_u(Fr),i=De.transition,a=Tt;try{if(De.transition=null,Tt=16>n?16:n,Pn===null)var c=!1;else{if(n=Pn,Pn=null,Fr=0,(Ct&6)!==0)throw Error(e(331));var d=Ct;for(Ct|=4,Y=n.current;Y!==null;){var m=Y,A=m.child;if((Y.flags&16)!==0){var b=m.deletions;if(b!==null){for(var C=0;C<b.length;C++){var I=b[C];for(Y=I;Y!==null;){var z=Y;switch(z.tag){case 0:case 11:case 15:vs(8,z,m)}var j=z.child;if(j!==null)j.return=z,Y=j;else for(;Y!==null;){z=Y;var O=z.sibling,q=z.return;if(yh(z),z===I){Y=null;break}if(O!==null){O.return=q,Y=O;break}Y=q}}}var Q=m.alternate;if(Q!==null){var J=Q.child;if(J!==null){Q.child=null;do{var Ut=J.sibling;J.sibling=null,J=Ut}while(J!==null)}}Y=m}}if((m.subtreeFlags&2064)!==0&&A!==null)A.return=m,Y=A;else t:for(;Y!==null;){if(m=Y,(m.flags&2048)!==0)switch(m.tag){case 0:case 11:case 15:vs(9,m,m.return)}var R=m.sibling;if(R!==null){R.return=m.return,Y=R;break t}Y=m.return}}var k=n.current;for(Y=k;Y!==null;){A=Y;var L=A.child;if((A.subtreeFlags&2064)!==0&&L!==null)L.return=A,Y=L;else t:for(A=k;Y!==null;){if(b=Y,(b.flags&2048)!==0)try{switch(b.tag){case 0:case 11:case 15:Mr(9,b)}}catch(et){Bt(b,b.return,et)}if(b===A){Y=null;break t}var $=b.sibling;if($!==null){$.return=b.return,Y=$;break t}Y=b.return}}if(Ct=d,En(),Ke&&typeof Ke.onPostCommitFiberRoot=="function")try{Ke.onPostCommitFiberRoot(Vs,n)}catch{}c=!0}return c}finally{Tt=a,De.transition=i}}return!1}function Nh(n,i,a){i=Ei(a,i),i=Zc(n,i,1),n=Cn(n,i,1),i=de(),n!==null&&(Vi(n,1,i),Ae(n,i))}function Bt(n,i,a){if(n.tag===3)Nh(n,n,a);else for(;i!==null;){if(i.tag===3){Nh(i,n,a);break}else if(i.tag===1){var c=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Tn===null||!Tn.has(c))){n=Ei(a,n),n=Jc(i,n,1),i=Cn(i,n,1),n=de(),i!==null&&(Vi(i,1,n),Ae(i,n));break}}i=i.return}}function Dp(n,i,a){var c=n.pingCache;c!==null&&c.delete(i),i=de(),n.pingedLanes|=n.suspendedLanes&a,Jt===n&&(ne&a)===a&&(Yt===4||Yt===3&&(ne&130023424)===ne&&500>Ht()-Ko?Yn(n,0):Yo|=a),Ae(n,i)}function Dh(n,i){i===0&&((n.mode&1)===0?i=1:(i=Ws,Ws<<=1,(Ws&130023424)===0&&(Ws=4194304)));var a=de();n=un(n,i),n!==null&&(Vi(n,i,a),Ae(n,a))}function Fp(n){var i=n.memoizedState,a=0;i!==null&&(a=i.retryLane),Dh(n,a)}function Op(n,i){var a=0;switch(n.tag){case 13:var c=n.stateNode,d=n.memoizedState;d!==null&&(a=d.retryLane);break;case 19:c=n.stateNode;break;default:throw Error(e(314))}c!==null&&c.delete(i),Dh(n,a)}var Fh;Fh=function(n,i,a){if(n!==null)if(n.memoizedProps!==i.pendingProps||me.current)ye=!0;else{if((n.lanes&a)===0&&(i.flags&128)===0)return ye=!1,Ep(n,i,a);ye=(n.flags&131072)!==0}else ye=!1,Dt&&(i.flags&1048576)!==0&&gc(i,pr,i.index);switch(i.lanes=0,i.tag){case 2:var c=i.type;Pr(n,i),n=i.pendingProps;var d=mi(i,ie.current);Si(i,a),d=ko(null,i,c,n,d,a);var m=To();return i.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,ve(c)?(m=!0,hr(i)):m=!1,i.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,Ao(i),d.updater=kr,i.stateNode=d,d._reactInternals=i,No(i,c,n,a),i=zo(null,i,c,!0,m,a)):(i.tag=0,Dt&&m&&uo(i),he(null,i,d,a),i=i.child),i;case 16:c=i.elementType;t:{switch(Pr(n,i),n=i.pendingProps,d=c._init,c=d(c._payload),i.type=c,d=i.tag=jp(c),n=$e(c,n),d){case 0:i=Oo(null,i,c,n,a);break t;case 1:i=lh(null,i,c,n,a);break t;case 11:i=ih(null,i,c,n,a);break t;case 14:i=sh(null,i,c,$e(c.type,n),a);break t}throw Error(e(306,c,""))}return i;case 0:return c=i.type,d=i.pendingProps,d=i.elementType===c?d:$e(c,d),Oo(n,i,c,d,a);case 1:return c=i.type,d=i.pendingProps,d=i.elementType===c?d:$e(c,d),lh(n,i,c,d,a);case 3:t:{if(uh(i),n===null)throw Error(e(387));c=i.pendingProps,m=i.memoizedState,d=m.element,Ec(n,i),Ar(i,c,null,a);var A=i.memoizedState;if(c=A.element,m.isDehydrated)if(m={element:c,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},i.updateQueue.baseState=m,i.memoizedState=m,i.flags&256){d=Ei(Error(e(423)),i),i=ch(n,i,c,a,d);break t}else if(c!==d){d=Ei(Error(e(424)),i),i=ch(n,i,c,a,d);break t}else for(ke=_n(i.stateNode.containerInfo.firstChild),Ce=i,Dt=!0,Ue=null,a=Sc(i,null,c,a),i.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(wi(),c===d){i=hn(n,i,a);break t}he(n,i,c,a)}i=i.child}return i;case 5:return kc(i),n===null&&fo(i),c=i.type,d=i.pendingProps,m=n!==null?n.memoizedProps:null,A=d.children,io(c,d)?A=null:m!==null&&io(c,m)&&(i.flags|=32),oh(n,i),he(n,i,A,a),i.child;case 6:return n===null&&fo(i),null;case 13:return hh(n,i,a);case 4:return _o(i,i.stateNode.containerInfo),c=i.pendingProps,n===null?i.child=Ai(i,null,c,a):he(n,i,c,a),i.child;case 11:return c=i.type,d=i.pendingProps,d=i.elementType===c?d:$e(c,d),ih(n,i,c,d,a);case 7:return he(n,i,i.pendingProps,a),i.child;case 8:return he(n,i,i.pendingProps.children,a),i.child;case 12:return he(n,i,i.pendingProps.children,a),i.child;case 10:t:{if(c=i.type._context,d=i.pendingProps,m=i.memoizedProps,A=d.value,Lt(vr,c._currentValue),c._currentValue=A,m!==null)if(He(m.value,A)){if(m.children===d.children&&!me.current){i=hn(n,i,a);break t}}else for(m=i.child,m!==null&&(m.return=i);m!==null;){var b=m.dependencies;if(b!==null){A=m.child;for(var C=b.firstContext;C!==null;){if(C.context===c){if(m.tag===1){C=cn(-1,a&-a),C.tag=2;var I=m.updateQueue;if(I!==null){I=I.shared;var z=I.pending;z===null?C.next=C:(C.next=z.next,z.next=C),I.pending=C}}m.lanes|=a,C=m.alternate,C!==null&&(C.lanes|=a),yo(m.return,a,i),b.lanes|=a;break}C=C.next}}else if(m.tag===10)A=m.type===i.type?null:m.child;else if(m.tag===18){if(A=m.return,A===null)throw Error(e(341));A.lanes|=a,b=A.alternate,b!==null&&(b.lanes|=a),yo(A,a,i),A=m.sibling}else A=m.child;if(A!==null)A.return=m;else for(A=m;A!==null;){if(A===i){A=null;break}if(m=A.sibling,m!==null){m.return=A.return,A=m;break}A=A.return}m=A}he(n,i,d.children,a),i=i.child}return i;case 9:return d=i.type,c=i.pendingProps.children,Si(i,a),d=Ie(d),c=c(d),i.flags|=1,he(n,i,c,a),i.child;case 14:return c=i.type,d=$e(c,i.pendingProps),d=$e(c.type,d),sh(n,i,c,d,a);case 15:return rh(n,i,i.type,i.pendingProps,a);case 17:return c=i.type,d=i.pendingProps,d=i.elementType===c?d:$e(c,d),Pr(n,i),i.tag=1,ve(c)?(n=!0,hr(i)):n=!1,Si(i,a),Kc(i,c,d),No(i,c,d,a),zo(null,i,c,!0,n,a);case 19:return fh(n,i,a);case 22:return ah(n,i,a)}throw Error(e(156,i.tag))};function Oh(n,i){return mu(n,i)}function zp(n,i,a,c){this.tag=n,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fe(n,i,a,c){return new zp(n,i,a,c)}function sl(n){return n=n.prototype,!(!n||!n.isReactComponent)}function jp(n){if(typeof n=="function")return sl(n)?1:0;if(n!=null){if(n=n.$$typeof,n===St)return 11;if(n===Mt)return 14}return 2}function Ln(n,i){var a=n.alternate;return a===null?(a=Fe(n.tag,i,n.key,n.mode),a.elementType=n.elementType,a.type=n.type,a.stateNode=n.stateNode,a.alternate=n,n.alternate=a):(a.pendingProps=i,a.type=n.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=n.flags&14680064,a.childLanes=n.childLanes,a.lanes=n.lanes,a.child=n.child,a.memoizedProps=n.memoizedProps,a.memoizedState=n.memoizedState,a.updateQueue=n.updateQueue,i=n.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},a.sibling=n.sibling,a.index=n.index,a.ref=n.ref,a}function Br(n,i,a,c,d,m){var A=2;if(c=n,typeof n=="function")sl(n)&&(A=1);else if(typeof n=="string")A=5;else t:switch(n){case H:return Qn(a.children,d,m,i);case Z:A=8,d|=8;break;case it:return n=Fe(12,a,i,d|2),n.elementType=it,n.lanes=m,n;case xt:return n=Fe(13,a,i,d),n.elementType=xt,n.lanes=m,n;case yt:return n=Fe(19,a,i,d),n.elementType=yt,n.lanes=m,n;case X:return Hr(a,d,m,i);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case gt:A=10;break t;case ft:A=9;break t;case St:A=11;break t;case Mt:A=14;break t;case G:A=16,c=null;break t}throw Error(e(130,n==null?n:typeof n,""))}return i=Fe(A,a,i,d),i.elementType=n,i.type=c,i.lanes=m,i}function Qn(n,i,a,c){return n=Fe(7,n,c,i),n.lanes=a,n}function Hr(n,i,a,c){return n=Fe(22,n,c,i),n.elementType=X,n.lanes=a,n.stateNode={isHidden:!1},n}function rl(n,i,a){return n=Fe(6,n,null,i),n.lanes=a,n}function al(n,i,a){return i=Fe(4,n.children!==null?n.children:[],n.key,i),i.lanes=a,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}function Bp(n,i,a,c,d){this.tag=i,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=La(0),this.expirationTimes=La(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=La(0),this.identifierPrefix=c,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function ol(n,i,a,c,d,m,A,b,C){return n=new Bp(n,i,a,b,C),i===1?(i=1,m===!0&&(i|=8)):i=0,m=Fe(3,null,null,i),n.current=m,m.stateNode=n,m.memoizedState={element:c,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ao(m),n}function Hp(n,i,a){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:c==null?null:""+c,children:n,containerInfo:i,implementation:a}}function zh(n){if(!n)return bn;n=n._reactInternals;t:{if(jn(n)!==n||n.tag!==1)throw Error(e(170));var i=n;do{switch(i.tag){case 3:i=i.stateNode.context;break t;case 1:if(ve(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break t}}i=i.return}while(i!==null);throw Error(e(171))}if(n.tag===1){var a=n.type;if(ve(a))return dc(n,a,i)}return i}function jh(n,i,a,c,d,m,A,b,C){return n=ol(a,c,!0,n,d,m,A,b,C),n.context=zh(null),a=n.current,c=de(),d=Rn(a),m=cn(c,d),m.callback=i??null,Cn(a,m,d),n.current.lanes=d,Vi(n,d,c),Ae(n,c),n}function Ur(n,i,a,c){var d=i.current,m=de(),A=Rn(d);return a=zh(a),i.context===null?i.context=a:i.pendingContext=a,i=cn(m,A),i.payload={element:n},c=c===void 0?null:c,c!==null&&(i.callback=c),n=Cn(d,i,A),n!==null&&(We(n,d,A,m),wr(n,d,A)),A}function $r(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Bh(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var a=n.retryLane;n.retryLane=a!==0&&a<i?a:i}}function ll(n,i){Bh(n,i),(n=n.alternate)&&Bh(n,i)}function Up(){return null}var Hh=typeof reportError=="function"?reportError:function(n){console.error(n)};function ul(n){this._internalRoot=n}Vr.prototype.render=ul.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(e(409));Ur(n,i,null,null)},Vr.prototype.unmount=ul.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;qn(function(){Ur(null,n,null,null)}),i[rn]=null}};function Vr(n){this._internalRoot=n}Vr.prototype.unstable_scheduleHydration=function(n){if(n){var i=Eu();n={blockedOn:null,target:n,priority:i};for(var a=0;a<yn.length&&i!==0&&i<yn[a].priority;a++);yn.splice(a,0,n),a===0&&ku(n)}};function cl(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Gr(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Uh(){}function $p(n,i,a,c,d){if(d){if(typeof c=="function"){var m=c;c=function(){var I=$r(A);m.call(I)}}var A=jh(i,c,n,0,null,!1,!1,"",Uh);return n._reactRootContainer=A,n[rn]=A.current,ss(n.nodeType===8?n.parentNode:n),qn(),A}for(;d=n.lastChild;)n.removeChild(d);if(typeof c=="function"){var b=c;c=function(){var I=$r(C);b.call(I)}}var C=ol(n,0,!1,null,null,!1,!1,"",Uh);return n._reactRootContainer=C,n[rn]=C.current,ss(n.nodeType===8?n.parentNode:n),qn(function(){Ur(i,C,a,c)}),C}function Wr(n,i,a,c,d){var m=a._reactRootContainer;if(m){var A=m;if(typeof d=="function"){var b=d;d=function(){var C=$r(A);b.call(C)}}Ur(i,A,n,d)}else A=$p(a,i,n,d,c);return $r(A)}Su=function(n){switch(n.tag){case 3:var i=n.stateNode;if(i.current.memoizedState.isDehydrated){var a=$i(i.pendingLanes);a!==0&&(Ia(i,a|1),Ae(i,Ht()),(Ct&6)===0&&(ki=Ht()+500,En()))}break;case 13:qn(function(){var c=un(n,1);if(c!==null){var d=de();We(c,n,1,d)}}),ll(n,1)}},Na=function(n){if(n.tag===13){var i=un(n,134217728);if(i!==null){var a=de();We(i,n,134217728,a)}ll(n,134217728)}},bu=function(n){if(n.tag===13){var i=Rn(n),a=un(n,i);if(a!==null){var c=de();We(a,n,i,c)}ll(n,i)}},Eu=function(){return Tt},xu=function(n,i){var a=Tt;try{return Tt=n,i()}finally{Tt=a}},Ca=function(n,i,a){switch(i){case"input":if(ya(n,a),i=a.name,a.type==="radio"&&i!=null){for(a=n;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<a.length;i++){var c=a[i];if(c!==n&&c.form===n.form){var d=ur(c);if(!d)throw Error(e(90));Yl(c),ya(c,d)}}}break;case"textarea":tu(n,a);break;case"select":i=a.value,i!=null&&si(n,!!a.multiple,i,!1)}},uu=el,cu=qn;var Vp={usingClientEntryPoint:!1,Events:[os,pi,ur,ou,lu,el]},_s={findFiberByHostInstance:Bn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Gp={bundleType:_s.bundleType,version:_s.version,rendererPackageName:_s.rendererPackageName,rendererConfig:_s.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=pu(n),n===null?null:n.stateNode},findFiberByHostInstance:_s.findFiberByHostInstance||Up,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xr.isDisabled&&Xr.supportsFiber)try{Vs=Xr.inject(Gp),Ke=Xr}catch{}}return _e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vp,_e.createPortal=function(n,i){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cl(i))throw Error(e(200));return Hp(n,i,null,a)},_e.createRoot=function(n,i){if(!cl(n))throw Error(e(299));var a=!1,c="",d=Hh;return i!=null&&(i.unstable_strictMode===!0&&(a=!0),i.identifierPrefix!==void 0&&(c=i.identifierPrefix),i.onRecoverableError!==void 0&&(d=i.onRecoverableError)),i=ol(n,1,!1,null,null,a,!1,c,d),n[rn]=i.current,ss(n.nodeType===8?n.parentNode:n),new ul(i)},_e.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(e(188)):(n=Object.keys(n).join(","),Error(e(268,n)));return n=pu(i),n=n===null?null:n.stateNode,n},_e.flushSync=function(n){return qn(n)},_e.hydrate=function(n,i,a){if(!Gr(i))throw Error(e(200));return Wr(null,n,i,!0,a)},_e.hydrateRoot=function(n,i,a){if(!cl(n))throw Error(e(405));var c=a!=null&&a.hydratedSources||null,d=!1,m="",A=Hh;if(a!=null&&(a.unstable_strictMode===!0&&(d=!0),a.identifierPrefix!==void 0&&(m=a.identifierPrefix),a.onRecoverableError!==void 0&&(A=a.onRecoverableError)),i=jh(i,null,n,1,a??null,d,!1,m,A),n[rn]=i.current,ss(n),c)for(n=0;n<c.length;n++)a=c[n],d=a._getVersion,d=d(a._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[a,d]:i.mutableSourceEagerHydrationData.push(a,d);return new Vr(i)},_e.render=function(n,i,a){if(!Gr(i))throw Error(e(200));return Wr(null,n,i,!1,a)},_e.unmountComponentAtNode=function(n){if(!Gr(n))throw Error(e(40));return n._reactRootContainer?(qn(function(){Wr(null,null,n,!1,function(){n._reactRootContainer=null,n[rn]=null})}),!0):!1},_e.unstable_batchedUpdates=el,_e.unstable_renderSubtreeIntoContainer=function(n,i,a,c){if(!Gr(a))throw Error(e(200));if(n==null||n._reactInternals===void 0)throw Error(e(38));return Wr(n,i,a,!1,c)},_e.version="18.3.1-next-f1338f8080-20240426",_e}var Zh;function tg(){if(Zh)return pl.exports;Zh=1;function g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(t){console.error(t)}}return g(),pl.exports=Jp(),pl.exports}var Jh;function eg(){if(Jh)return Yr;Jh=1;var g=tg();return Yr.createRoot=g.createRoot,Yr.hydrateRoot=g.hydrateRoot,Yr}var ng=eg();const ig=Ad(ng),ta={"Em Space":" ","En Space":" ","Thin Space":" ","Thin Space*2":"  ","Hair Space":" ","Narrow, Hair":"  ","Thin, Hair":"   ","Hair Space*3":"   ","Narrow No-Break":" ","Narrow No-Break*2":"  ","Zero Width Space":" ​ ","Word Joiner":" ⁠ "},sg={"Em Space":"in wide spacing between characters","En Space":"for mid-range spacing","Thin Space":"for slightly narrower spacing","Thin Space*2":"for even narrower spacing","Hair Space":"for very thin spacing","Narrow, Hair":"for extra narrow hair-like spacing","Thin, Hair":"for a mix of thin and hair spacing","Hair Space*3":"for extremely tight spacing","Narrow No-Break":"to prevent line breaks with tight spacing","Narrow No-Break*2":"for even tighter no-break spacing","Zero Width Space":"to create word breaks without visible space","Word Joiner":"to prevent word breaks without adding width"},rg=g=>g.split("").map(t=>"\\u"+t.charCodeAt(0).toString(16).padStart(4,"0").toUpperCase()).join(""),_d=(g,t)=>!g||typeof g!="string"?"":g.split(" ").join(t),ag=(g,t)=>{if(!g||typeof g!="string")return"";const s=new DOMParser().parseFromString(g,"text/html"),r=o=>{if(o.nodeType===Node.TEXT_NODE)o.textContent=_d(o.textContent,t);else for(let l of o.childNodes)r(l)};return r(s.body),s.body.innerHTML},td=(g,t,e=!1)=>{if(!g||g.length===0)return t;const s=g.map(r=>ta[r]).join("");return e?ag(t,s):_d(t,s)};var Rs={};Rs.d=(g,t)=>{for(var e in t)Rs.o(t,e)&&!Rs.o(g,e)&&Object.defineProperty(g,e,{enumerable:!0,get:t[e]})};Rs.o=(g,t)=>Object.prototype.hasOwnProperty.call(g,t);var dt=globalThis.pdfjsLib={};Rs.d(dt,{AbortException:()=>Fn,AnnotationEditorLayer:()=>pn,AnnotationEditorParamsType:()=>Et,AnnotationEditorType:()=>mt,AnnotationEditorUIManager:()=>On,AnnotationLayer:()=>ev,AnnotationMode:()=>Nn,ColorPicker:()=>ze,DOMSVGFactory:()=>Vl,DrawLayer:()=>fe,FeatureTest:()=>ge,GlobalWorkerOptions:()=>Ls,ImageKind:()=>ea,InvalidPDFException:()=>xl,MissingPDFException:()=>Is,OPS:()=>qe,OutputScale:()=>Cl,PDFDataRangeTransport:()=>Bd,PDFDateString:()=>Ed,PDFWorker:()=>Ii,PasswordResponses:()=>cg,PermissionFlag:()=>ug,PixelsPerInch:()=>Fi,RenderingCancelledException:()=>Dl,TextLayer:()=>pe,TouchManager:()=>fa,UnexpectedResponseException:()=>sa,Util:()=>st,VerbosityLevel:()=>oa,XfaLayer:()=>Ud,build:()=>Dm,createValidAbsoluteUrl:()=>pg,fetchData:()=>ha,getDocument:()=>Cm,getFilenameFromUrl:()=>bg,getPdfFilenameFromUrl:()=>Eg,getXfaPageViewport:()=>xg,isDataScheme:()=>da,isPdfFile:()=>Fl,noContextMenu:()=>Ye,normalizeUnicode:()=>Ag,setLayerDimensions:()=>ei,shadow:()=>_t,stopEvent:()=>Re,version:()=>Nm});const ue=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Sd=[1,0,0,1,0,0],El=[.001,0,0,.001,0,0],og=1e7,vl=1.35,Pe={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Nn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},lg="pdfjs_internal_editor_",mt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},Et={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},ug={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},oe={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},ea={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Kt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},Es={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},oa={ERRORS:0,WARNINGS:1,INFOS:5},qe={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},cg={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let la=oa.WARNINGS;function hg(g){Number.isInteger(g)&&(la=g)}function dg(){return la}function ua(g){la>=oa.INFOS&&console.log(`Info: ${g}`)}function vt(g){la>=oa.WARNINGS&&console.log(`Warning: ${g}`)}function Rt(g){throw new Error(g)}function Xt(g,t){g||Rt(t)}function fg(g){switch(g?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function pg(g,t=null,e=null){if(!g)return null;try{if(e&&typeof g=="string"&&(e.addDefaultProtocol&&g.startsWith("www.")&&g.match(/\./g)?.length>=2&&(g=`http://${g}`),e.tryConvertEncoding))try{g=wg(g)}catch{}const s=t?new URL(g,t):new URL(g);if(fg(s))return s}catch{}return null}function _t(g,t,e,s=!1){return Object.defineProperty(g,t,{value:e,enumerable:!s,configurable:!0,writable:!1}),e}const zn=(function(){function t(e,s){this.message=e,this.name=s}return t.prototype=new Error,t.constructor=t,t})();class ed extends zn{constructor(t,e){super(t,"PasswordException"),this.code=e}}class yl extends zn{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class xl extends zn{constructor(t){super(t,"InvalidPDFException")}}class Is extends zn{constructor(t){super(t,"MissingPDFException")}}class sa extends zn{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class gg extends zn{constructor(t){super(t,"FormatError")}}class Fn extends zn{constructor(t){super(t,"AbortException")}}function bd(g){(typeof g!="object"||g?.length===void 0)&&Rt("Invalid argument for bytesToString");const t=g.length,e=8192;if(t<e)return String.fromCharCode.apply(null,g);const s=[];for(let r=0;r<t;r+=e){const o=Math.min(r+e,t),l=g.subarray(r,o);s.push(String.fromCharCode.apply(null,l))}return s.join("")}function ca(g){typeof g!="string"&&Rt("Invalid argument for stringToBytes");const t=g.length,e=new Uint8Array(t);for(let s=0;s<t;++s)e[s]=g.charCodeAt(s)&255;return e}function mg(g){return String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,g&255)}function Il(g){const t=Object.create(null);for(const[e,s]of g)t[e]=s;return t}function vg(){const g=new Uint8Array(4);return g[0]=1,new Uint32Array(g.buffer,0,1)[0]===1}function yg(){try{return new Function(""),!0}catch{return!1}}class ge{static get isLittleEndian(){return _t(this,"isLittleEndian",vg())}static get isEvalSupported(){return _t(this,"isEvalSupported",yg())}static get isOffscreenCanvasSupported(){return _t(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return _t(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof navigator?.platform=="string"?_t(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof navigator?.userAgent=="string"&&navigator.userAgent.includes("Firefox")}):_t(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){return _t(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const wl=Array.from(Array(256).keys(),g=>g.toString(16).padStart(2,"0"));class st{static makeHexColor(t,e,s){return`#${wl[t]}${wl[e]}${wl[s]}`}static scaleMinMax(t,e){let s;t[0]?(t[0]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[3],e[3]*=t[3]):(s=e[0],e[0]=e[1],e[1]=s,s=e[2],e[2]=e[3],e[3]=s,t[1]<0&&(s=e[1],e[1]=e[3],e[3]=s),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(s=e[0],e[0]=e[2],e[2]=s),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const s=t[0]*e[0]+t[1]*e[2]+e[4],r=t[0]*e[1]+t[1]*e[3]+e[5];return[s,r]}static applyInverseTransform(t,e){const s=e[0]*e[3]-e[1]*e[2],r=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/s,o=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/s;return[r,o]}static getAxialAlignedBoundingBox(t,e){const s=this.applyTransform(t,e),r=this.applyTransform(t.slice(2,4),e),o=this.applyTransform([t[0],t[3]],e),l=this.applyTransform([t[2],t[1]],e);return[Math.min(s[0],r[0],o[0],l[0]),Math.min(s[1],r[1],o[1],l[1]),Math.max(s[0],r[0],o[0],l[0]),Math.max(s[1],r[1],o[1],l[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],s=t[0]*e[0]+t[1]*e[2],r=t[0]*e[1]+t[1]*e[3],o=t[2]*e[0]+t[3]*e[2],l=t[2]*e[1]+t[3]*e[3],u=(s+l)/2,h=Math.sqrt((s+l)**2-4*(s*l-o*r))/2,f=u+h||1,p=u-h||1;return[Math.sqrt(f),Math.sqrt(p)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const s=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(s>r)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return o>l?null:[s,o,r,l]}static#t(t,e,s,r,o,l,u,h,f,p){if(f<=0||f>=1)return;const v=1-f,y=f*f,w=y*f,_=v*(v*(v*t+3*f*e)+3*y*s)+w*r,S=v*(v*(v*o+3*f*l)+3*y*u)+w*h;p[0]=Math.min(p[0],_),p[1]=Math.min(p[1],S),p[2]=Math.max(p[2],_),p[3]=Math.max(p[3],S)}static#e(t,e,s,r,o,l,u,h,f,p,v,y){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,s,r,o,l,u,h,-v/p,y);return}const w=p**2-4*v*f;if(w<0)return;const _=Math.sqrt(w),S=2*f;this.#t(t,e,s,r,o,l,u,h,(-p+_)/S,y),this.#t(t,e,s,r,o,l,u,h,(-p-_)/S,y)}static bezierBoundingBox(t,e,s,r,o,l,u,h,f){return f?(f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,h),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,h)):f=[Math.min(t,u),Math.min(e,h),Math.max(t,u),Math.max(e,h)],this.#e(t,s,o,u,e,r,l,h,3*(-t+3*(s-o)+u),6*(t-2*s+o),3*(s-t),f),this.#e(t,s,o,u,e,r,l,h,3*(-e+3*(r-l)+h),6*(e-2*r+l),3*(r-e),f),f}}function wg(g){return decodeURIComponent(escape(g))}let Al=null,nd=null;function Ag(g){return Al||(Al=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,nd=new Map([["ﬅ","ſt"]])),g.replaceAll(Al,(t,e,s)=>e?e.normalize("NFKC"):nd.get(s))}function _g(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const g=new Uint8Array(32);return crypto.getRandomValues(g),bd(g)}const Nl="pdfjs_internal_id_";function Sg(g){return Uint8Array.prototype.toBase64?g.toBase64():btoa(bd(g))}typeof Promise.try!="function"&&(Promise.try=function(g,...t){return new Promise(e=>{e(g(...t))})});const fn="http://www.w3.org/2000/svg";class Fi{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function ha(g,t="text"){if(Ts(g,document.baseURI)){const e=await fetch(g);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,s)=>{const r=new XMLHttpRequest;r.open("GET",g,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(r.response);return}e(r.responseText);return}s(new Error(r.statusText))}},r.send(null)})}class Ds{constructor({viewBox:t,userUnit:e,scale:s,rotation:r,offsetX:o=0,offsetY:l=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=s,this.rotation=r,this.offsetX=o,this.offsetY=l,s*=e;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,v,y,w;switch(r%=360,r<0&&(r+=360),r){case 180:p=-1,v=0,y=0,w=1;break;case 90:p=0,v=1,y=1,w=0;break;case 270:p=0,v=-1,y=-1,w=0;break;case 0:p=1,v=0,y=0,w=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(y=-y,w=-w);let _,S,x,E;p===0?(_=Math.abs(f-t[1])*s+o,S=Math.abs(h-t[0])*s+l,x=(t[3]-t[1])*s,E=(t[2]-t[0])*s):(_=Math.abs(h-t[0])*s+o,S=Math.abs(f-t[1])*s+l,x=(t[2]-t[0])*s,E=(t[3]-t[1])*s),this.transform=[p*s,v*s,y*s,w*s,_-p*s*h-y*s*f,S-v*s*h-w*s*f],this.width=x,this.height=E}get rawDims(){const{userUnit:t,viewBox:e}=this,s=e.map(r=>r*t);return _t(this,"rawDims",{pageWidth:s[2]-s[0],pageHeight:s[3]-s[1],pageX:s[0],pageY:s[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:s=this.offsetX,offsetY:r=this.offsetY,dontFlip:o=!1}={}){return new Ds({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:r,dontFlip:o})}convertToViewportPoint(t,e){return st.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=st.applyTransform([t[0],t[1]],this.transform),s=st.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],s[0],s[1]]}convertToPdfPoint(t,e){return st.applyInverseTransform([t,e],this.transform)}}class Dl extends zn{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function da(g){const t=g.length;let e=0;for(;e<t&&g[e].trim()==="";)e++;return g.substring(e,e+5).toLowerCase()==="data:"}function Fl(g){return typeof g=="string"&&/\.pdf$/i.test(g)}function bg(g){return[g]=g.split(/[#?]/,1),g.substring(g.lastIndexOf("/")+1)}function Eg(g,t="document.pdf"){if(typeof g!="string")return t;if(da(g))return vt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,r=e.exec(g);let o=s.exec(r[1])||s.exec(r[2])||s.exec(r[3]);if(o&&(o=o[0],o.includes("%")))try{o=s.exec(decodeURIComponent(o))[0]}catch{}return o||t}class id{started=Object.create(null);times=[];time(t){t in this.started&&vt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||vt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:s}of this.times)e=Math.max(s.length,e);for(const{name:s,start:r,end:o}of this.times)t.push(`${s.padEnd(e)} ${o-r}ms
`);return t.join("")}}function Ts(g,t){try{const{protocol:e}=t?new URL(g,t):new URL(g);return e==="http:"||e==="https:"}catch{return!1}}function Ye(g){g.preventDefault()}function Re(g){g.preventDefault(),g.stopPropagation()}class Ed{static#t;static toDateObject(t){if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const s=parseInt(e[1],10);let r=parseInt(e[2],10);r=r>=1&&r<=12?r-1:0;let o=parseInt(e[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const f=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let v=parseInt(e[9],10)||0;return v=v>=0&&v<=59?v:0,f==="-"?(l+=p,u+=v):f==="+"&&(l-=p,u-=v),new Date(Date.UTC(s,r,o,l,u,h))}}function xg(g,{scale:t=1,rotation:e=0}){const{width:s,height:r}=g.attributes.style,o=[0,0,parseInt(s),parseInt(r)];return new Ds({viewBox:o,userUnit:1,scale:t,rotation:e})}function Ol(g){if(g.startsWith("#")){const t=parseInt(g.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return g.startsWith("rgb(")?g.slice(4,-1).split(",").map(t=>parseInt(t)):g.startsWith("rgba(")?g.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(vt(`Not a valid color format: "${g}"`),[0,0,0])}function Cg(g){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of g.keys()){t.style.color=e;const s=window.getComputedStyle(t).color;g.set(e,Ol(s))}t.remove()}function Ot(g){const{a:t,b:e,c:s,d:r,e:o,f:l}=g.getTransform();return[t,e,s,r,o,l]}function en(g){const{a:t,b:e,c:s,d:r,e:o,f:l}=g.getTransform().invertSelf();return[t,e,s,r,o,l]}function ei(g,t,e=!1,s=!0){if(t instanceof Ds){const{pageWidth:r,pageHeight:o}=t.rawDims,{style:l}=g,u=ge.isCSSRoundSupported,h=`var(--scale-factor) * ${r}px`,f=`var(--scale-factor) * ${o}px`,p=u?`round(down, ${h}, var(--scale-round-x, 1px))`:`calc(${h})`,v=u?`round(down, ${f}, var(--scale-round-y, 1px))`:`calc(${f})`;!e||t.rotation%180===0?(l.width=p,l.height=v):(l.width=v,l.height=p)}s&&g.setAttribute("data-main-rotation",t.rotation)}class Cl{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}class Ms{#t=null;#e=null;#n;#i=null;#r=null;static#s=null;constructor(t){this.#n=t,Ms.#s||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;t.addEventListener("contextmenu",Ye,{signal:e}),t.addEventListener("pointerdown",Ms.#l,{signal:e});const s=this.#i=document.createElement("div");s.className="buttons",t.append(s);const r=this.#n.toolbarPosition;if(r){const{style:o}=t,l=this.#n._uiManager.direction==="ltr"?1-r[0]:r[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return this.#d(),t}get div(){return this.#t}static#l(t){t.stopPropagation()}#o(t){this.#n._focusEventsAllowed=!1,Re(t)}#c(t){this.#n._focusEventsAllowed=!0,Re(t)}#u(t){const e=this.#n._uiManager._signal;t.addEventListener("focusin",this.#o.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#c.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Ye,{signal:e})}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#r?.shown()}#d(){const{editorType:t,_uiManager:e}=this.#n,s=document.createElement("button");s.className="delete",s.tabIndex=0,s.setAttribute("data-l10n-id",Ms.#s[t]),this.#u(s),s.addEventListener("click",r=>{e.delete()},{signal:e._signal}),this.#i.append(s)}get#h(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#u(e),this.#i.prepend(e,this.#h),this.#r=t}addColorPicker(t){this.#e=t;const e=t.renderButton();this.#u(e),this.#i.prepend(e,this.#h)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class kg{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Ye,{signal:this.#n._signal});const e=this.#t=document.createElement("div");return e.className="buttons",t.append(e),this.#s(),t}#r(t,e){let s=0,r=0;for(const o of t){const l=o.y+o.height;if(l<s)continue;const u=o.x+(e?o.width:0);if(l>s){r=u,s=l;continue}e?u>r&&(r=u):u<r&&(r=u)}return[e?1-r:r,s]}show(t,e,s){const[r,o]=this.#r(e,s),{style:l}=this.#e||=this.#i();t.append(this.#e),l.insetInlineEnd=`${100*r}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#s(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const s=this.#n._signal;t.addEventListener("contextmenu",Ye,{signal:s}),t.addEventListener("click",()=>{this.#n.highlightSelection("floating_button")},{signal:s}),this.#t.append(t)}}function ra(g,t,e){for(const s of e)t.addEventListener(s,g[s].bind(g))}class Tg{#t=0;get id(){return`${lg}${this.#t++}`}}class zl{#t=_g();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',s=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const o=r.decode().then(()=>(s.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(s.getImageData(0,0,1,1).data.buffer)[0]===0));return _t(this,"_isSVGFittingCanvas",o)}async#i(t,e){this.#n||=new Map;let s=this.#n.get(t);if(s===null)return null;if(s?.bitmap)return s.refCounter+=1,s;try{s||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof e=="string"?(s.url=e,r=await ha(e,"blob")):e instanceof File?r=s.file=e:e instanceof Blob&&(r=e),r.type==="image/svg+xml"){const o=zl._isSVGFittingCanvas,l=new FileReader,u=new Image,h=new Promise((f,p)=>{u.onload=()=>{s.bitmap=u,s.isSvg=!0,f()},l.onload=async()=>{const v=s.svgUrl=l.result;u.src=await o?`${v}#svgView(preserveAspectRatio(none))`:v},u.onerror=l.onerror=p});l.readAsDataURL(r),await h}else s.bitmap=await createImageBitmap(r);s.refCounter=1}catch(r){vt(r),s=null}return this.#n.set(t,s),s&&this.#n.set(s.id,s),s}async getFromFile(t){const{lastModified:e,name:s,size:r,type:o}=t;return this.#i(`${e}_${s}_${r}_${o}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const s=await e;return this.#i(t,s)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:s}=e;return delete e.blobPromise,this.getFromBlob(e.id,s)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let s=this.#n.get(t);if(s?.bitmap)return s.refCounter+=1,s;const r=new OffscreenCanvas(e.width,e.height);return r.getContext("2d").drawImage(e,0,0),s={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,s),this.#n.set(s.id,s),s}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:s}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(s.width,s.height);r.getContext("bitmaprenderer").transferFromImageBitmap(s),e.blobPromise=r.convertToBlob()}s.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class Pg{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:s,mustExec:r,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:u=!1}){if(r&&t(),this.#e)return;const h={cmd:t,undo:e,post:s,type:o};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(l&&this.#t[this.#i].type===o){u&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class Fs{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=ge.platform;for(const[s,r,o={}]of t)for(const l of s){const u=l.startsWith("mac+");e&&u?(this.callbacks.set(l.slice(4),{callback:r,options:o}),this.allKeys.add(l.split("+").at(-1))):!e&&!u&&(this.callbacks.set(l,{callback:r,options:o}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const s=this.callbacks.get(this.#t(e));if(!s)return;const{callback:r,options:{bubbles:o=!1,args:l=[],checker:u=null}}=s;u&&!u(t,e)||(r.bind(t,...l,e)(),o||Re(e))}}class jl{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return Cg(t),_t(this,"_colors",t)}convert(t){const e=Ol(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[s,r]of this._colors)if(r.every((o,l)=>o===e[l]))return jl._colorsMapping.get(s);return e}getHexCode(t){const e=this._colors.get(t);return e?st.makeHexColor(...e):t}}class On{#t=new AbortController;#e=null;#n=new Map;#i=new Map;#r=null;#s=null;#l=null;#o=new Pg;#c=null;#u=null;#d=0;#h=new Set;#f=null;#a=null;#p=new Set;_editorUndoBar=null;#m=!1;#g=!1;#v=!1;#A=null;#y=null;#_=null;#b=null;#x=!1;#k=null;#P=new Tg;#S=!1;#T=!1;#C=null;#M=null;#N=null;#F=null;#E=mt.NONE;#w=new Set;#I=null;#H=null;#U=null;#$={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#O=[0,0];#D=null;#z=null;#V=null;#L=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=On.prototype,e=l=>l.#z.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),s=(l,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return _t(this,"_keyboardManager",new Fs([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:s}],[["ctrl+z","mac+meta+z"],t.undo,{checker:s}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:s}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:s}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#z.contains(u)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&l.#z.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:e}]]))}constructor(t,e,s,r,o,l,u,h,f,p,v,y,w){const _=this._signal=this.#t.signal;this.#z=t,this.#V=e,this.#r=s,this._eventBus=r,r._on("editingaction",this.onEditingAction.bind(this),{signal:_}),r._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),r._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),r._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),r._on("setpreference",this.onSetPreference.bind(this),{signal:_}),r._on("switchannotationeditorparams",S=>this.updateParams(S.type,S.value),{signal:_}),this.#et(),this.#rt(),this.#q(),this.#s=o.annotationStorage,this.#A=o.filterFactory,this.#H=l,this.#b=u||null,this.#m=h,this.#g=f,this.#v=p,this.#F=v||null,this.viewParameters={realScale:Fi.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=y||null,this._supportsPinchToZoom=w!==!1}destroy(){this.#L?.resolve(),this.#L=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#i.values())t.destroy();this.#i.clear(),this.#n.clear(),this.#p.clear(),this.#e=null,this.#w.clear(),this.#o.destroy(),this.#r?.destroy(),this.#k?.hide(),this.#k=null,this.#y&&(clearTimeout(this.#y),this.#y=null),this.#D&&(clearTimeout(this.#D),this.#D=null),this._editorUndoBar?.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#F}get useNewAltTextFlow(){return this.#g}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return _t(this,"hcmFilter",this.#H?this.#A.addHCMFilter(this.#H.foreground,this.#H.background):"none")}get direction(){return _t(this,"direction",getComputedStyle(this.#z).direction)}get highlightColors(){return _t(this,"highlightColors",this.#b?new Map(this.#b.split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return _t(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=t}setMainHighlightColorPicker(t){this.#N=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#v=e;break}}onPageChanging({pageNumber:t}){this.#d=t-1}focusMainContainer(){this.#z.focus()}findParent(t,e){for(const s of this.#i.values()){const{x:r,y:o,width:l,height:u}=s.div.getBoundingClientRect();if(t>=r&&t<=r+l&&e>=o&&e<=o+u)return s}return null}disableUserSelect(t=!1){this.#V.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Fi.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#j({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#X(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const s of this.#i.values())if(s.hasTextLayer(t))return s;return null}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:s,anchorOffset:r,focusNode:o,focusOffset:l}=e,u=e.toString(),f=this.#j(e).closest(".textLayer"),p=this.getSelectionBoxes(f);if(!p)return;e.empty();const v=this.#X(f),y=this.#E===mt.NONE,w=()=>{v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:p,anchorNode:s,anchorOffset:r,focusNode:o,focusOffset:l,text:u}),y&&this.showAllEditors("highlight",!0,!0)};if(y){this.switchToMode(mt.HIGHLIGHT,w);return}w()}#J(){const t=document.getSelection();if(!t||t.isCollapsed)return;const s=this.#j(t).closest(".textLayer"),r=this.getSelectionBoxes(s);r&&(this.#k||=new kg(this),this.#k.show(s,r,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}#tt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#I&&(this.#k?.hide(),this.#I=null,this.#R({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#I)return;const r=this.#j(t).closest(".textLayer");if(!r){this.#I&&(this.#k?.hide(),this.#I=null,this.#R({hasSelectedText:!1}));return}if(this.#k?.hide(),this.#I=e,this.#R({hasSelectedText:!0}),!(this.#E!==mt.HIGHLIGHT&&this.#E!==mt.NONE)&&(this.#E===mt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#x=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#E===mt.HIGHLIGHT?this.#X(r):null;o?.toggleDrawing();const l=new AbortController,u=this.combinedSignal(l),h=f=>{f.type==="pointerup"&&f.button!==0||(l.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}}#W(t=""){this.#E===mt.HIGHLIGHT?this.highlightSelection(t):this.#m&&this.#J()}#et(){document.addEventListener("selectionchange",this.#tt.bind(this),{signal:this._signal})}#nt(){if(this.#_)return;this.#_=new AbortController;const t=this.combinedSignal(this.#_);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#it(){this.#_?.abort(),this.#_=null}blur(){if(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#W("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#w)if(e.div.contains(t)){this.#M=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#M)return;const[t,e]=this.#M;this.#M=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#q(){if(this.#C)return;this.#C=new AbortController;const t=this.combinedSignal(this.#C);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#st(){this.#C?.abort(),this.#C=null}#Y(){if(this.#c)return;this.#c=new AbortController;const t=this.combinedSignal(this.#c);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#K(){this.#c?.abort(),this.#c=null}#rt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#q(),this.#Y()}removeEditListeners(){this.#st(),this.#K()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const s of this.#a)if(s.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const s of this.#a)if(s.isHandlingMimeForPasting(e.type)){s.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const s of this.#w){const r=s.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const o of e.items)for(const l of this.#a)if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let s=e.getData("application/pdfjs");if(!s)return;try{s=JSON.parse(s)}catch(o){vt(`paste: "${o.message}".`);return}if(!Array.isArray(s))return;this.unselectAll();const r=this.currentLayer;try{const o=[];for(const h of s){const f=await r.deserialize(h);if(!f)return;o.push(f)}const l=()=>{for(const h of o)this.#Q(h);this.#Z(o)},u=()=>{for(const h of o)h.remove()};this.addCommands({cmd:l,undo:u,mustExec:!0})}catch(o){vt(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#E!==mt.NONE&&!this.isEditorHandlingKeyboard&&On._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#W("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}#R(t){Object.entries(t).some(([s,r])=>this.#$[s]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#$,t)}),this.#E===mt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#B([[Et.HIGHLIGHT_FREE,!0]]))}#B(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#nt(),this.#Y(),this.#R({isEditing:this.#E!==mt.NONE,isEmpty:this.#G(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#it(),this.#K(),this.#R({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#a){this.#a=t;for(const e of this.#a)this.#B(e.defaultPropertiesToUpdate)}}getId(){return this.#P.id}get currentLayer(){return this.#i.get(this.#d)}getLayer(t){return this.#i.get(t)}get currentPageIndex(){return this.#d}addLayer(t){this.#i.set(t.pageIndex,t),this.#S?t.enable():t.disable()}removeLayer(t){this.#i.delete(t.pageIndex)}async updateMode(t,e=null,s=!1){if(this.#E!==t&&!(this.#L&&(await this.#L.promise,!this.#L))){if(this.#L=Promise.withResolvers(),this.#E=t,t===mt.NONE){this.setEditingState(!1),this.#ot(),this._editorUndoBar?.hide(),this.#L.resolve();return}this.setEditingState(!0),await this.#at(),this.unselectAll();for(const r of this.#i.values())r.updateMode(t);if(!e){s&&this.addNewEditorFromKeyboard(),this.#L.resolve();return}for(const r of this.#n.values())r.annotationElementId===e?(this.setSelected(r),r.enterInEditMode()):r.unselect();this.#L.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==this.#E&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){if(this.#a){switch(t){case Et.CREATE:this.currentLayer.addNewEditor();return;case Et.HIGHLIGHT_DEFAULT_COLOR:this.#N?.updateColor(e);break;case Et.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#U||=new Map).set(t,e),this.showAllEditors("highlight",e);break}for(const s of this.#w)s.updateParams(t,e);for(const s of this.#a)s.updateDefaultParams(t,e)}}showAllEditors(t,e,s=!1){for(const o of this.#n.values())o.editorType===t&&o.show(e);(this.#U?.get(Et.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#B([[Et.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#T!==t){this.#T=t;for(const e of this.#i.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#at(){if(!this.#S){this.#S=!0;const t=[];for(const e of this.#i.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#ot(){if(this.unselectAll(),this.#S){this.#S=!1;for(const t of this.#i.values())t.disable();for(const t of this.#n.values())t.disable()}}getEditors(t){const e=[];for(const s of this.#n.values())s.pageIndex===t&&e.push(s);return e}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.focusMainContainer(),this.#y=null},0)),this.#n.delete(t.id),this.unselect(t),(!t.annotationElementId||!this.#h.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#h.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#h.has(t)}removeDeletedAnnotationElement(t){this.#h.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#Q(t){const e=this.#i.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#B(t.propertiesToUpdate))}get#lt(){let t=null;for(t of this.#w);return t}updateUI(t){this.#lt===t&&this.#B(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#B(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#R({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#B(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}setSelected(t){this.#u?.commitOrRemove();for(const e of this.#w)e!==t&&e.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#B(t.propertiesToUpdate),this.#R({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#R({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#o.undo(),this.#R({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#G()}),this._editorUndoBar?.hide()}redo(){this.#o.redo(),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#G()})}addCommands(t){this.#o.add(t),this.#R({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#G()})}cleanUndoStack(t){this.#o.cleanType(t)}#G(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#w],s=()=>{this._editorUndoBar?.show(r,e.length===1?e[0].editorType:e.length);for(const o of e)o.remove()},r=()=>{for(const o of e)this.#Q(o)};this.addCommands({cmd:s,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#Z(t){for(const e of this.#w)e.unselect();this.#w.clear();for(const e of t)e.isEmpty()||(this.#w.add(e),e.select());this.#R({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#w)t.commit();this.#Z(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#E!==mt.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const t of this.#w)t.unselect();this.#w.clear(),this.#R({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,s=!1){if(s||this.commitOrRemove(),!this.hasSelection)return;this.#O[0]+=t,this.#O[1]+=e;const[r,o]=this.#O,l=[...this.#w],u=1e3;this.#D&&clearTimeout(this.#D),this.#D=setTimeout(()=>{this.#D=null,this.#O[0]=this.#O[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#n.has(h.id)&&h.translateInPage(r,o)},undo:()=>{for(const h of l)this.#n.has(h.id)&&h.translateInPage(-r,-o)},mustExec:!1})},u);for(const h of l)h.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const t of this.#w)this.#f.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const t=this.#f;this.#f=null;let e=!1;for(const[{x:r,y:o,pageIndex:l},u]of t)u.newX=r,u.newY=o,u.newPageIndex=l,e||=r!==u.savedX||o!==u.savedY||l!==u.savedPageIndex;if(!e)return!1;const s=(r,o,l,u)=>{if(this.#n.has(r.id)){const h=this.#i.get(u);h?r._setParentAndPosition(h,o,l):(r.pageIndex=u,r.x=o,r.y=l)}};return this.addCommands({cmd:()=>{for(const[r,{newX:o,newY:l,newPageIndex:u}]of t)s(r,o,l,u)},undo:()=>{for(const[r,{savedX:o,savedY:l,savedPageIndex:u}]of t)s(r,o,l,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#f)for(const s of this.#f.keys())s.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#E}get imageManager(){return _t(this,"imageManager",new zl)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,p=e.rangeCount;f<p;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:s,y:r,width:o,height:l}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,p,v,y)=>({x:(p-r)/l,y:1-(f+v-s)/o,width:y/l,height:v/o});break;case"180":u=(f,p,v,y)=>({x:1-(f+v-s)/o,y:1-(p+y-r)/l,width:v/o,height:y/l});break;case"270":u=(f,p,v,y)=>({x:1-(p+y-r)/l,y:(f-s)/o,width:y/l,height:v/o});break;default:u=(f,p,v,y)=>({x:(f-s)/o,y:(p-r)/l,width:v/o,height:y/l});break}const h=[];for(let f=0,p=e.rangeCount;f<p;f++){const v=e.getRangeAt(f);if(!v.collapsed)for(const{x:y,y:w,width:_,height:S}of v.getClientRects())_===0||S===0||h.push(u(y,w,_,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#l||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#l?.delete(t)}renderAnnotationElement(t){const e=this.#l?.get(t.data.id);if(!e)return;const s=this.#s.getRawValue(e);s&&(this.#E===mt.NONE&&!s.hasBeenModified||s.renderAnnotationElement(t))}}class sn{#t=null;#e=!1;#n=null;#i=null;#r=null;#s=null;#l=!1;#o=null;#c=null;#u=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,sn.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){sn._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",sn.#f.missing),e.setAttribute("data-l10n-id",sn.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const s=this.#c._uiManager._signal;t.addEventListener("contextmenu",Ye,{signal:s}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:s});const r=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#a}})};return t.addEventListener("click",r,{capture:!0,signal:s}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#l=!0,r(o))},{signal:s}),await this.#p(),t}get#a(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#l}),this.#l=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#u:this.isEmpty()}get guessedText(){return this.#u}async setGuessedText(t){this.#t===null&&(this.#u=t,this.#d=await sn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#u===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#u,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:s,textWithDisclaimer:r,cancel:o=!1}){s&&(this.#u=s,this.#d=r),!(this.#t===t&&this.#e===e)&&(o||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#a}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#r=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",sn.#f[this.#a]),this.#i?.setAttribute("data-l10n-id",sn.#f[`${this.#a}-label`]),!this.#t){this.#r?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#r?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#r;if(!e){this.#r=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const r=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#r?.classList.remove("show")},{signal:o})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getImageForAltText()?.setAttribute("aria-describedby",e.id)}}class fa{#t;#e=!1;#n=null;#i;#r;#s;#l;#o;#c=null;#u;#d=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:s=null,onPinchStart:r=null,onPinching:o=null,onPinchEnd:l=null,signal:u}){this.#t=t,this.#n=s,this.#i=e,this.#r=r,this.#s=o,this.#l=l,this.#u=new AbortController,this.#o=AbortSignal.any([u,this.#u.signal]),t.addEventListener("touchstart",this.#h.bind(this),{passive:!1,signal:this.#o})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return _t(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}#h(t){if(this.#i?.()||t.touches.length<2)return;if(!this.#d){this.#d=new AbortController;const r=AbortSignal.any([this.#o,this.#d.signal]),o=this.#t,l={signal:r,passive:!1};o.addEventListener("touchmove",this.#f.bind(this),l),o.addEventListener("touchend",this.#a.bind(this),l),o.addEventListener("touchcancel",this.#a.bind(this),l),this.#r?.()}if(Re(t),t.touches.length!==2||this.#n?.()){this.#c=null;return}let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]),this.#c={touch0X:e.screenX,touch0Y:e.screenY,touch1X:s.screenX,touch1Y:s.screenY}}#f(t){if(!this.#c||t.touches.length!==2)return;let[e,s]=t.touches;e.identifier>s.identifier&&([e,s]=[s,e]);const{screenX:r,screenY:o}=e,{screenX:l,screenY:u}=s,h=this.#c,{touch0X:f,touch0Y:p,touch1X:v,touch1Y:y}=h,w=v-f,_=y-p,S=l-r,x=u-o,E=Math.hypot(S,x)||1,M=Math.hypot(w,_)||1;if(!this.#e&&Math.abs(M-E)<=fa.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=o,h.touch1X=l,h.touch1Y=u,t.preventDefault(),!this.#e){this.#e=!0;return}const P=[(r+l)/2,(o+u)/2];this.#s?.(P,M,E)}#a(t){this.#d.abort(),this.#d=null,this.#l?.(),this.#c&&(t.preventDefault(),this.#c=null,this.#e=!1)}destroy(){this.#u?.abort(),this.#u=null}}class ut{#t=null;#e=null;#n=null;#i=!1;#r=null;#s="";#l=!1;#o=null;#c=null;#u=null;#d=null;#h="";#f=!1;#a=null;#p=!1;#m=!1;#g=!1;#v=null;#A=0;#y=0;#_=null;#b=null;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#x=!1;#k=ut._zIndex++;static _borderLineWidth=-1;static _colorManager=new jl;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=ut.prototype._resizeWithKeyboard,e=On.TRANSLATE_SMALL,s=On.TRANSLATE_BIG;return _t(this,"_resizerKeyboardManager",new Fs([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-s,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[s,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-s]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,s]}],[["Escape","mac+Escape"],ut.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:s,pageHeight:r,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[s,r],this.pageTranslation=[o,l];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return _t(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new Rg({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(ut._l10n??=t,ut._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),ut._borderLineWidth!==-1)return;const s=getComputedStyle(document.documentElement);ut._borderLineWidth=parseFloat(s.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Rt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#x}set _isDraggable(t){this.#x=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#k}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#j(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,s,r){const[o,l]=this.parentDimensions;[s,r]=this.screenToPageTranslation(s,r),this.x=(t+s)/o,this.y=(e+r)/l,this.fixAndSetPosition()}#P([t,e],s,r){[s,r]=this.screenToPageTranslation(s,r),this.x+=s/t,this.y+=r/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#P(this.parentDimensions,t,e)}translateInPage(t,e){this.#a||=[this.x,this.y,this.width,this.height],this.#P(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){this.#a||=[this.x,this.y,this.width,this.height];const{div:s,parentDimensions:[r,o]}=this;if(this.x+=t/r,this.y+=e/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:v,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,v,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:u}=this;const[h,f]=this.getBaseTranslation();l+=h,u+=f;const{style:p}=s;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(l,u),s.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#a&&(this.#a[0]!==this.x||this.#a[1]!==this.y)}get _hasBeenResized(){return!!this.#a&&(this.#a[2]!==this.width||this.#a[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:s}=ut,r=s/t,o=s/e;switch(this.rotation){case 90:return[-r,o];case 180:return[r,o];case 270:return[r,-o];default:return[-r,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[s,r]}=this;let{x:o,y:l,width:u,height:h}=this;if(u*=s,h*=r,o*=s,l*=r,this._mustFixPosition)switch(t){case 0:o=Math.max(0,Math.min(s-u,o)),l=Math.max(0,Math.min(r-h,l));break;case 90:o=Math.max(0,Math.min(s-h,o)),l=Math.min(r,Math.max(u,l));break;case 180:o=Math.min(s,Math.max(u,o)),l=Math.min(r,Math.max(h,l));break;case 270:o=Math.min(s,Math.max(h,o)),l=Math.max(0,Math.min(r-u,l));break}this.x=o/=s,this.y=l/=r;const[f,p]=this.getBaseTranslation();o+=f,l+=p,e.left=`${(100*o).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#S(t,e,s){switch(s){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return ut.#S(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return ut.#S(t,e,360-this.parentRotation)}#T(t){switch(t){case 90:{const[e,s]=this.pageDimensions;return[0,-e/s,s/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,s]=this.pageDimensions;return[0,e/s,-s/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,s]}=this;return[e*t,s*t]}setDims(t,e){const[s,r]=this.parentDimensions,{style:o}=this.div;o.width=`${(100*t/s).toFixed(2)}%`,this.#l||(o.height=`${(100*e/r).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:s}=t,r=s.endsWith("%"),o=!this.#l&&e.endsWith("%");if(r&&o)return;const[l,u]=this.parentDimensions;r||(t.width=`${(100*parseFloat(s)/l).toFixed(2)}%`),!this.#l&&!o&&(t.height=`${(100*parseFloat(e)/u).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#C(){if(this.#o)return;this.#o=document.createElement("div"),this.#o.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const s of t){const r=document.createElement("div");this.#o.append(r),r.classList.add("resizer",s),r.setAttribute("data-resizer-name",s),r.addEventListener("pointerdown",this.#M.bind(this,s),{signal:e}),r.addEventListener("contextmenu",Ye,{signal:e}),r.tabIndex=-1}this.div.prepend(this.#o)}#M(t,e){e.preventDefault();const{isMac:s}=ge.platform;if(e.button!==0||e.ctrlKey&&s)return;this.#n?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#c=[e.screenX,e.screenY];const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#E.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Re,{passive:!1,signal:l}),window.addEventListener("contextmenu",Ye,{signal:l}),this.#u={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#F()};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}#N(t,e,s,r){this.width=s,this.height=r,this.x=t,this.y=e;const[o,l]=this.parentDimensions;this.setDims(o*s,l*r),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#u)return;const{savedX:t,savedY:e,savedWidth:s,savedHeight:r}=this.#u;this.#u=null;const o=this.x,l=this.y,u=this.width,h=this.height;o===t&&l===e&&u===s&&h===r||this.addCommands({cmd:this.#N.bind(this,o,l,u,h),undo:this.#N.bind(this,t,e,s,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#E(t,e){const[s,r]=this.parentDimensions,o=this.x,l=this.y,u=this.width,h=this.height,f=ut.MIN_SIZE/s,p=ut.MIN_SIZE/r,v=this.#T(this.rotation),y=(G,X)=>[v[0]*G+v[2]*X,v[1]*G+v[3]*X],w=this.#T(360-this.rotation),_=(G,X)=>[w[0]*G+w[2]*X,w[1]*G+w[3]*X];let S,x,E=!1,M=!1;switch(t){case"topLeft":E=!0,S=(G,X)=>[0,0],x=(G,X)=>[G,X];break;case"topMiddle":S=(G,X)=>[G/2,0],x=(G,X)=>[G/2,X];break;case"topRight":E=!0,S=(G,X)=>[G,0],x=(G,X)=>[0,X];break;case"middleRight":M=!0,S=(G,X)=>[G,X/2],x=(G,X)=>[0,X/2];break;case"bottomRight":E=!0,S=(G,X)=>[G,X],x=(G,X)=>[0,0];break;case"bottomMiddle":S=(G,X)=>[G/2,X],x=(G,X)=>[G/2,0];break;case"bottomLeft":E=!0,S=(G,X)=>[0,X],x=(G,X)=>[G,0];break;case"middleLeft":M=!0,S=(G,X)=>[0,X/2],x=(G,X)=>[G,X/2];break}const P=S(u,h),N=x(u,h);let D=y(...N);const B=ut._round(o+D[0]),H=ut._round(l+D[1]);let Z=1,it=1,gt,ft;if(e.fromKeyboard)({deltaX:gt,deltaY:ft}=e);else{const{screenX:G,screenY:X}=e,[V,tt]=this.#c;[gt,ft]=this.screenToPageTranslation(G-V,X-tt),this.#c[0]=G,this.#c[1]=X}if([gt,ft]=_(gt/s,ft/r),E){const G=Math.hypot(u,h);Z=it=Math.max(Math.min(Math.hypot(N[0]-P[0]-gt,N[1]-P[1]-ft)/G,1/u,1/h),f/u,p/h)}else M?Z=Math.max(f,Math.min(1,Math.abs(N[0]-P[0]-gt)))/u:it=Math.max(p,Math.min(1,Math.abs(N[1]-P[1]-ft)))/h;const St=ut._round(u*Z),xt=ut._round(h*it);D=y(...x(St,xt));const yt=B-D[0],Mt=H-D[1];this.#a||=[this.x,this.y,this.width,this.height],this.width=St,this.height=xt,this.x=yt,this.y=Mt,this.setDims(s*St,r*xt),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}async addEditToolbar(){return this._editToolbar||this.#m?this._editToolbar:(this._editToolbar=new Ms(this),this.div.append(this._editToolbar.render()),this.#n&&await this._editToolbar.addAltText(this.#n),this._editToolbar)}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){this.#n||(sn.initialize(ut._l10n),this.#n=new sn(this),this.#t&&(this.#n.data=this.#t,this.#t=null),await this.addEditToolbar())}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=this.#i?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),this.#O();const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[s,r]=this.getInitialTranslation();return this.translate(s,r),ra(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#b||=new fa({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#w.bind(this),onPinching:this.#I.bind(this),onPinchEnd:this.#H.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),this.div}#w(){this.#u={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#I(t,e,s){let o=.7*(s/e)+1-.7;if(o===1)return;const l=this.#T(this.rotation),u=(B,H)=>[l[0]*B+l[2]*H,l[1]*B+l[3]*H],[h,f]=this.parentDimensions,p=this.x,v=this.y,y=this.width,w=this.height,_=ut.MIN_SIZE/h,S=ut.MIN_SIZE/f;o=Math.max(Math.min(o,1/y,1/w),_/y,S/w);const x=ut._round(y*o),E=ut._round(w*o);if(x===y&&E===w)return;this.#a||=[p,v,y,w];const M=u(y/2,w/2),P=ut._round(p+M[0]),N=ut._round(v+M[1]),D=u(x/2,E/2);this.x=P-D[0],this.y=N-D[1],this.width=x,this.height=E,this.setDims(h*x,f*E),this.fixAndSetPosition(),this._onResizing()}#H(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:e}=ge.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#$(t);return}this.#U(t)}get isSelected(){return this._uiManager.isSelected(this)}#U(t){const{isMac:e}=ge.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#$(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let s=!1;const r=new AbortController,o=this._uiManager.combinedSignal(r),l={capture:!0,passive:!1,signal:o},u=f=>{r.abort(),this.#r=null,this.#f=!1,this._uiManager.endDragSession()||this.#U(f),s&&this._onStopDragging()};e&&(this.#A=t.clientX,this.#y=t.clientY,this.#r=t.pointerId,this.#s=t.pointerType,window.addEventListener("pointermove",f=>{s||(s=!0,this._onStartDragging());const{clientX:p,clientY:v,pointerId:y}=f;if(y!==this.#r){Re(f);return}const[w,_]=this.screenToPageTranslation(p-this.#A,v-this.#y);this.#A=p,this.#y=v,this._uiManager.dragSelectedEditors(w,_)},l),window.addEventListener("touchmove",Re,l),window.addEventListener("pointerdown",f=>{f.pointerType===this.#s&&(this.#b||f.isPrimary)&&u(f),Re(f)},l));const h=f=>{if(!this.#r||this.#r===f.pointerId){u(f);return}Re(f)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,s){t.changeParent(this),this.x=e,this.y=s,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,s=this.rotation){const r=this.parentScale,[o,l]=this.pageDimensions,[u,h]=this.pageTranslation,f=t/r,p=e/r,v=this.x*o,y=this.y*l,w=this.width*o,_=this.height*l;switch(s){case 0:return[v+f+u,l-y-p-_+h,v+f+w+u,l-y-p+h];case 90:return[v+p+u,l-y+f+h,v+p+_+u,l-y+f+w+h];case 180:return[v-f-w+u,l-y+p+h,v-f+u,l-y+p+_+h];case 270:return[v-p-_+u,l-y-f-w+h,v-p+u,l-y-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[s,r,o,l]=t,u=o-s,h=l-r;switch(this.rotation){case 0:return[s,e-l,u,h];case 90:return[s,e-r,h,u];case 180:return[o,e-r,u,h];case 270:return[o,e-l,h,u];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){this.#m=!0}disableEditMode(){this.#m=!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#g}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:s,right:r}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return e<l&&r>0&&t<o&&s>0}#O(){if(this.#d||!this.div)return;this.#d=new AbortController;const t=this._uiManager.combinedSignal(this.#d);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#O()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){Rt("An editor must be serializable")}static async deserialize(t,e,s){const r=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:s});r.rotation=t.rotation,r.#t=t.accessibilityData;const[o,l]=r.pageDimensions,[u,h,f,p]=r.getRectInCurrentCoords(t.rect,l);return r.x=u/o,r.y=h/l,r.width=f/o,r.height=p/l,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#d?.abort(),this.#d=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#j(),this.removeEditToolbar(),this.#_){for(const t of this.#_.values())clearTimeout(t);this.#_=null}this.parent=null,this.#b?.destroy(),this.#b=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#C(),this.#o.classList.remove("hidden"),ra(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#u={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#o.children;if(!this.#e){this.#e=Array.from(e);const l=this.#D.bind(this),u=this.#z.bind(this),h=this._uiManager._signal;for(const f of this.#e){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",u,{signal:h}),f.addEventListener("focus",this.#V.bind(this,p),{signal:h}),f.setAttribute("data-l10n-id",ut._l10nResizer[p])}}const s=this.#e[0];let r=0;for(const l of e){if(l===s)break;r++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(o!==r){if(o<r)for(let u=0;u<r-o;u++)this.#o.append(this.#o.firstChild);else if(o>r)for(let u=0;u<o-r;u++)this.#o.firstChild.before(this.#o.lastChild);let l=0;for(const u of e){const f=this.#e[l++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",ut._l10nResizer[f])}}this.#L(0),this.#g=!0,this.#o.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#D(t){ut._resizerKeyboardManager.exec(this,t)}#z(t){this.#g&&t.relatedTarget?.parentNode!==this.#o&&this.#j()}#V(t){this.#h=this.#g?t:""}#L(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#g&&this.#E(this.#h,{deltaX:t,deltaY:e,fromKeyboard:!0})}#j(){this.#g=!1,this.#L(-1),this.#F()}_stopResizingWithKeyboard(){this.#j(),this.div.focus()}select(){if(this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}unselect(){this.#o?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#l=!0;const s=t/e,{style:r}=this.div;r.aspectRatio=s,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#_||=new Map;const{action:s}=t;let r=this.#_.get(s);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#_.delete(s),this.#_.size===0&&(this.#_=null)},ut._telemetryTimeout),this.#_.set(s,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#i=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#i=!0}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const s=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),s.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class Rg extends ut{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const sd=3285377520,Oe=4294901760,nn=65535;class xd{constructor(t){this.h1=t?t&4294967295:sd,this.h2=t?t&4294967295:sd}update(t){let e,s;if(typeof t=="string"){e=new Uint8Array(t.length*2),s=0;for(let S=0,x=t.length;S<x;S++){const E=t.charCodeAt(S);E<=255?e[s++]=E:(e[s++]=E>>>8,e[s++]=E&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),s=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=s>>2,o=s-r*4,l=new Uint32Array(e.buffer,0,r);let u=0,h=0,f=this.h1,p=this.h2;const v=3432918353,y=461845907,w=v&nn,_=y&nn;for(let S=0;S<r;S++)S&1?(u=l[S],u=u*v&Oe|u*w&nn,u=u<<15|u>>>17,u=u*y&Oe|u*_&nn,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[S],h=h*v&Oe|h*w&nn,h=h<<15|h>>>17,h=h*y&Oe|h*_&nn,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,o){case 3:u^=e[r*4+2]<<16;case 2:u^=e[r*4+1]<<8;case 1:u^=e[r*4],u=u*v&Oe|u*w&nn,u=u<<15|u>>>17,u=u*y&Oe|u*_&nn,r&1?f^=u:p^=u}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Oe|t*36045&nn,e=e*4283543511&Oe|((e<<16|t>>>16)*2950163797&Oe)>>>16,t^=e>>>1,t=t*444984403&Oe|t*60499&nn,e=e*3301882366&Oe|((e<<16|t>>>16)*3120437893&Oe)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const kl=Object.freeze({map:null,hash:"",transfer:void 0});class Bl{#t=!1;#e=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const s=this.#n.get(t);return s===void 0?e:Object.assign(e,s)}getRawValue(t){return this.#n.get(t)}remove(t){if(this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#n.values())if(e instanceof ut)return;this.onAnnotationEditor(null)}}setValue(t,e){const s=this.#n.get(t);let r=!1;if(s!==void 0)for(const[o,l]of Object.entries(e))s[o]!==l&&(r=!0,s[o]=l);else r=!0,this.#n.set(t,e);r&&this.#i(),e instanceof ut&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#n.has(t)}getAll(){return this.#n.size>0?Il(this.#n):null}setAll(t){for(const[e,s]of Object.entries(t))this.setValue(e,s)}get size(){return this.#n.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Cd(this)}get serializable(){if(this.#n.size===0)return kl;const t=new Map,e=new xd,s=[],r=Object.create(null);let o=!1;for(const[l,u]of this.#n){const h=u instanceof ut?u.serialize(!1,r):u;h&&(t.set(l,h),e.update(`${l}:${JSON.stringify(h)}`),o||=!!h.bitmap)}if(o)for(const l of t.values())l.bitmap&&s.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:s}:kl}get editorStats(){let t=null;const e=new Map;for(const s of this.#n.values()){if(!(s instanceof ut))continue;const r=s.telemetryFinalData;if(!r)continue;const{type:o}=r;e.has(o)||e.set(o,Object.getPrototypeOf(s).constructor),t||=Object.create(null);const l=t[o]||=new Map;for(const[u,h]of Object.entries(r)){if(u==="type")continue;let f=l.get(u);f||(f=new Map,l.set(u,f));const p=f.get(h)??0;f.set(h,p+1)}}for(const[s,r]of e)t[s]=r.computeTelemetryFinalData(t[s]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#n.values())!(e instanceof ut)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}}class Cd extends Bl{#t;constructor(t){super();const{map:e,hash:s,transfer:r}=t.serializable,o=structuredClone(e,r?{transfer:r}:null);this.#t={map:o,hash:s,transfer:r}}get print(){Rt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return _t(this,"modifiedIds",{ids:new Set,hash:""})}}class Mg{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||this.#t.has(t.loadedName))){if(Xt(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:r,style:o}=t,l=new FontFace(s,r,o);this.addNativeFontFace(l);try{await l.load(),this.#t.add(s),e?.(t)}catch{vt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}Rt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const s=t.createNativeFontFace();if(s){this.addNativeFontFace(s);try{await s.loaded}catch(r){throw vt(`Failed to load font '${s.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const r=this._queueLoadingCallback(s);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return _t(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(ue||typeof navigator<"u"&&typeof navigator?.userAgent=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),_t(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(Xt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;s.length>0&&s[0].done;){const o=s.shift();setTimeout(o.callback,0)}}const{loadingRequests:s}=this,r={done:!1,complete:e,callback:t};return s.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return _t(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function s(N,D){return N.charCodeAt(D)<<24|N.charCodeAt(D+1)<<16|N.charCodeAt(D+2)<<8|N.charCodeAt(D+3)&255}function r(N,D,B,H){const Z=N.substring(0,D),it=N.substring(D+B);return Z+H+it}let o,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let f=0;function p(N,D){if(++f>30){vt("Load test font never loaded."),D();return}if(h.font="30px "+N,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(p.bind(null,N,D))}const v=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=r(y,976,v.length,v);const _=16,S=1482184792;let x=s(y,_);for(o=0,l=v.length-3;o<l;o+=4)x=x-S+s(v,o)|0;o<v.length&&(x=x-S+s(v+"XXX",o)|0),y=r(y,_,4,mg(x));const E=`url(data:font/opentype;base64,${btoa(y)});`,M=`@font-face {font-family:"${v}";src:${E}}`;this.insertRule(M);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const N of[t.loadedName,v]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=N,P.append(D)}this._document.body.append(P),p(v,()=>{P.remove(),e.complete()})}}class Lg{constructor(t,{disableFontFace:e=!1,fontExtraProperties:s=!1,inspectFont:r=null}){this.compiledGlyphs=Object.create(null);for(const o in t)this[o]=t[o];this.disableFontFace=e===!0,this.fontExtraProperties=s===!0,this._inspectFont=r}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Sg(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const s=this.loadedName+"_path_"+e;let r;try{r=t.get(s)}catch(l){vt(`getPathGenerator - ignoring character: "${l}".`)}const o=new Path2D(r||"");return this.fontExtraProperties||t.delete(s),this.compiledGlyphs[e]=o}}const Kr={DATA:1,ERROR:2},Wt={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function rd(){}function be(g){if(g instanceof Fn||g instanceof xl||g instanceof Is||g instanceof ed||g instanceof sa||g instanceof yl)return g;switch(g instanceof Error||typeof g=="object"&&g!==null||Rt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),g.name){case"AbortException":return new Fn(g.message);case"InvalidPDFException":return new xl(g.message);case"MissingPDFException":return new Is(g.message);case"PasswordException":return new ed(g.message,g.code);case"UnexpectedResponseException":return new sa(g.message,g.status);case"UnknownErrorException":return new yl(g.message,g.details)}return new yl(g.message,g.toString())}class Ps{#t=new AbortController;constructor(t,e,s){this.sourceName=t,this.targetName=e,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),s.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const s=t.callbackId,r=this.callbackCapabilities[s];if(!r)throw new Error(`Cannot resolve callback ${s}`);if(delete this.callbackCapabilities[s],t.callback===Kr.DATA)r.resolve(t.data);else if(t.callback===Kr.ERROR)r.reject(be(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const s=this.sourceName,r=t.sourceName,o=this.comObj;Promise.try(e,t.data).then(function(l){o.postMessage({sourceName:s,targetName:r,callback:Kr.DATA,callbackId:t.callbackId,data:l})},function(l){o.postMessage({sourceName:s,targetName:r,callback:Kr.ERROR,callbackId:t.callbackId,reason:be(l)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const s=this.actionHandler;if(s[t])throw new Error(`There is already an actionName called "${t}"`);s[t]=e}send(t,e,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},s)}sendWithPromise(t,e,s){const r=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[r]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:e},s)}catch(l){o.reject(l)}return o.promise}sendWithStream(t,e,s,r){const o=this.streamId++,l=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:u,action:t,streamId:o,data:e,desiredSize:f.desiredSize},r),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[o].pullCall=p,h.postMessage({sourceName:l,targetName:u,stream:Wt.PULL,streamId:o,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Xt(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[o].cancelCall=p,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:l,targetName:u,stream:Wt.CANCEL,streamId:o,reason:be(f)}),p.promise}},s)}#n(t){const e=t.streamId,s=this.sourceName,r=t.sourceName,o=this.comObj,l=this,u=this.actionHandler[t.action],h={enqueue(f,p=1,v){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=p,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:s,targetName:r,stream:Wt.ENQUEUE,streamId:e,chunk:f},v)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:r,stream:Wt.CLOSE,streamId:e}),delete l.streamSinks[e])},error(f){Xt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:s,targetName:r,stream:Wt.ERROR,streamId:e,reason:be(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(u,t.data,h).then(function(){o.postMessage({sourceName:s,targetName:r,stream:Wt.START_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:s,targetName:r,stream:Wt.START_COMPLETE,streamId:e,reason:be(f)})})}#i(t){const e=t.streamId,s=this.sourceName,r=t.sourceName,o=this.comObj,l=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case Wt.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(be(t.reason));break;case Wt.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(be(t.reason));break;case Wt.PULL:if(!u){o.postMessage({sourceName:s,targetName:r,stream:Wt.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||rd).then(function(){o.postMessage({sourceName:s,targetName:r,stream:Wt.PULL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:s,targetName:r,stream:Wt.PULL_COMPLETE,streamId:e,reason:be(f)})});break;case Wt.ENQUEUE:if(Xt(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case Wt.CLOSE:if(Xt(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#r(l,e);break;case Wt.ERROR:Xt(l,"error should have stream controller"),l.controller.error(be(t.reason)),this.#r(l,e);break;case Wt.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(be(t.reason)),this.#r(l,e);break;case Wt.CANCEL:if(!u)break;const h=be(t.reason);Promise.try(u.onCancel||rd,h).then(function(){o.postMessage({sourceName:s,targetName:r,stream:Wt.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:s,targetName:r,stream:Wt.CANCEL_COMPLETE,streamId:e,reason:be(f)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#r(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class kd{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(t,e);return{canvas:s,context:s.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,s){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||s<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=s}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Rt("Abstract method `_createCanvas` called.")}}class Ig extends kd{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const s=this._document.createElement("canvas");return s.width=t,s.height=e,s}}class Td{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(s=>({cMapData:s,isCompressed:this.isCompressed})).catch(s=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Rt("Abstract method `_fetch` called.")}}class Pd extends Td{async _fetch(t){const e=await ha(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):ca(e)}}class Rd{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,s,r,o){return"none"}destroy(t=!1){}}class Ng extends Rd{#t;#e;#n;#i;#r;#s;#l=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#r=e}get#o(){return this.#e||=new Map}get#c(){return this.#s||=new Map}get#u(){if(!this.#n){const t=this.#r.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const s=this.#r.createElementNS(fn,"svg");s.setAttribute("width",0),s.setAttribute("height",0),this.#n=this.#r.createElementNS(fn,"defs"),t.append(s),s.append(this.#n),this.#r.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],f=new Array(256);for(let v=0;v<256;v++)f[v]=h[v]/255;const p=f.join(",");return[p,p,p]}const[e,s,r]=t,o=new Array(256),l=new Array(256),u=new Array(256);for(let h=0;h<256;h++)o[h]=e[h]/255,l[h]=s[h]/255,u[h]=r[h]/255;return[o.join(","),l.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#r.URL;e!==this.#r.baseURI&&(da(e)?vt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=e.split("#",1)[0])}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[s,r,o]=this.#d(t),l=t.length===1?s:`${s}${r}${o}`;if(e=this.#o.get(l),e)return this.#o.set(t,e),e;const u=`g_${this.#i}_transfer_map_${this.#l++}`,h=this.#h(u);this.#o.set(t,h),this.#o.set(l,h);const f=this.#p(u);return this.#g(s,r,o,f),h}addHCMFilter(t,e){const s=`${t}-${e}`,r="base";let o=this.#c.get(r);if(o?.key===s||(o?(o.filter?.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},this.#c.set(r,o)),!t||!e))return o.url;const l=this.#A(t);t=st.makeHexColor(...l);const u=this.#A(e);if(e=st.makeHexColor(...u),this.#u.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return o.url;const h=new Array(256);for(let w=0;w<=255;w++){const _=w/255;h[w]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const f=h.join(","),p=`g_${this.#i}_hcm_filter`,v=o.filter=this.#p(p);this.#g(f,f,f,v),this.#a(v);const y=(w,_)=>{const S=l[w]/255,x=u[w]/255,E=new Array(_+1);for(let M=0;M<=_;M++)E[M]=S+M/_*(x-S);return E.join(",")};return this.#g(y(0,5),y(1,5),y(2,5),v),o.url=this.#h(p),o.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[s]=this.#d([t]),r=`alpha_${s}`;if(e=this.#o.get(r),e)return this.#o.set(t,e),e;const o=`g_${this.#i}_alpha_map_${this.#l++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(r,l);const u=this.#p(o);return this.#v(s,u),l}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let s,r;if(t?([s]=this.#d([t]),r=`luminosity_${s}`):r="luminosity",e=this.#o.get(r),e)return this.#o.set(t,e),e;const o=`g_${this.#i}_luminosity_map_${this.#l++}`,l=this.#h(o);this.#o.set(t,l),this.#o.set(r,l);const u=this.#p(o);return this.#f(u),t&&this.#v(s,u),l}addHighlightHCMFilter(t,e,s,r,o){const l=`${e}-${s}-${r}-${o}`;let u=this.#c.get(t);if(u?.key===l||(u?(u.filter?.remove(),u.key=l,u.url="none",u.filter=null):(u={key:l,url:"none",filter:null},this.#c.set(t,u)),!e||!s))return u.url;const[h,f]=[e,s].map(this.#A.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),v=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[y,w]=[r,o].map(this.#A.bind(this));v<p&&([p,v,y,w]=[v,p,w,y]),this.#u.style.color="";const _=(E,M,P)=>{const N=new Array(256),D=(v-p)/P,B=E/255,H=(M-E)/(255*P);let Z=0;for(let it=0;it<=P;it++){const gt=Math.round(p+it*D),ft=B+it*H;for(let St=Z;St<=gt;St++)N[St]=ft;Z=gt+1}for(let it=Z;it<256;it++)N[it]=N[Z-1];return N.join(",")},S=`g_${this.#i}_hcm_${t}_filter`,x=u.filter=this.#p(S);return this.#a(x),this.#g(_(y[0],w[0],5),_(y[1],w[1],5),_(y[2],w[2],5),x),u.url=this.#h(S),u.url}destroy(t=!1){t&&this.#s?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#s?.clear(),this.#s=null,this.#l=0)}#f(t){const e=this.#r.createElementNS(fn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#a(t){const e=this.#r.createElementNS(fn,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#r.createElementNS(fn,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#u.append(e),e}#m(t,e,s){const r=this.#r.createElementNS(fn,e);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)}#g(t,e,s,r){const o=this.#r.createElementNS(fn,"feComponentTransfer");r.append(o),this.#m(o,"feFuncR",t),this.#m(o,"feFuncG",e),this.#m(o,"feFuncB",s)}#v(t,e){const s=this.#r.createElementNS(fn,"feComponentTransfer");e.append(s),this.#m(s,"feFuncA",t)}#A(t){return this.#u.style.color=t,Ol(getComputedStyle(this.#u).getPropertyValue("color"))}}class Md{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(s=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Rt("Abstract method `_fetch` called.")}}class Ld extends Md{async _fetch(t){const e=await ha(t,"arraybuffer");return new Uint8Array(e)}}ue&&vt("Please use the `legacy` build in Node.js environments.");async function Id(g){const e=await process.getBuiltinModule("fs").promises.readFile(g);return new Uint8Array(e)}class Dg extends Rd{}class Fg extends kd{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class Og extends Td{async _fetch(t){return Id(t)}}class zg extends Md{async _fetch(t){return Id(t)}}const le={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Tl(g,t){if(!t)return;const e=t[2]-t[0],s=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],e,s),g.clip(r)}class Hl{getPattern(){Rt("Abstract method `getPattern` called.")}}class jg extends Hl{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const s of this._colorStops)e.addColorStop(s[0],s[1]);return e}getPattern(t,e,s,r){let o;if(r===le.STROKE||r===le.FILL){const l=e.current.getClippedPathBoundingBox(r,Ot(t))||[0,0,0,0],u=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,h),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),s=st.transform(s,[1,0,0,1,l[0],l[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),Tl(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),o=t.createPattern(f.canvas,"no-repeat");const v=new DOMMatrix(s);o.setTransform(v)}else Tl(t,this._bbox),o=this._createGradient(t);return o}}function _l(g,t,e,s,r,o,l,u){const h=t.coords,f=t.colors,p=g.data,v=g.width*4;let y;h[e+1]>h[s+1]&&(y=e,e=s,s=y,y=o,o=l,l=y),h[s+1]>h[r+1]&&(y=s,s=r,r=y,y=l,l=u,u=y),h[e+1]>h[s+1]&&(y=e,e=s,s=y,y=o,o=l,l=y);const w=(h[e]+t.offsetX)*t.scaleX,_=(h[e+1]+t.offsetY)*t.scaleY,S=(h[s]+t.offsetX)*t.scaleX,x=(h[s+1]+t.offsetY)*t.scaleY,E=(h[r]+t.offsetX)*t.scaleX,M=(h[r+1]+t.offsetY)*t.scaleY;if(_>=M)return;const P=f[o],N=f[o+1],D=f[o+2],B=f[l],H=f[l+1],Z=f[l+2],it=f[u],gt=f[u+1],ft=f[u+2],St=Math.round(_),xt=Math.round(M);let yt,Mt,G,X,V,tt,W,T;for(let F=St;F<=xt;F++){if(F<x){const ot=F<_?0:(_-F)/(_-x);yt=w-(w-S)*ot,Mt=P-(P-B)*ot,G=N-(N-H)*ot,X=D-(D-Z)*ot}else{let ot;F>M?ot=1:x===M?ot=0:ot=(x-F)/(x-M),yt=S-(S-E)*ot,Mt=B-(B-it)*ot,G=H-(H-gt)*ot,X=Z-(Z-ft)*ot}let nt;F<_?nt=0:F>M?nt=1:nt=(_-F)/(_-M),V=w-(w-E)*nt,tt=P-(P-it)*nt,W=N-(N-gt)*nt,T=D-(D-ft)*nt;const pt=Math.round(Math.min(yt,V)),wt=Math.round(Math.max(yt,V));let ct=v*F+pt*4;for(let ot=pt;ot<=wt;ot++)nt=(yt-ot)/(yt-V),nt<0?nt=0:nt>1&&(nt=1),p[ct++]=Mt-(Mt-tt)*nt|0,p[ct++]=G-(G-W)*nt|0,p[ct++]=X-(X-T)*nt|0,p[ct++]=255}}function Bg(g,t,e){const s=t.coords,r=t.colors;let o,l;switch(t.type){case"lattice":const u=t.verticesPerRow,h=Math.floor(s.length/u)-1,f=u-1;for(o=0;o<h;o++){let p=o*u;for(let v=0;v<f;v++,p++)_l(g,e,s[p],s[p+1],s[p+u],r[p],r[p+1],r[p+u]),_l(g,e,s[p+u+1],s[p+1],s[p+u],r[p+u+1],r[p+1],r[p+u])}break;case"triangles":for(o=0,l=s.length;o<l;o+=3)_l(g,e,s[o],s[o+1],s[o+2],r[o],r[o+1],r[o+2]);break;default:throw new Error("illegal figure")}}class Hg extends Hl{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,s){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-h,v=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),w=f/v,_=p/y,S={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/w,scaleY:1/_},x=v+4,E=y+4,M=s.getCanvas("mesh",x,E),P=M.context,N=P.createImageData(v,y);if(e){const B=N.data;for(let H=0,Z=B.length;H<Z;H+=4)B[H]=e[0],B[H+1]=e[1],B[H+2]=e[2],B[H+3]=255}for(const B of this._figures)Bg(N,B,S);return P.putImageData(N,2,2),{canvas:M.canvas,offsetX:u-2*w,offsetY:h-2*_,scaleX:w,scaleY:_}}getPattern(t,e,s,r){Tl(t,this._bbox);let o;if(r===le.SHADING)o=st.singularValueDecompose2dScale(Ot(t));else if(o=st.singularValueDecompose2dScale(e.baseTransform),this.matrix){const u=st.singularValueDecompose2dScale(this.matrix);o=[o[0]*u[0],o[1]*u[1]]}const l=this._createMeshCanvas(o,r===le.SHADING?null:this._background,e.cachedCanvases);return r!==le.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class Ug extends Hl{getPattern(){return"hotpink"}}function $g(g){switch(g[0]){case"RadialAxial":return new jg(g);case"Mesh":return new Hg(g);case"Dummy":return new Ug}throw new Error(`Unknown IR type: ${g[0]}`)}const ad={COLORED:1,UNCOLORED:2};class Ul{static MAX_PATTERN_SIZE=3e3;constructor(t,e,s,r,o){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=s,this.canvasGraphicsFactory=r,this.baseTransform=o}createPatternCanvas(t){const{bbox:e,operatorList:s,paintType:r,tilingType:o,color:l,canvasGraphicsFactory:u}=this;let{xstep:h,ystep:f}=this;h=Math.abs(h),f=Math.abs(f),ua("TilingType: "+o);const p=e[0],v=e[1],y=e[2],w=e[3],_=y-p,S=w-v,x=st.singularValueDecompose2dScale(this.matrix),E=st.singularValueDecompose2dScale(this.baseTransform),M=x[0]*E[0],P=x[1]*E[1];let N=_,D=S,B=!1,H=!1;const Z=Math.ceil(h*M),it=Math.ceil(f*P),gt=Math.ceil(_*M),ft=Math.ceil(S*P);Z>=gt?N=h:B=!0,it>=ft?D=f:H=!0;const St=this.getSizeAndScale(N,this.ctx.canvas.width,M),xt=this.getSizeAndScale(D,this.ctx.canvas.height,P),yt=t.cachedCanvases.getCanvas("pattern",St.size,xt.size),Mt=yt.context,G=u.createCanvasGraphics(Mt);if(G.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(G,r,l),Mt.translate(-St.scale*p,-xt.scale*v),G.transform(St.scale,0,0,xt.scale,0,0),Mt.save(),this.clipBbox(G,p,v,y,w),G.baseTransform=Ot(G.ctx),G.executeOperatorList(s),G.endDrawing(),Mt.restore(),B||H){const X=yt.canvas;B&&(N=h),H&&(D=f);const V=this.getSizeAndScale(N,this.ctx.canvas.width,M),tt=this.getSizeAndScale(D,this.ctx.canvas.height,P),W=V.size,T=tt.size,F=t.cachedCanvases.getCanvas("pattern-workaround",W,T),nt=F.context,pt=B?Math.floor(_/h):0,wt=H?Math.floor(S/f):0;for(let ct=0;ct<=pt;ct++)for(let ot=0;ot<=wt;ot++)nt.drawImage(X,W*ct,T*ot,W,T,0,0,W,T);return{canvas:F.canvas,scaleX:V.scale,scaleY:tt.scale,offsetX:p,offsetY:v}}return{canvas:yt.canvas,scaleX:St.scale,scaleY:xt.scale,offsetX:p,offsetY:v}}getSizeAndScale(t,e,s){const r=Math.max(Ul.MAX_PATTERN_SIZE,e);let o=Math.ceil(t*s);return o>=r?o=r:s=o/t,{scale:s,size:o}}clipBbox(t,e,s,r,o){const l=r-e,u=o-s;t.ctx.rect(e,s,l,u),t.current.updateRectMinMax(Ot(t.ctx),[e,s,r,o]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,s){const r=t.ctx,o=t.current;switch(e){case ad.COLORED:const l=this.ctx;r.fillStyle=l.fillStyle,r.strokeStyle=l.strokeStyle,o.fillColor=l.fillStyle,o.strokeColor=l.strokeStyle;break;case ad.UNCOLORED:const u=st.makeHexColor(s[0],s[1],s[2]);r.fillStyle=u,r.strokeStyle=u,o.fillColor=u,o.strokeColor=u;break;default:throw new gg(`Unsupported paint type: ${e}`)}}getPattern(t,e,s,r){let o=s;r!==le.SHADING&&(o=st.transform(o,e.baseTransform),this.matrix&&(o=st.transform(o,this.matrix)));const l=this.createPatternCanvas(e);let u=new DOMMatrix(o);u=u.translate(l.offsetX,l.offsetY),u=u.scale(1/l.scaleX,1/l.scaleY);const h=t.createPattern(l.canvas,"repeat");return h.setTransform(u),h}}function Vg({src:g,srcPos:t=0,dest:e,width:s,height:r,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const u=ge.isLittleEndian?4278190080:255,[h,f]=l?[o,u]:[u,o],p=s>>3,v=s&7,y=g.length;e=new Uint32Array(e.buffer);let w=0;for(let _=0;_<r;_++){for(const x=t+p;t<x;t++){const E=t<y?g[t]:255;e[w++]=E&128?f:h,e[w++]=E&64?f:h,e[w++]=E&32?f:h,e[w++]=E&16?f:h,e[w++]=E&8?f:h,e[w++]=E&4?f:h,e[w++]=E&2?f:h,e[w++]=E&1?f:h}if(v===0)continue;const S=t<y?g[t++]:255;for(let x=0;x<v;x++)e[w++]=S&1<<7-x?f:h}return{srcPos:t,destPos:w}}const od=16,ld=100,Gg=15,ud=10,cd=1e3,Ee=16;function Wg(g,t){if(g._removeMirroring)throw new Error("Context is already forwarding operations.");g.__originalSave=g.save,g.__originalRestore=g.restore,g.__originalRotate=g.rotate,g.__originalScale=g.scale,g.__originalTranslate=g.translate,g.__originalTransform=g.transform,g.__originalSetTransform=g.setTransform,g.__originalResetTransform=g.resetTransform,g.__originalClip=g.clip,g.__originalMoveTo=g.moveTo,g.__originalLineTo=g.lineTo,g.__originalBezierCurveTo=g.bezierCurveTo,g.__originalRect=g.rect,g.__originalClosePath=g.closePath,g.__originalBeginPath=g.beginPath,g._removeMirroring=()=>{g.save=g.__originalSave,g.restore=g.__originalRestore,g.rotate=g.__originalRotate,g.scale=g.__originalScale,g.translate=g.__originalTranslate,g.transform=g.__originalTransform,g.setTransform=g.__originalSetTransform,g.resetTransform=g.__originalResetTransform,g.clip=g.__originalClip,g.moveTo=g.__originalMoveTo,g.lineTo=g.__originalLineTo,g.bezierCurveTo=g.__originalBezierCurveTo,g.rect=g.__originalRect,g.closePath=g.__originalClosePath,g.beginPath=g.__originalBeginPath,delete g._removeMirroring},g.save=function(){t.save(),this.__originalSave()},g.restore=function(){t.restore(),this.__originalRestore()},g.translate=function(s,r){t.translate(s,r),this.__originalTranslate(s,r)},g.scale=function(s,r){t.scale(s,r),this.__originalScale(s,r)},g.transform=function(s,r,o,l,u,h){t.transform(s,r,o,l,u,h),this.__originalTransform(s,r,o,l,u,h)},g.setTransform=function(s,r,o,l,u,h){t.setTransform(s,r,o,l,u,h),this.__originalSetTransform(s,r,o,l,u,h)},g.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},g.rotate=function(s){t.rotate(s),this.__originalRotate(s)},g.clip=function(s){t.clip(s),this.__originalClip(s)},g.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},g.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},g.bezierCurveTo=function(e,s,r,o,l,u){t.bezierCurveTo(e,s,r,o,l,u),this.__originalBezierCurveTo(e,s,r,o,l,u)},g.rect=function(e,s,r,o){t.rect(e,s,r,o),this.__originalRect(e,s,r,o)},g.closePath=function(){t.closePath(),this.__originalClosePath()},g.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class Xg{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,s){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,e,s)):(r=this.canvasFactory.create(e,s),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Qr(g,t,e,s,r,o,l,u,h,f){const[p,v,y,w,_,S]=Ot(g);if(v===0&&y===0){const M=l*p+_,P=Math.round(M),N=u*w+S,D=Math.round(N),B=(l+h)*p+_,H=Math.abs(Math.round(B)-P)||1,Z=(u+f)*w+S,it=Math.abs(Math.round(Z)-D)||1;return g.setTransform(Math.sign(p),0,0,Math.sign(w),P,D),g.drawImage(t,e,s,r,o,0,0,H,it),g.setTransform(p,v,y,w,_,S),[H,it]}if(p===0&&w===0){const M=u*y+_,P=Math.round(M),N=l*v+S,D=Math.round(N),B=(u+f)*y+_,H=Math.abs(Math.round(B)-P)||1,Z=(l+h)*v+S,it=Math.abs(Math.round(Z)-D)||1;return g.setTransform(0,Math.sign(v),Math.sign(y),0,P,D),g.drawImage(t,e,s,r,o,0,0,it,H),g.setTransform(p,v,y,w,_,S),[it,H]}g.drawImage(t,e,s,r,o,l,u,h,f);const x=Math.hypot(p,v),E=Math.hypot(y,w);return[x*h,E*f]}function qg(g){const{width:t,height:e}=g;if(t>cd||e>cd)return null;const s=1e3,r=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),o=t+1;let l=new Uint8Array(o*(e+1)),u,h,f;const p=t+7&-8;let v=new Uint8Array(p*e),y=0;for(const E of g.data){let M=128;for(;M>0;)v[y++]=E&M?0:255,M>>=1}let w=0;for(y=0,v[y]!==0&&(l[0]=1,++w),h=1;h<t;h++)v[y]!==v[y+1]&&(l[h]=v[y]?2:1,++w),y++;for(v[y]!==0&&(l[h]=2,++w),u=1;u<e;u++){y=u*p,f=u*o,v[y-p]!==v[y]&&(l[f]=v[y]?1:8,++w);let E=(v[y]?4:0)+(v[y-p]?8:0);for(h=1;h<t;h++)E=(E>>2)+(v[y+1]?4:0)+(v[y-p+1]?8:0),r[E]&&(l[f+h]=r[E],++w),y++;if(v[y-p]!==v[y]&&(l[f+h]=v[y]?2:4,++w),w>s)return null}for(y=p*(e-1),f=u*o,v[y]!==0&&(l[f]=8,++w),h=1;h<t;h++)v[y]!==v[y+1]&&(l[f+h]=v[y]?4:8,++w),y++;if(v[y]!==0&&(l[f+h]=4,++w),w>s)return null;const _=new Int32Array([0,o,-1,0,-o,0,0,0,1]),S=new Path2D;for(u=0;w&&u<=e;u++){let E=u*o;const M=E+t;for(;E<M&&!l[E];)E++;if(E===M)continue;S.moveTo(E%o,u);const P=E;let N=l[E];do{const D=_[N];do E+=D;while(!l[E]);const B=l[E];B!==5&&B!==10?(N=B,l[E]=0):(N=B&51*N>>4,l[E]&=N>>2|N<<2),S.lineTo(E%o,E/o|0),l[E]||--w}while(P!==E);--u}return v=null,l=null,function(E){E.save(),E.scale(1/t,-1/e),E.translate(0,-e),E.fill(S),E.beginPath(),E.restore()}}class hd{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Sd,this.textMatrixScale=1,this.fontMatrix=El,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=oe.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,s){[e,s]=st.applyTransform([e,s],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(t,e){const s=st.applyTransform(e,t),r=st.applyTransform(e.slice(2),t),o=st.applyTransform([e[0],e[3]],t),l=st.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,s[0],r[0],o[0],l[0]),this.minY=Math.min(this.minY,s[1],r[1],o[1],l[1]),this.maxX=Math.max(this.maxX,s[0],r[0],o[0],l[0]),this.maxY=Math.max(this.maxY,s[1],r[1],o[1],l[1])}updateScalingPathMinMax(t,e){st.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,s,r,o,l,u,h,f,p){const v=st.bezierBoundingBox(e,s,r,o,l,u,h,f,p);p||this.updateRectMinMax(t,v)}getPathBoundingBox(t=le.FILL,e=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(t===le.STROKE){e||Rt("Stroke bounding box must include transform.");const r=st.singularValueDecompose2dScale(e),o=r[0]*this.lineWidth/2,l=r[1]*this.lineWidth/2;s[0]-=o,s[1]-=l,s[2]+=o,s[3]+=l}return s}updateClipFromPath(){const t=st.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=le.FILL,e=null){return st.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function dd(g,t){if(t instanceof ImageData){g.putImageData(t,0,0);return}const e=t.height,s=t.width,r=e%Ee,o=(e-r)/Ee,l=r===0?o:o+1,u=g.createImageData(s,Ee);let h=0,f;const p=t.data,v=u.data;let y,w,_,S;if(t.kind===ea.GRAYSCALE_1BPP){const x=p.byteLength,E=new Uint32Array(v.buffer,0,v.byteLength>>2),M=E.length,P=s+7>>3,N=4294967295,D=ge.isLittleEndian?4278190080:255;for(y=0;y<l;y++){for(_=y<o?Ee:r,f=0,w=0;w<_;w++){const B=x-h;let H=0;const Z=B>P?s:B*8-7,it=Z&-8;let gt=0,ft=0;for(;H<it;H+=8)ft=p[h++],E[f++]=ft&128?N:D,E[f++]=ft&64?N:D,E[f++]=ft&32?N:D,E[f++]=ft&16?N:D,E[f++]=ft&8?N:D,E[f++]=ft&4?N:D,E[f++]=ft&2?N:D,E[f++]=ft&1?N:D;for(;H<Z;H++)gt===0&&(ft=p[h++],gt=128),E[f++]=ft&gt?N:D,gt>>=1}for(;f<M;)E[f++]=0;g.putImageData(u,0,y*Ee)}}else if(t.kind===ea.RGBA_32BPP){for(w=0,S=s*Ee*4,y=0;y<o;y++)v.set(p.subarray(h,h+S)),h+=S,g.putImageData(u,0,w),w+=Ee;y<l&&(S=s*r*4,v.set(p.subarray(h,h+S)),g.putImageData(u,0,w))}else if(t.kind===ea.RGB_24BPP)for(_=Ee,S=s*_,y=0;y<l;y++){for(y>=o&&(_=r,S=s*_),f=0,w=S;w--;)v[f++]=p[h++],v[f++]=p[h++],v[f++]=p[h++],v[f++]=255;g.putImageData(u,0,y*Ee)}else throw new Error(`bad image kind: ${t.kind}`)}function fd(g,t){if(t.bitmap){g.drawImage(t.bitmap,0,0);return}const e=t.height,s=t.width,r=e%Ee,o=(e-r)/Ee,l=r===0?o:o+1,u=g.createImageData(s,Ee);let h=0;const f=t.data,p=u.data;for(let v=0;v<l;v++){const y=v<o?Ee:r;({srcPos:h}=Vg({src:f,srcPos:h,dest:p,width:s,height:y,nonBlackColor:0})),g.putImageData(u,0,v*Ee)}}function xs(g,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const s of e)g[s]!==void 0&&(t[s]=g[s]);g.setLineDash!==void 0&&(t.setLineDash(g.getLineDash()),t.lineDashOffset=g.lineDashOffset)}function Zr(g){if(g.strokeStyle=g.fillStyle="#000000",g.fillRule="nonzero",g.globalAlpha=1,g.lineWidth=1,g.lineCap="butt",g.lineJoin="miter",g.miterLimit=10,g.globalCompositeOperation="source-over",g.font="10px sans-serif",g.setLineDash!==void 0&&(g.setLineDash([]),g.lineDashOffset=0),!ue){const{filter:t}=g;t!=="none"&&t!==""&&(g.filter="none")}}function pd(g,t){if(t)return!0;const e=st.singularValueDecompose2dScale(g);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const s=Math.fround((globalThis.devicePixelRatio||1)*Fi.PDF_TO_CSS_UNITS);return e[0]<=s&&e[1]<=s}const Yg=["butt","round","square"],Kg=["miter","round","bevel"],Qg={},gd={};class Li{constructor(t,e,s,r,o,{optionalContentConfig:l,markedContentStack:u=null},h,f){this.ctx=t,this.current=new hd(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=s,this.canvasFactory=r,this.filterFactory=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=l,this.cachedCanvases=new Xg(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:s=!1,background:r=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=u,s){const h=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Ot(this.compositeCtx))}this.ctx.save(),Zr(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Ot(this.ctx)}executeOperatorList(t,e,s,r){const o=t.argsArray,l=t.fnArray;let u=e||0;const h=o.length;if(h===u)return u;const f=h-u>ud&&typeof s=="function",p=f?Date.now()+Gg:0;let v=0;const y=this.commonObjs,w=this.objs;let _;for(;;){if(r!==void 0&&u===r.nextBreakPoint)return r.breakIt(u,s),u;if(_=l[u],_!==qe.dependency)this[_].apply(this,o[u]);else for(const S of o[u]){const x=S.startsWith("g_")?y:w;if(!x.has(S))return x.get(S,s),u}if(u++,u===h)return u;if(f&&++v>ud){if(Date.now()>p)return s(),u;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const s=t.width??t.displayWidth,r=t.height??t.displayHeight;let o=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),u=s,h=r,f="prescale1",p,v;for(;o>2&&u>1||l>2&&h>1;){let y=u,w=h;o>2&&u>1&&(y=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),o/=u/y),l>2&&h>1&&(w=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/w),p=this.cachedCanvases.getCanvas(f,y,w),v=p.context,v.clearRect(0,0,y,w),v.drawImage(t,0,0,u,h,0,0,y,w),t=p.canvas,u=y,h=w,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t){const e=this.ctx,{width:s,height:r}=t,o=this.current.fillColor,l=this.current.patternFill,u=Ot(e);let h,f,p,v;if((t.bitmap||t.data)&&t.count>1){const Z=t.bitmap||t.data.buffer;f=JSON.stringify(l?u:[u.slice(0,4),o]),h=this._cachedBitmapsMap.get(Z),h||(h=new Map,this._cachedBitmapsMap.set(Z,h));const it=h.get(f);if(it&&!l){const gt=Math.round(Math.min(u[0],u[2])+u[4]),ft=Math.round(Math.min(u[1],u[3])+u[5]);return{canvas:it,offsetX:gt,offsetY:ft}}p=it}p||(v=this.cachedCanvases.getCanvas("maskCanvas",s,r),fd(v.context,t));let y=st.transform(u,[1/s,0,0,-1/r,0,0]);y=st.transform(y,[1,0,0,1,0,-r]);const[w,_,S,x]=st.getAxialAlignedBoundingBox([0,0,s,r],y),E=Math.round(S-w)||1,M=Math.round(x-_)||1,P=this.cachedCanvases.getCanvas("fillCanvas",E,M),N=P.context,D=w,B=_;N.translate(-D,-B),N.transform(...y),p||(p=this._scaleImage(v.canvas,en(N)),p=p.img,h&&l&&h.set(f,p)),N.imageSmoothingEnabled=pd(Ot(N),t.interpolate),Qr(N,p,0,0,p.width,p.height,0,0,s,r),N.globalCompositeOperation="source-in";const H=st.transform(en(N),[1,0,0,1,-D,-B]);return N.fillStyle=l?o.getPattern(e,this,H,le.FILL):o,N.fillRect(0,0,s,r),h&&!l&&(this.cachedCanvases.delete("fillCanvas"),h.set(f,P.canvas)),{canvas:P.canvas,offsetX:Math.round(D),offsetY:Math.round(B)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=Yg[t]}setLineJoin(t){this.ctx.lineJoin=Kg[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,s]of t)switch(e){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=s;break;case"ca":this.current.fillAlpha=s,this.ctx.globalAlpha=s;break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(s,t,e);this.suspendedCtx=this.ctx,this.ctx=r.context;const o=this.ctx;o.setTransform(...Ot(this.suspendedCtx)),xs(this.suspendedCtx,o),Wg(o,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),xs(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,s=this.suspendedCtx;this.composeSMask(s,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,s,r){const o=r[0],l=r[1],u=r[2]-o,h=r[3]-l;u===0||h===0||(this.genericComposeSMask(e.context,s,u,h,e.subtype,e.backdrop,e.transferMap,o,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(s.canvas,0,0),t.restore())}genericComposeSMask(t,e,s,r,o,l,u,h,f,p,v){let y=t.canvas,w=h-p,_=f-v;if(l){const x=st.makeHexColor(...l);if(w<0||_<0||w+s>y.width||_+r>y.height){const E=this.cachedCanvases.getCanvas("maskExtension",s,r),M=E.context;M.drawImage(y,-w,-_),M.globalCompositeOperation="destination-atop",M.fillStyle=x,M.fillRect(0,0,s,r),M.globalCompositeOperation="source-over",y=E.canvas,w=_=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(w,_,s,r),t.clip(E),t.globalCompositeOperation="destination-atop",t.fillStyle=x,t.fillRect(w,_,s,r),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),o==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):o==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const S=new Path2D;S.rect(h,f,s,r),e.clip(S),e.globalCompositeOperation="destination-in",e.drawImage(y,w,_,s,r,h,f,s,r),e.restore()}save(){this.inSMaskMode?(xs(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),xs(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,s,r,o,l){this.ctx.transform(t,e,s,r,o,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,s){const r=this.ctx,o=this.current;let l=o.x,u=o.y,h,f;const p=Ot(r),v=p[0]===0&&p[3]===0||p[1]===0&&p[2]===0,y=v?s.slice(0):null;for(let w=0,_=0,S=t.length;w<S;w++)switch(t[w]|0){case qe.rectangle:l=e[_++],u=e[_++];const x=e[_++],E=e[_++],M=l+x,P=u+E;r.moveTo(l,u),x===0||E===0?r.lineTo(M,P):(r.lineTo(M,u),r.lineTo(M,P),r.lineTo(l,P)),v||o.updateRectMinMax(p,[l,u,M,P]),r.closePath();break;case qe.moveTo:l=e[_++],u=e[_++],r.moveTo(l,u),v||o.updatePathMinMax(p,l,u);break;case qe.lineTo:l=e[_++],u=e[_++],r.lineTo(l,u),v||o.updatePathMinMax(p,l,u);break;case qe.curveTo:h=l,f=u,l=e[_+4],u=e[_+5],r.bezierCurveTo(e[_],e[_+1],e[_+2],e[_+3],l,u),o.updateCurvePathMinMax(p,h,f,e[_],e[_+1],e[_+2],e[_+3],l,u,y),_+=6;break;case qe.curveTo2:h=l,f=u,r.bezierCurveTo(l,u,e[_],e[_+1],e[_+2],e[_+3]),o.updateCurvePathMinMax(p,h,f,l,u,e[_],e[_+1],e[_+2],e[_+3],y),l=e[_+2],u=e[_+3],_+=4;break;case qe.curveTo3:h=l,f=u,l=e[_+2],u=e[_+3],r.bezierCurveTo(e[_],e[_+1],l,u,l,u),o.updateCurvePathMinMax(p,h,f,e[_],e[_+1],l,u,l,u,y),_+=4;break;case qe.closePath:r.closePath();break}v&&o.updateScalingPathMinMax(p,y),o.setCurrentPoint(l,u)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,s=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof s=="object"&&s?.getPattern?(e.save(),e.strokeStyle=s.getPattern(e,this,en(e),le.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,s=this.current.fillColor,r=this.current.patternFill;let o=!1;r&&(e.save(),e.fillStyle=s.getPattern(e,this,en(e),le.FILL),o=!0);const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),o&&e.restore(),t&&this.consumePath(l)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Qg}eoClip(){this.pendingClip=gd}beginText(){this.current.textMatrix=Sd,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}const s=new Path2D,r=e.getTransform().invertSelf();for(const{transform:o,x:l,y:u,fontSize:h,path:f}of t)s.addPath(f,new DOMMatrix(o).preMultiplySelf(r).translate(l,u).scale(h,-h));e.clip(s),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){const s=this.commonObjs.get(t),r=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(r.fontMatrix=s.fontMatrix||El,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&vt("Invalid font matrix for font "+t),e<0?(e=-e,r.fontDirection=-1):r.fontDirection=1,this.current.font=s,this.current.fontSize=e,s.isType3Font)return;const o=s.loadedName||"sans-serif",l=s.systemFontInfo?.css||`"${o}", ${s.fallbackName}`;let u="normal";s.black?u="900":s.bold&&(u="bold");const h=s.italic?"italic":"normal";let f=e;e<od?f=od:e>ld&&(f=ld),this.current.fontSizeScale=e/f,this.ctx.font=`${h} ${u} ${f}px ${l}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,s,r,o,l){this.current.textMatrix=[t,e,s,r,o,l],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}#n(t,e,s){const r=new Path2D;return r.addPath(t,new DOMMatrix(s).invertSelf().multiplySelf(e)),r}paintChar(t,e,s,r,o){const l=this.ctx,u=this.current,h=u.font,f=u.textRenderingMode,p=u.fontSize/u.fontSizeScale,v=f&oe.FILL_STROKE_MASK,y=!!(f&oe.ADD_TO_PATH_FLAG),w=u.patternFill&&!h.missingFile,_=u.patternStroke&&!h.missingFile;let S;if((h.disableFontFace||y||w||_)&&(S=h.getPathGenerator(this.commonObjs,t)),h.disableFontFace||w||_){if(l.save(),l.translate(e,s),l.scale(p,-p),v===oe.FILL||v===oe.FILL_STROKE)if(r){const x=l.getTransform();l.setTransform(...r),l.fill(this.#n(S,x,r))}else l.fill(S);if(v===oe.STROKE||v===oe.FILL_STROKE)if(o){const x=l.getTransform();l.setTransform(...o),l.stroke(this.#n(S,x,o))}else l.lineWidth/=p,l.stroke(S);l.restore()}else(v===oe.FILL||v===oe.FILL_STROKE)&&l.fillText(t,e,s),(v===oe.STROKE||v===oe.FILL_STROKE)&&l.strokeText(t,e,s);y&&(this.pendingTextPaths||=[]).push({transform:Ot(l),x:e,y:s,fontSize:p,path:S})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let s=!1;for(let r=3;r<e.length;r+=4)if(e[r]>0&&e[r]<255){s=!0;break}return _t(this,"isFontSubpixelAAEnabled",s)}showText(t){const e=this.current,s=e.font;if(s.isType3Font)return this.showType3Text(t);const r=e.fontSize;if(r===0)return;const o=this.ctx,l=e.fontSizeScale,u=e.charSpacing,h=e.wordSpacing,f=e.fontDirection,p=e.textHScale*f,v=t.length,y=s.vertical,w=y?1:-1,_=s.defaultVMetrics,S=r*e.fontMatrix[0],x=e.textRenderingMode===oe.FILL&&!s.disableFontFace&&!e.patternFill;o.save(),o.transform(...e.textMatrix),o.translate(e.x,e.y+e.textRise),f>0?o.scale(p,-1):o.scale(p,1);let E,M;if(e.patternFill){o.save();const H=e.fillColor.getPattern(o,this,en(o),le.FILL);E=Ot(o),o.restore(),o.fillStyle=H}if(e.patternStroke){o.save();const H=e.strokeColor.getPattern(o,this,en(o),le.STROKE);M=Ot(o),o.restore(),o.strokeStyle=H}let P=e.lineWidth;const N=e.textMatrixScale;if(N===0||P===0){const H=e.textRenderingMode&oe.FILL_STROKE_MASK;(H===oe.STROKE||H===oe.FILL_STROKE)&&(P=this.getSinglePixelWidth())}else P/=N;if(l!==1&&(o.scale(l,l),P/=l),o.lineWidth=P,s.isInvalidPDFjsFont){const H=[];let Z=0;for(const it of t)H.push(it.unicode),Z+=it.width;o.fillText(H.join(""),0,0),e.x+=Z*S*p,o.restore(),this.compose();return}let D=0,B;for(B=0;B<v;++B){const H=t[B];if(typeof H=="number"){D+=w*H*r/1e3;continue}let Z=!1;const it=(H.isSpace?h:0)+u,gt=H.fontChar,ft=H.accent;let St,xt,yt=H.width;if(y){const G=H.vmetric||_,X=-(H.vmetric?G[1]:yt*.5)*S,V=G[2]*S;yt=G?-G[0]:yt,St=X/l,xt=(D+V)/l}else St=D/l,xt=0;if(s.remeasure&&yt>0){const G=o.measureText(gt).width*1e3/r*l;if(yt<G&&this.isFontSubpixelAAEnabled){const X=yt/G;Z=!0,o.save(),o.scale(X,1),St/=X}else yt!==G&&(St+=(yt-G)/2e3*r/l)}if(this.contentVisible&&(H.isInFont||s.missingFile)){if(x&&!ft)o.fillText(gt,St,xt);else if(this.paintChar(gt,St,xt,E,M),ft){const G=St+r*ft.offset.x/l,X=xt-r*ft.offset.y/l;this.paintChar(ft.fontChar,G,X,E,M)}}const Mt=y?yt*S-it*f:yt*S+it*f;D+=Mt,Z&&o.restore()}y?e.y-=D:e.x+=D*p,o.restore(),this.compose()}showType3Text(t){const e=this.ctx,s=this.current,r=s.font,o=s.fontSize,l=s.fontDirection,u=r.vertical?1:-1,h=s.charSpacing,f=s.wordSpacing,p=s.textHScale*l,v=s.fontMatrix||El,y=t.length,w=s.textRenderingMode===oe.INVISIBLE;let _,S,x,E;if(!(w||o===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...s.textMatrix),e.translate(s.x,s.y),e.scale(p,l),_=0;_<y;++_){if(S=t[_],typeof S=="number"){E=u*S*o/1e3,this.ctx.translate(E,0),s.x+=E*p;continue}const M=(S.isSpace?f:0)+h,P=r.charProcOperatorList[S.operatorListId];if(!P){vt(`Type3 character "${S.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=S,this.save(),e.scale(o,o),e.transform(...v),this.executeOperatorList(P),this.restore()),x=st.applyTransform([S.width,0],v)[0]*o+M,e.translate(x,0),s.x+=x*p}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,s,r,o,l){this.ctx.rect(s,r,o-s,l-r),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const s=t[1],r=this.baseTransform||Ot(this.ctx),o={createCanvasGraphics:l=>new Li(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Ul(t,s,this.ctx,o,r)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,s){this.ctx.strokeStyle=this.current.strokeColor=st.makeHexColor(t,e,s),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,s){this.ctx.fillStyle=this.current.fillColor=st.makeHexColor(t,e,s),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=$g(this.getObject(t)),this.cachedPatterns.set(t,s)),e&&(s.matrix=e),s}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const s=this._getPattern(t);e.fillStyle=s.getPattern(e,this,en(e),le.SHADING);const r=en(e);if(r){const{width:o,height:l}=e.canvas,[u,h,f,p]=st.getAxialAlignedBoundingBox([0,0,o,l],r);this.ctx.fillRect(u,h,f-u,p-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Rt("Should not call beginInlineImage")}beginImageData(){Rt("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Ot(this.ctx),e)){const s=e[2]-e[0],r=e[3]-e[1];this.ctx.rect(e[0],e[1],s,r),this.current.updateRectMinMax(Ot(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||ua("TODO: Support non-isolated groups."),t.knockout&&vt("Knockout groups not supported.");const s=Ot(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let r=st.getAxialAlignedBoundingBox(t.bbox,Ot(e));const o=[0,0,e.canvas.width,e.canvas.height];r=st.intersect(r,o)||[0,0,0,0];const l=Math.floor(r[0]),u=Math.floor(r[1]),h=Math.max(Math.ceil(r[2])-l,1),f=Math.max(Math.ceil(r[3])-u,1);this.current.startNewPathAndClipBox([0,0,h,f]);let p="groupAt"+this.groupLevel;t.smask&&(p+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(p,h,f),y=v.context;y.translate(-l,-u),y.transform(...s),t.smask?this.smaskStack.push({canvas:v.canvas,context:y,offsetX:l,offsetY:u,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(l,u),e.save()),xs(e,y),this.ctx=y,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const r=Ot(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...r);const o=st.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],r);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(t,e,s,r,o){if(this.#t(),Zr(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const l=e[2]-e[0],u=e[3]-e[1];if(o&&this.annotationCanvasMap){s=s.slice(),s[4]-=e[0],s[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=l,e[3]=u;const[h,f]=st.singularValueDecompose2dScale(Ot(this.ctx)),{viewportScale:p}=this,v=Math.ceil(l*this.outputScaleX*p),y=Math.ceil(u*this.outputScaleY*p);this.annotationCanvas=this.canvasFactory.create(v,y);const{canvas:w,context:_}=this.annotationCanvas;this.annotationCanvasMap.set(t,w),this.annotationCanvas.savedCtx=this.ctx,this.ctx=_,this.ctx.save(),this.ctx.setTransform(h,0,0,-f,0,u*f),Zr(this.ctx)}else Zr(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],l,u),this.ctx.clip(),this.ctx.beginPath()}this.current=new hd(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const s=this.ctx,r=this.processingType3;if(r&&(r.compiled===void 0&&(r.compiled=qg(t)),r.compiled)){r.compiled(s);return}const o=this._createMaskCanvas(t),l=o.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(l,o.offsetX,o.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,s=0,r=0,o,l){if(!this.contentVisible)return;t=this.getObject(t.data,t);const u=this.ctx;u.save();const h=Ot(u);u.transform(e,s,r,o,0,0);const f=this._createMaskCanvas(t);u.setTransform(1,0,0,1,f.offsetX-h[4],f.offsetY-h[5]);for(let p=0,v=l.length;p<v;p+=2){const y=st.transform(h,[e,s,r,o,l[p],l[p+1]]),[w,_]=st.applyTransform([0,0],y);u.drawImage(f.canvas,w,_)}u.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,s=this.current.fillColor,r=this.current.patternFill;for(const o of t){const{data:l,width:u,height:h,transform:f}=o,p=this.cachedCanvases.getCanvas("maskCanvas",u,h),v=p.context;v.save();const y=this.getObject(l,o);fd(v,y),v.globalCompositeOperation="source-in",v.fillStyle=r?s.getPattern(v,this,en(e),le.FILL):s,v.fillRect(0,0,u,h),v.restore(),e.save(),e.transform(...f),e.scale(1,-1),Qr(e,p.canvas,0,0,u,h,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){vt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,s,r){if(!this.contentVisible)return;const o=this.getObject(t);if(!o){vt("Dependent image isn't ready yet");return}const l=o.width,u=o.height,h=[];for(let f=0,p=r.length;f<p;f+=2)h.push({transform:[e,0,0,s,r[f],r[f+1]],x:0,y:0,w:l,h:u});this.paintInlineImageXObjectGroup(o,h)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:s,height:r}=t,o=this.cachedCanvases.getCanvas("inlineImage",s,r),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",o.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,s=t.height,r=this.ctx;if(this.save(),!ue){const{filter:u}=r;u!=="none"&&u!==""&&(r.filter="none")}r.scale(1/e,-1/s);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",e,s).context;dd(h,t),o=this.applyTransferMapsToCanvas(h)}const l=this._scaleImage(o,en(r));r.imageSmoothingEnabled=pd(Ot(r),t.interpolate),Qr(r,l.img,0,0,l.paintWidth,l.paintHeight,0,-s,e,s),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const s=this.ctx;let r;if(t.bitmap)r=t.bitmap;else{const o=t.width,l=t.height,h=this.cachedCanvases.getCanvas("inlineImage",o,l).context;dd(h,t),r=this.applyTransferMapsToCanvas(h)}for(const o of e)s.save(),s.transform(...o.transform),s.scale(1,-1),Qr(s,r,o.x,o.y,o.w,o.h,0,-1,1,1),s.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const s=this.ctx;this.pendingClip&&(e||(this.pendingClip===gd?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Ot(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),s=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(s,r)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:s,c:r,d:o}=this.ctx.getTransform();let l,u;if(s===0&&r===0){const h=Math.abs(e),f=Math.abs(o);if(h===f)if(t===0)l=u=1/h;else{const p=h*t;l=u=p<1?1/p:1}else if(t===0)l=1/h,u=1/f;else{const p=h*t,v=f*t;l=p<1?1/p:1,u=v<1?1/v:1}}else{const h=Math.abs(e*o-s*r),f=Math.hypot(e,s),p=Math.hypot(r,o);if(t===0)l=p/h,u=f/h;else{const v=t*h;l=p>v?p/v:1,u=f>v?f/v:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:s}=this.current,[r,o]=this.getScaleForStroking();if(e.lineWidth=s||1,r===1&&o===1){e.stroke();return}const l=e.getLineDash();if(t&&e.save(),e.scale(r,o),l.length>0){const u=Math.max(r,o);e.setLineDash(l.map(h=>h/u)),e.lineDashOffset/=u}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const g in qe)Li.prototype[g]!==void 0&&(Li.prototype[qe[g]]=Li.prototype[g]);class Ls{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class Zg{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}getAll(){return Il(this.#t)}has(t){return this.#t.has(t)}}const Ri=Symbol("INTERNAL");class Jg{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:e,intent:s,usage:r,rbGroups:o}){this.#t=!!(t&Pe.DISPLAY),this.#e=!!(t&Pe.PRINT),this.name=e,this.intent=s,this.usage=r,this.rbGroups=o}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,s=!1){t!==Ri&&Rt("Internal method `_setVisible` called."),this.#n=s,this.#i=e}}class tm{#t=null;#e=new Map;#n=null;#i=null;constructor(t,e=Pe.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const s of t.groups)this.#e.set(s.id,new Jg(e,s));if(t.baseState==="OFF")for(const s of this.#e.values())s._setVisible(Ri,!1);for(const s of t.on)this.#e.get(s)._setVisible(Ri,!0);for(const s of t.off)this.#e.get(s)._setVisible(Ri,!1);this.#n=this.getHash()}}#r(t){const e=t.length;if(e<2)return!0;const s=t[0];for(let r=1;r<e;r++){const o=t[r];let l;if(Array.isArray(o))l=this.#r(o);else if(this.#e.has(o))l=this.#e.get(o).visible;else return vt(`Optional content group not found: ${o}`),!0;switch(s){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return s==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return ua("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(vt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#r(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return vt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return vt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return vt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return vt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return vt(`Unknown optional content policy ${t.policy}.`),!0}return vt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,s=!0){const r=this.#e.get(t);if(!r){vt(`Optional content group not found: ${t}`);return}if(s&&e&&r.rbGroups.length)for(const o of r.rbGroups)for(const l of o)l!==t&&this.#e.get(l)?._setVisible(Ri,!1,!0);r._setVisible(Ri,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let s;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":s=r;continue}const o=this.#e.get(r);if(o)switch(s){case"ON":this.setVisibility(r,!0,e);break;case"OFF":this.setVisibility(r,!1,e);break;case"Toggle":this.setVisibility(r,!o.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroups(){return this.#e.size>0?Il(this.#e):null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new xd;for(const[e,s]of this.#e)t.update(`${e}:${s.visible}`);return this.#t=t.hexdigest()}}class em{constructor(t,{disableRange:e=!1,disableStream:s=!1}){Xt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:o,progressiveDone:l,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=u,o?.length>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!s,this._isRangeSupported=!e,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const s=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(s):this._queuedChunks.push(s);else{const r=this._rangeReaders.some(function(o){return o._begin!==t?!1:(o._enqueue(s),!0)});Xt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Xt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new nm(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new im(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class nm{constructor(t,e,s=!1,r=null){this._stream=t,this._done=s||!1,this._filename=Fl(r)?r:null,this._queuedChunks=e||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class im{constructor(t,e,s){this._stream=t,this._begin=e,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function sm(g){let t=!0,e=s("filename\\*","i").exec(g);if(e){e=e[1];let p=u(e);return p=unescape(p),p=h(p),p=f(p),o(p)}if(e=l(g),e){const p=f(e);return o(p)}if(e=s("filename","i").exec(g),e){e=e[1];let p=u(e);return p=f(p),o(p)}function s(p,v){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',v)}function r(p,v){if(p){if(!/^[\x00-\xFF]+$/.test(v))return v;try{const y=new TextDecoder(p,{fatal:!0}),w=ca(v);v=y.decode(w),t=!1}catch{}}return v}function o(p){return t&&/[\x80-\xff]/.test(p)&&(p=r("utf-8",p),t&&(p=r("iso-8859-1",p))),p}function l(p){const v=[];let y;const w=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=w.exec(p))!==null;){let[,S,x,E]=y;if(S=parseInt(S,10),S in v){if(S===0)break;continue}v[S]=[x,E]}const _=[];for(let S=0;S<v.length&&S in v;++S){let[x,E]=v[S];E=u(E),x&&(E=unescape(E),S===0&&(E=h(E))),_.push(E)}return _.join("")}function u(p){if(p.startsWith('"')){const v=p.slice(1).split('\\"');for(let y=0;y<v.length;++y){const w=v[y].indexOf('"');w!==-1&&(v[y]=v[y].slice(0,w),v.length=y+1),v[y]=v[y].replaceAll(/\\(.)/g,"$1")}p=v.join('"')}return p}function h(p){const v=p.indexOf("'");if(v===-1)return p;const y=p.slice(0,v),_=p.slice(v+1).replace(/^[^']*'/,"");return r(y,_)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(v,y,w,_){if(w==="q"||w==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,x){return String.fromCharCode(parseInt(x,16))}),r(y,_);try{_=atob(_)}catch{}return r(y,_)})}return""}function Nd(g,t){const e=new Headers;if(!g||!t||typeof t!="object")return e;for(const s in t){const r=t[s];r!==void 0&&e.append(s,r)}return e}function pa(g){try{return new URL(g).origin}catch{}return null}function Dd({responseHeaders:g,isHttp:t,rangeChunkSize:e,disableRange:s}){const r={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(g.get("Content-Length"),10);return!Number.isInteger(o)||(r.suggestedLength=o,o<=2*e)||s||!t||g.get("Accept-Ranges")!=="bytes"||(g.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function Fd(g){const t=g.get("Content-Disposition");if(t){let e=sm(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Fl(e))return e}return null}function ga(g,t){return g===404||g===0&&t.startsWith("file:")?new Is('Missing PDF "'+t+'".'):new sa(`Unexpected server response (${g}) while retrieving PDF "${t}".`,g)}function Od(g){return g===200||g===206}function zd(g,t,e){return{method:"GET",headers:g,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function jd(g){return g instanceof Uint8Array?g.buffer:g instanceof ArrayBuffer?g:(vt(`getArrayBuffer - unexpected data format: ${g}`),new Uint8Array(g).buffer)}class md{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Nd(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Xt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new rm(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new am(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class rm{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const s=new Headers(t.headers),r=e.url;fetch(r,zd(s,this._withCredentials,this._abortController)).then(o=>{if(t._responseOrigin=pa(o.url),!Od(o.status))throw ga(o.status,r);this._reader=o.body.getReader(),this._headersCapability.resolve();const l=o.headers,{allowRangeRequests:u,suggestedLength:h}=Dd({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=Fd(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Fn("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:jd(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class am{constructor(t,e,s){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const o=new Headers(t.headers);o.append("Range",`bytes=${e}-${s-1}`);const l=r.url;fetch(l,zd(o,this._withCredentials,this._abortController)).then(u=>{const h=pa(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!Od(u.status))throw ga(u.status,l);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:jd(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Sl=200,bl=206;function om(g){const t=g.response;return typeof t!="string"?t:ca(t).buffer}class lm{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:s}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Nd(this.isHttp,e),this.withCredentials=s||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,s=this.currXhrId++,r=this.pendingRequests[s]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[o,l]of this.headers)e.setRequestHeader(o,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=bl):r.expectedStatus=Sl,e.responseType="arraybuffer",Xt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,s),e.onprogress=this.onProgress.bind(this,s),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,e.send(null),s}onProgress(t,e){const s=this.pendingRequests[t];s&&s.onProgress?.(e)}onStateChange(t,e){const s=this.pendingRequests[t];if(!s)return;const r=s.xhr;if(r.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){s.onError(r.status);return}const o=r.status||Sl;if(!(o===Sl&&s.expectedStatus===bl)&&o!==s.expectedStatus){s.onError(r.status);return}const u=om(r);if(o===bl){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?s.onDone({begin:parseInt(f[1],10),chunk:u}):(vt('Missing or invalid "Content-Range" header.'),s.onError(0))}else u?s.onDone({begin:0,chunk:u}):s.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class um{constructor(t){this._source=t,this._manager=new lm(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Xt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new cm(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const s=new hm(this._manager,t,e);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class cm{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=pa(e.responseURL);const s=e.getAllResponseHeaders(),r=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...f]=u.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:l}=Dd({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=Fd(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=ga(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class hm{constructor(t,e,s){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:s,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=pa(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const s of this._requests)s.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=ga(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const dm=/^[a-z][a-z0-9\-+.]+:/i;function fm(g){if(dm.test(g))return new URL(g);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(g))}class pm{constructor(t){this.source=t,this.url=fm(t.url),Xt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Xt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new gm(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const s=new mm(this,t,e);return this._rangeRequestReaders.push(s),s}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class gm{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const s=process.getBuiltinModule("fs");s.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(s.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=new Is(`Missing PDF "${this._url}".`)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Fn("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class mm{constructor(t,e,s){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:e,end:s-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const vm=1e5,Se=30,ym=.8;class pe{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#r=null;#s=null;#l=0;#o=0;#c=null;#u=null;#d=0;#h=0;#f=Object.create(null);#a=[];#p=null;#m=[];#g=new WeakMap;#v=null;static#A=new Map;static#y=new Map;static#_=new WeakMap;static#b=null;static#x=new Set;constructor({textContentSource:t,container:e,viewport:s}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#u=e,this.#h=s.scale*(globalThis.devicePixelRatio||1),this.#d=s.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:o,pageX:l,pageY:u}=s.rawDims;this.#v=[1,0,0,-1,-l,u+o],this.#o=r,this.#l=o,pe.#M(),ei(e,s),this.#t.promise.finally(()=>{pe.#x.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=ge.platform;return _t(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:s})=>{if(s){this.#t.resolve();return}this.#r??=e.lang,Object.assign(this.#f,e.styles),this.#k(e.items),t()},this.#t.reject)};return this.#c=this.#p.getReader(),pe.#x.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const s=t.scale*(globalThis.devicePixelRatio||1),r=t.rotation;if(r!==this.#d&&(e?.(),this.#d=r,ei(this.#u,{rotation:r})),s!==this.#h){e?.(),this.#h=s;const o={div:null,properties:null,ctx:pe.#T(this.#r)};for(const l of this.#m)o.properties=this.#g.get(l),o.div=l,this.#S(o)}}cancel(){const t=new Fn("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#m}get textContentItemsStr(){return this.#a}#k(t){if(this.#n)return;this.#s.ctx??=pe.#T(this.#r);const e=this.#m,s=this.#a;for(const r of t){if(e.length>vm){vt("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const o=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id!==null&&this.#e.setAttribute("id",`${r.id}`),o.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}s.push(r.str),this.#P(r)}}#P(t){const e=document.createElement("span"),s={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#m.push(e);const r=st.transform(this.#v,t.transform);let o=Math.atan2(r[1],r[0]);const l=this.#f[t.fontName];l.vertical&&(o+=Math.PI/2);let u=this.#i&&l.fontSubstitution||l.fontFamily;u=pe.fontFamilyMap.get(u)||u;const h=Math.hypot(r[2],r[3]),f=h*pe.#N(u,this.#r);let p,v;o===0?(p=r[4],v=r[5]-f):(p=r[4]+f*Math.sin(o),v=r[5]-f*Math.cos(o));const y="calc(var(--scale-factor)*",w=e.style;this.#e===this.#u?(w.left=`${(100*p/this.#o).toFixed(2)}%`,w.top=`${(100*v/this.#l).toFixed(2)}%`):(w.left=`${y}${p.toFixed(2)}px)`,w.top=`${y}${v.toFixed(2)}px)`),w.fontSize=`${y}${(pe.#b*h).toFixed(2)}px)`,w.fontFamily=u,s.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),o!==0&&(s.angle=o*(180/Math.PI));let _=!1;if(t.str.length>1)_=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),x=Math.abs(t.transform[3]);S!==x&&Math.max(S,x)/Math.min(S,x)>1.5&&(_=!0)}if(_&&(s.canvasWidth=l.vertical?t.height:t.width),this.#g.set(e,s),this.#s.div=e,this.#s.properties=s,this.#S(this.#s),s.hasText&&this.#e.append(e),s.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#e.append(S)}}#S(t){const{div:e,properties:s,ctx:r}=t,{style:o}=e;let l="";if(pe.#b>1&&(l=`scale(${1/pe.#b})`),s.canvasWidth!==0&&s.hasText){const{fontFamily:u}=o,{canvasWidth:h,fontSize:f}=s;pe.#C(r,f*this.#h,u);const{width:p}=r.measureText(e.textContent);p>0&&(l=`scaleX(${h*this.#h/p}) ${l}`)}s.angle!==0&&(l=`rotate(${s.angle}deg) ${l}`),l.length>0&&(o.transform=l)}static cleanup(){if(!(this.#x.size>0)){this.#A.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#T(t=null){let e=this.#y.get(t||="");if(!e){const s=document.createElement("canvas");s.className="hiddenCanvasElement",s.lang=t,document.body.append(s),e=s.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,e),this.#_.set(e,{size:0,family:""})}return e}static#C(t,e,s){const r=this.#_.get(t);e===r.size&&s===r.family||(t.font=`${e}px ${s}`,r.size=e,r.family=s)}static#M(){if(this.#b!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#b=t.getBoundingClientRect().height,t.remove()}static#N(t,e){const s=this.#A.get(t);if(s)return s;const r=this.#T(e);r.canvas.width=r.canvas.height=Se,this.#C(r,Se,t);const o=r.measureText("");let l=o.fontBoundingBoxAscent,u=Math.abs(o.fontBoundingBoxDescent);if(l){const p=l/(l+u);return this.#A.set(t,p),r.canvas.width=r.canvas.height=0,p}r.strokeStyle="red",r.clearRect(0,0,Se,Se),r.strokeText("g",0,0);let h=r.getImageData(0,0,Se,Se).data;u=0;for(let p=h.length-1-3;p>=0;p-=4)if(h[p]>0){u=Math.ceil(p/4/Se);break}r.clearRect(0,0,Se,Se),r.strokeText("A",0,Se),h=r.getImageData(0,0,Se,Se).data,l=0;for(let p=0,v=h.length;p<v;p+=4)if(h[p]>0){l=Se-Math.floor(p/4/Se);break}r.canvas.width=r.canvas.height=0;const f=l?l/(l+u):ym;return this.#A.set(t,f),f}}class Ns{static textContent(t){const e=[],s={items:e,styles:Object.create(null)};function r(o){if(!o)return;let l=null;const u=o.name;if(u==="#text")l=o.value;else if(Ns.shouldBuildText(u))o?.attributes?.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&e.push({str:l}),!!o.children)for(const h of o.children)r(h)}return r(t),s}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const wm=65536,Am=100,_m=5e3,Sm=ue?Fg:Ig,bm=ue?Og:Pd,Em=ue?Dg:Ng,xm=ue?zg:Ld;function Cm(g={}){typeof g=="string"||g instanceof URL?g={url:g}:(g instanceof ArrayBuffer||ArrayBuffer.isView(g))&&(g={data:g});const t=new $l,{docId:e}=t,s=g.url?km(g.url):null,r=g.data?Tm(g.data):null,o=g.httpHeaders||null,l=g.withCredentials===!0,u=g.password??null,h=g.range instanceof Bd?g.range:null,f=Number.isInteger(g.rangeChunkSize)&&g.rangeChunkSize>0?g.rangeChunkSize:wm;let p=g.worker instanceof Ii?g.worker:null;const v=g.verbosity,y=typeof g.docBaseUrl=="string"&&!da(g.docBaseUrl)?g.docBaseUrl:null,w=typeof g.cMapUrl=="string"?g.cMapUrl:null,_=g.cMapPacked!==!1,S=g.CMapReaderFactory||bm,x=typeof g.standardFontDataUrl=="string"?g.standardFontDataUrl:null,E=g.StandardFontDataFactory||xm,M=g.stopAtErrors!==!0,P=Number.isInteger(g.maxImageSize)&&g.maxImageSize>-1?g.maxImageSize:-1,N=g.isEvalSupported!==!1,D=typeof g.isOffscreenCanvasSupported=="boolean"?g.isOffscreenCanvasSupported:!ue,B=typeof g.isImageDecoderSupported=="boolean"?g.isImageDecoderSupported:!ue&&(ge.platform.isFirefox||!globalThis.chrome),H=Number.isInteger(g.canvasMaxAreaInBytes)?g.canvasMaxAreaInBytes:-1,Z=typeof g.disableFontFace=="boolean"?g.disableFontFace:ue,it=g.fontExtraProperties===!0,gt=g.enableXfa===!0,ft=g.ownerDocument||globalThis.document,St=g.disableRange===!0,xt=g.disableStream===!0,yt=g.disableAutoFetch===!0,Mt=g.pdfBug===!0,G=g.CanvasFactory||Sm,X=g.FilterFactory||Em,V=g.enableHWA===!0,tt=h?h.length:g.length??NaN,W=typeof g.useSystemFonts=="boolean"?g.useSystemFonts:!ue&&!Z,T=typeof g.useWorkerFetch=="boolean"?g.useWorkerFetch:S===Pd&&E===Ld&&w&&x&&Ts(w,document.baseURI)&&Ts(x,document.baseURI),F=null;hg(v);const nt={canvasFactory:new G({ownerDocument:ft,enableHWA:V}),filterFactory:new X({docId:e,ownerDocument:ft}),cMapReaderFactory:T?null:new S({baseUrl:w,isCompressed:_}),standardFontDataFactory:T?null:new E({baseUrl:x})};if(!p){const ct={verbosity:v,port:Ls.workerPort};p=ct.port?Ii.fromPort(ct):new Ii(ct),t._worker=p}const pt={docId:e,apiVersion:"4.10.38",data:r,password:u,disableAutoFetch:yt,rangeChunkSize:f,length:tt,docBaseUrl:y,enableXfa:gt,evaluatorOptions:{maxImageSize:P,disableFontFace:Z,ignoreErrors:M,isEvalSupported:N,isOffscreenCanvasSupported:D,isImageDecoderSupported:B,canvasMaxAreaInBytes:H,fontExtraProperties:it,useSystemFonts:W,cMapUrl:T?w:null,standardFontDataUrl:T?x:null}},wt={disableFontFace:Z,fontExtraProperties:it,ownerDocument:ft,pdfBug:Mt,styleElement:F,loadingParams:{disableAutoFetch:yt,enableXfa:gt}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const ct=p.messageHandler.sendWithPromise("GetDocRequest",pt,r?[r.buffer]:null);let ot;if(h)ot=new em(h,{disableRange:St,disableStream:xt});else if(!r){if(!s)throw new Error("getDocument - no `url` parameter provided.");let bt;if(ue)if(Ts(s)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");bt=md}else bt=pm;else bt=Ts(s)?md:um;ot=new bt({url:s,length:tt,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:St,disableStream:xt})}return ct.then(bt=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Pt=new Ps(e,bt,p.port),ce=new Lm(Pt,t,ot,wt,nt);t._transport=ce,Pt.send("Ready",null)})}).catch(t._capability.reject),t}function km(g){if(g instanceof URL)return g.href;try{return new URL(g,window.location).href}catch{if(ue&&typeof g=="string")return g}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Tm(g){if(ue&&typeof Buffer<"u"&&g instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength)return g;if(typeof g=="string")return ca(g);if(g instanceof ArrayBuffer||ArrayBuffer.isView(g)||typeof g=="object"&&!isNaN(g?.length))return new Uint8Array(g);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function vd(g){return typeof g=="object"&&Number.isInteger(g?.num)&&g.num>=0&&Number.isInteger(g?.gen)&&g.gen>=0}class $l{static#t=0;constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${$l.#t++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}}class Bd{constructor(t,e,s=!1,r=null){this.length=t,this.initialData=e,this.progressiveDone=s,this.contentDispositionFilename=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const s of this._rangeListeners)s(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){Rt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Pm{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return _t(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class Rm{#t=null;#e=!1;constructor(t,e,s,r=!1){this._pageIndex=t,this._pageInfo=e,this._transport=s,this._stats=r?new id:null,this._pdfBug=r,this.commonObjs=s.commonObjs,this.objs=new Hd,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:s=0,offsetY:r=0,dontFlip:o=!1}={}){return new Ds({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:s,offsetY:r,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return _t(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:e,intent:s="display",annotationMode:r=Nn.ENABLE,transform:o=null,background:l=null,optionalContentConfigPromise:u=null,annotationCanvasMap:h=null,pageColors:f=null,printAnnotationStorage:p=null,isEditing:v=!1}){this._stats?.time("Overall");const y=this._transport.getRenderingIntent(s,r,p,v),{renderingIntent:w,cacheKey:_}=y;this.#e=!1,this.#i(),u||=this._transport.getOptionalContentConfig(w);let S=this._intentStates.get(_);S||(S=Object.create(null),this._intentStates.set(_,S)),S.streamReaderCancelTimeout&&(clearTimeout(S.streamReaderCancelTimeout),S.streamReaderCancelTimeout=null);const x=!!(w&Pe.PRINT);S.displayReadyCapability||(S.displayReadyCapability=Promise.withResolvers(),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(y));const E=N=>{S.renderTasks.delete(M),(this._maybeCleanupAfterRender||x)&&(this.#e=!0),this.#n(!x),N?(M.capability.reject(N),this._abortOperatorList({intentState:S,reason:N instanceof Error?N:new Error(N)})):M.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},M=new Mi({callback:E,params:{canvasContext:t,viewport:e,transform:o,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:S.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:f});(S.renderTasks||=new Set).add(M);const P=M.task;return Promise.all([S.displayReadyCapability.promise,u]).then(([N,D])=>{if(this.destroyed){E();return}if(this._stats?.time("Rendering"),!(D.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");M.initializeGraphics({transparency:N,optionalContentConfig:D}),M.operatorListChanged()}).catch(E),P}getOperatorList({intent:t="display",annotationMode:e=Nn.ENABLE,printAnnotationStorage:s=null,isEditing:r=!1}={}){function o(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,e,s,r,!0);let u=this._intentStates.get(l.cacheKey);u||(u=Object.create(null),this._intentStates.set(l.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(s=>Ns.textContent(s));const e=this.streamTextContent(t);return new Promise(function(s,r){function o(){l.read().then(function({value:h,done:f}){if(f){s(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),o()},r)}const l=e.getReader(),u={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const s of e.renderTasks)t.push(s.completed),s.cancel();return this.objs.clear(),this.#e=!1,this.#i(),Promise.all(t)}cleanup(t=!1){this.#e=!0;const e=this.#n(!1);return t&&e&&(this._stats&&=new id),e}#n(t=!1){if(this.#i(),!this.#e||this.destroyed)return!1;if(t)return this.#t=setTimeout(()=>{this.#t=null,this.#n(!1)},_m),!1;for(const{renderTasks:e,operatorList:s}of this._intentStates.values())if(e.size>0||!s.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}#i(){this.#t&&(clearTimeout(this.#t),this.#t=null)}_startRenderPage(t,e){const s=this._intentStates.get(e);s&&(this._stats?.timeEnd("Page Request"),s.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let s=0,r=t.length;s<r;s++)e.operatorList.fnArray.push(t.fnArray[s]),e.operatorList.argsArray.push(t.argsArray[s]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const s of e.renderTasks)s.operatorListChanged();t.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:s,modifiedIds:r}){const{map:o,transfer:l}=s,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:o,modifiedIds:r},l).getReader(),f=this._intentStates.get(e);f.streamReader=h;const p=()=>{h.read().then(({value:v,done:y})=>{if(y){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(v,f),p())},v=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const y of f.renderTasks)y.operatorListChanged();this.#n(!0)}if(f.displayReadyCapability)f.displayReadyCapability.reject(v);else if(f.opListReadCapability)f.opListReadCapability.reject(v);else throw v}})};p()}_abortOperatorList({intentState:t,reason:e,force:s=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!s){if(t.renderTasks.size>0)return;if(e instanceof Dl){let r=Am;e.extraDelay>0&&e.extraDelay<1e3&&(r+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},r);return}}if(t.streamReader.cancel(new Fn(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,o]of this._intentStates)if(o===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}class Mm{#t=new Map;#e=Promise.resolve();postMessage(t,e){const s={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,s)})}addEventListener(t,e,s=null){let r=null;if(s?.signal instanceof AbortSignal){const{signal:o}=s;if(o.aborted){vt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);r=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}this.#t.set(e,r)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}var aa,Jn,ti,Ni,na,Di,ia;const Ft=class Ft{constructor({name:t=null,port:e=null,verbosity:s=dg()}={}){Pi(this,Ni);if(this.name=t,this.destroyed=!1,this.verbosity=s,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if(Xe(Ft,ti)?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(Xe(Ft,ti)||Ss(Ft,ti,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new Ps("main","worker",t),this._messageHandler.on("ready",function(){}),qr(this,Ni,na).call(this)}_initialize(){if(Xe(Ft,Jn)||Xe(Ft,Di,ia)){this._setupFakeWorker();return}let{workerSrc:t}=Ft;try{Ft._isSameOrigin(window.location.href,t)||(t=Ft._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),s=new Ps("main","worker",e),r=()=>{o.abort(),s.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},o=new AbortController;e.addEventListener("error",()=>{this._webWorker||r()},{signal:o.signal}),s.on("test",u=>{if(o.abort(),this.destroyed||!u){r();return}this._messageHandler=s,this._port=e,this._webWorker=e,qr(this,Ni,na).call(this)}),s.on("ready",u=>{if(o.abort(),this.destroyed){r();return}try{l()}catch{this._setupFakeWorker()}});const l=()=>{const u=new Uint8Array;s.send("test",u,[u.buffer])};l();return}catch{ua("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){Xe(Ft,Jn)||(vt("Setting up fake worker."),Ss(Ft,Jn,!0)),Ft._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new Mm;this._port=e;const s=`fake${Vh(Ft,aa)._++}`,r=new Ps(s+"_worker",s,e);t.setup(r,e),this._messageHandler=new Ps(s,s+"_worker",e),qr(this,Ni,na).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){this.destroyed=!0,this._webWorker?.terminate(),this._webWorker=null,Xe(Ft,ti)?.delete(this._port),this._port=null,this._messageHandler?.destroy(),this._messageHandler=null}static fromPort(t){if(!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const e=Xe(this,ti)?.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Ft(t)}static get workerSrc(){if(Ls.workerSrc)return Ls.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return _t(this,"_setupFakeWorkerGlobal",(async()=>Xe(this,Di,ia)?Xe(this,Di,ia):(await import(this.workerSrc)).WorkerMessageHandler)())}};aa=new WeakMap,Jn=new WeakMap,ti=new WeakMap,Ni=new WeakSet,na=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Di=new WeakSet,ia=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Pi(Ft,Di),Pi(Ft,aa,0),Pi(Ft,Jn,!1),Pi(Ft,ti),ue&&(Ss(Ft,Jn,!0),Ls.workerSrc||="./pdf.worker.mjs"),Ft._isSameOrigin=(t,e)=>{let s;try{if(s=new URL(t),!s.origin||s.origin==="null")return!1}catch{return!1}const r=new URL(e,s);return s.origin===r.origin},Ft._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let Ii=Ft;class Lm{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#r=null;constructor(t,e,s,r,o){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Hd,this.fontLoader=new Mg({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}#s(t,e=null){const s=this.#t.get(t);if(s)return s;const r=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,r),r}get annotationStorage(){return _t(this,"annotationStorage",new Bl)}getRenderingIntent(t,e=Nn.ENABLE,s=null,r=!1,o=!1){let l=Pe.DISPLAY,u=kl;switch(t){case"any":l=Pe.ANY;break;case"display":break;case"print":l=Pe.PRINT;break;default:vt(`getRenderingIntent - invalid intent: ${t}`)}const h=l&Pe.PRINT&&s instanceof Cd?s:this.annotationStorage;switch(e){case Nn.DISABLE:l+=Pe.ANNOTATIONS_DISABLE;break;case Nn.ENABLE:break;case Nn.ENABLE_FORMS:l+=Pe.ANNOTATIONS_FORMS;break;case Nn.ENABLE_STORAGE:l+=Pe.ANNOTATIONS_STORAGE,u=h.serializable;break;default:vt(`getRenderingIntent - invalid annotationMode: ${e}`)}r&&(l+=Pe.IS_EDITING),o&&(l+=Pe.OPLIST);const{ids:f,hash:p}=h.modifiedIds,v=[l,u.hash,p];return{renderingIntent:l,cacheKey:v.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const s of this.#e.values())t.push(s._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),pe.cleanup(),this._networkStream?.cancelAllRequests(new Fn("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(s,r)=>{Xt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},r.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){r.close();return}Xt(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{r.error(o)})},r.onCancel=o=>{this._fullReader.cancel(o),r.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async s=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:o,contentLength:l}=this._fullReader;return(!r||!o)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{e.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:r,isRangeSupported:o,contentLength:l}}),t.on("GetRangeReader",(s,r)=>{Xt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(s.begin,s.end);if(!o){r.close();return}r.onPull=()=>{o.read().then(function({value:l,done:u}){if(u){r.close();return}Xt(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{o.cancel(l),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:s})=>{this._numPages=s.numPages,this._htmlForXfa=s.htmlForXfa,delete s.htmlForXfa,e._capability.resolve(new Pm(s,this))}),t.on("DocException",s=>{e._capability.reject(be(s))}),t.on("PasswordRequest",s=>{this.#r=Promise.withResolvers();try{if(!e.onPassword)throw be(s);const r=o=>{o instanceof Error?this.#r.reject(o):this.#r.resolve({password:o})};e.onPassword(r,s.code)}catch(r){this.#r.reject(r)}return this.#r.promise}),t.on("DataLoaded",s=>{e.onProgress?.({loaded:s.length,total:s.length}),this.downloadInfoCapability.resolve(s)}),t.on("StartRenderPage",s=>{if(this.destroyed)return;this.#e.get(s.pageIndex)._startRenderPage(s.transparency,s.cacheKey)}),t.on("commonobj",([s,r,o])=>{if(this.destroyed||this.commonObjs.has(s))return null;switch(r){case"Font":const{disableFontFace:l,fontExtraProperties:u,pdfBug:h}=this._params;if("error"in o){const y=o.error;vt(`Error during font loading: ${y}`),this.commonObjs.resolve(s,y);break}const f=h&&globalThis.FontInspector?.enabled?(y,w)=>globalThis.FontInspector.fontAdded(y,w):null,p=new Lg(o,{disableFontFace:l,fontExtraProperties:u,inspectFont:f});this.fontLoader.bind(p).catch(()=>t.sendWithPromise("FontFallback",{id:s})).finally(()=>{!u&&p.data&&(p.data=null),this.commonObjs.resolve(s,p)});break;case"CopyLocalImage":const{imageRef:v}=o;Xt(v,"The imageRef must be defined.");for(const y of this.#e.values())for(const[,w]of y.objs)if(w?.ref===v)return w.dataLen?(this.commonObjs.resolve(s,structuredClone(w)),w.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(s,o);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([s,r,o,l])=>{if(this.destroyed)return;const u=this.#e.get(r);if(!u.objs.has(s)){if(u._intentStates.size===0){l?.bitmap?.close();return}switch(o){case"Image":u.objs.resolve(s,l),l?.dataLen>og&&(u._maybeCleanupAfterRender=!0);break;case"Pattern":u.objs.resolve(s,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",s=>{this.destroyed||e.onProgress?.({loaded:s.loaded,total:s.total})}),t.on("FetchBuiltInCMap",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(s)}),t.on("FetchStandardFontData",async s=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(s)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&vt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,s=this.#n.get(e);if(s)return s;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#i.set(o.refStr,t);const l=new Rm(e,o,this,this._params.pdfBug);return this.#e.set(e,l),l});return this.#n.set(e,r),r}getPageIndex(t){return vd(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#s("GetOptionalContentConfig").then(e=>new tm(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const s=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new Zg(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,s),s}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),pe.cleanup()}}cachedPageNumber(t){if(!vd(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}const Cs=Symbol("INITIAL_DATA");class Hd{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Cs}}get(t,e=null){if(e){const r=this.#e(t);return r.promise.then(()=>e(r.data)),null}const s=this.#t[t];if(!s||s.data===Cs)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return s.data}has(t){const e=this.#t[t];return!!e&&e.data!==Cs}delete(t){const e=this.#t[t];return!e||e.data===Cs?!1:(delete this.#t[t],!0)}resolve(t,e=null){const s=this.#e(t);s.data=e,s.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Cs&&(yield[t,e])}}}class Im{#t=null;constructor(t){this.#t=t,this.onContinue=null}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Mi{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:s,commonObjs:r,annotationCanvasMap:o,operatorList:l,pageIndex:u,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:v=!1,pageColors:y=null}){this.callback=t,this.params=e,this.objs=s,this.commonObjs=r,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=v,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Im(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Mi.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Mi.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:r,transform:o,background:l}=this.params;this.gfx=new Li(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:o,viewport:r,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Mi.#e.delete(this._canvas),this.callback(t||new Dl(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Mi.#e.delete(this._canvas),this.callback())))}}const Nm="4.10.38",Dm="f9bea397f";function yd(g){return Math.floor(Math.max(0,Math.min(1,g))*255).toString(16).padStart(2,"0")}function ks(g){return Math.max(0,Math.min(255,255*g))}class wd{static CMYK_G([t,e,s,r]){return["G",1-Math.min(1,.3*t+.59*s+.11*e+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=ks(t),[t,t,t]}static G_HTML([t]){const e=yd(t);return`#${e}${e}${e}`}static RGB_G([t,e,s]){return["G",.3*t+.59*e+.11*s]}static RGB_rgb(t){return t.map(ks)}static RGB_HTML(t){return`#${t.map(yd).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,s,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,s+r),1-Math.min(1,e+r)]}static CMYK_rgb([t,e,s,r]){return[ks(1-Math.min(1,t+r)),ks(1-Math.min(1,s+r)),ks(1-Math.min(1,e+r))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,s]){const r=1-t,o=1-e,l=1-s,u=Math.min(r,o,l);return["CMYK",r,o,l,u]}}class Fm{create(t,e,s=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),s||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${e}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${e}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Rt("Abstract method `_createSVG` called.")}}class Vl extends Fm{_createSVG(t){return document.createElementNS(fn,t)}}class Ud{static setupStorage(t,e,s,r,o){const l=r.getValue(e,{value:null});switch(s.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),o==="print")break;t.addEventListener("input",u=>{r.setValue(e,{value:u.target.value})});break;case"input":if(s.attributes.type==="radio"||s.attributes.type==="checkbox"){if(l.value===s.attributes.xfaOn?t.setAttribute("checked",!0):l.value===s.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",u=>{r.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),o==="print")break;t.addEventListener("input",u=>{r.setValue(e,{value:u.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const u of s.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:s=null,intent:r,linkService:o}){const{attributes:l}=e,u=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${r}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}u&&o.addLinkAttributes(t,l.href,l.newWindow),s&&l.dataId&&this.setupStorage(t,l.dataId,e,s)}static render(t){const e=t.annotationStorage,s=t.linkService,r=t.xfaHtml,o=t.intent||"display",l=document.createElement(r.name);r.attributes&&this.setAttributes({html:l,element:r,intent:o,linkService:s});const u=o!=="richText",h=t.div;if(h.append(l),t.viewport){const v=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=v}u&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const v=document.createTextNode(r.value);l.append(v),u&&Ns.shouldBuildText(r.name)&&f.push(v)}return{textDivs:f}}const p=[[r,-1,l]];for(;p.length>0;){const[v,y,w]=p.at(-1);if(y+1===v.children.length){p.pop();continue}const _=v.children[++p.at(-1)[1]];if(_===null)continue;const{name:S}=_;if(S==="#text"){const E=document.createTextNode(_.value);f.push(E),w.append(E);continue}const x=_?.attributes?.xmlns?document.createElementNS(_.attributes.xmlns,S):document.createElement(S);if(w.append(x),_.attributes&&this.setAttributes({html:x,element:_,storage:e,intent:o,linkService:s}),_.children?.length>0)p.push([_,-1,x]);else if(_.value){const E=document.createTextNode(_.value);u&&Ns.shouldBuildText(S)&&f.push(E),x.append(E)}}for(const v of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))v.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Os=1e3,Om=9,ni=new WeakSet;function Dn(g){return{width:g[2]-g[0],height:g[3]-g[1]}}class zm{static create(t){switch(t.data.annotationType){case Kt.LINK:return new $d(t);case Kt.TEXT:return new jm(t);case Kt.WIDGET:switch(t.data.fieldType){case"Tx":return new Bm(t);case"Btn":return t.data.radioButton?new Vd(t):t.data.checkBox?new Um(t):new $m(t);case"Ch":return new Vm(t);case"Sig":return new Hm(t)}return new ii(t);case Kt.POPUP:return new Pl(t);case Kt.FREETEXT:return new Gd(t);case Kt.LINE:return new Wm(t);case Kt.SQUARE:return new Xm(t);case Kt.CIRCLE:return new qm(t);case Kt.POLYLINE:return new Wd(t);case Kt.CARET:return new Km(t);case Kt.INK:return new Gl(t);case Kt.POLYGON:return new Ym(t);case Kt.HIGHLIGHT:return new Xd(t);case Kt.UNDERLINE:return new Qm(t);case Kt.SQUIGGLY:return new Zm(t);case Kt.STRIKEOUT:return new Jm(t);case Kt.STAMP:return new qd(t);case Kt.FILEATTACHMENT:return new tv(t);default:return new Vt(t)}}}class Vt{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:s=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(s)),r&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:s}){return!!(t?.str||e?.str||s?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Vt._hasPopupData(this.data)}updateEdited(t){if(!this.container)return;this.#t||={rect:this.data.rect.slice(0)};const{rect:e}=t;e&&this.#i(e),this.#n?.popup.updateEdited(t)}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:e},data:{rect:s,rotation:r},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:u,pageY:h}}}}=this;s?.splice(0,4,...t);const{width:f,height:p}=Dn(t);e.left=`${100*(t[0]-u)/o}%`,e.top=`${100*(l-t[3]+h)/l}%`,r===0?(e.width=`${100*f/o}%`,e.height=`${100*p/l}%`):this.setRotation(r)}_createContainer(t){const{data:e,parent:{page:s,viewport:r}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",e.id),this instanceof ii||(o.tabIndex=Os);const{style:l}=o;if(l.zIndex=this.parent.zIndex++,e.alternativeText&&(o.title=e.alternativeText),e.noRotate&&o.classList.add("norotate"),!e.rect||this instanceof Pl){const{rotation:S}=e;return!e.hasOwnCanvas&&S!==0&&this.setRotation(S,o),o}const{width:u,height:h}=Dn(e.rect);if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const S=e.borderStyle.horizontalCornerRadius,x=e.borderStyle.verticalCornerRadius;if(S>0||x>0){const M=`calc(${S}px * var(--scale-factor)) / calc(${x}px * var(--scale-factor))`;l.borderRadius=M}else if(this instanceof Vd){const M=`calc(${u}px * var(--scale-factor)) / calc(${h}px * var(--scale-factor))`;l.borderRadius=M}switch(e.borderStyle.style){case Es.SOLID:l.borderStyle="solid";break;case Es.DASHED:l.borderStyle="dashed";break;case Es.BEVELED:vt("Unimplemented border style: beveled");break;case Es.INSET:vt("Unimplemented border style: inset");break;case Es.UNDERLINE:l.borderBottomStyle="solid";break}const E=e.borderColor||null;E?(this.#e=!0,l.borderColor=st.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):l.borderWidth=0}const f=st.normalizeRect([e.rect[0],s.view[3]-e.rect[1]+s.view[1],e.rect[2],s.view[3]-e.rect[3]+s.view[1]]),{pageWidth:p,pageHeight:v,pageX:y,pageY:w}=r.rawDims;l.left=`${100*(f[0]-y)/p}%`,l.top=`${100*(f[1]-w)/v}%`;const{rotation:_}=e;return e.hasOwnCanvas||_===0?(l.width=`${100*u/p}%`,l.height=`${100*h/v}%`):this.setRotation(_,o),o}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:s,pageHeight:r}=this.parent.viewport.rawDims,{width:o,height:l}=Dn(this.data.rect);let u,h;t%180===0?(u=100*o/s,h=100*l/r):(u=100*l/s,h=100*o/r),e.style.width=`${u}%`,e.style.height=`${h}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,s,r)=>{const o=r.detail[e],l=o[0],u=o.slice(1);r.target.style[s]=wd[`${l}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[s]:wd[`${l}_rgb`](u)})};return _t(this,"_commonActions",{display:e=>{const{display:s}=e.detail,r=s%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:s===1||s===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:s}=e.detail;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:s,noView:s})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const s=e.detail.rotation;this.setRotation(s),this.annotationStorage.setValue(this.data.id,{rotation:s})}})}_dispatchEventFromSandbox(t,e){const s=this._commonActions;for(const r of Object.keys(e.detail))(t[r]||s[r])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const s=this._commonActions;for(const[r,o]of Object.entries(e)){const l=s[r];if(l){const u={detail:{[r]:o},target:t};l(u),delete e[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,s,r,o]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,x,E,M]=t.subarray(2,6);if(r===S&&o===x&&e===E&&s===M)return}const{style:l}=this.container;let u;if(this.#e){const{borderColor:S,borderWidth:x}=l;l.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${x}">`],this.container.classList.add("hasBorder")}const h=r-e,f=o-s,{svgFactory:p}=this,v=p.createElement("svg");v.classList.add("quadrilateralsContainer"),v.setAttribute("width",0),v.setAttribute("height",0);const y=p.createElement("defs");v.append(y);const w=p.createElement("clipPath"),_=`clippath_${this.data.id}`;w.setAttribute("id",_),w.setAttribute("clipPathUnits","objectBoundingBox"),y.append(w);for(let S=2,x=t.length;S<x;S+=8){const E=t[S],M=t[S+1],P=t[S+2],N=t[S+3],D=p.createElement("rect"),B=(P-e)/h,H=(o-M)/f,Z=(E-P)/h,it=(M-N)/f;D.setAttribute("x",B),D.setAttribute("y",H),D.setAttribute("width",Z),D.setAttribute("height",it),w.append(D),u?.push(`<rect vector-effect="non-scaling-stroke" x="${B}" y="${H}" width="${Z}" height="${it}"/>`)}this.#e&&(u.push("</g></svg>')"),l.backgroundImage=u.join("")),this.container.append(v),this.container.style.clipPath=`url(#${_})`}_createPopup(){const{data:t}=this,e=this.#n=new Pl({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]});this.parent.div.append(e.render())}render(){Rt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const s=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:o,id:l,exportValues:u}of r){if(o===-1||l===e)continue;const h=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!ni.has(f)){vt(`_getElementsByName - element not allowed: ${l}`);continue}s.push({id:l,exportValue:h,domElement:f})}return s}for(const r of document.getElementsByName(t)){const{exportValue:o}=r,l=r.getAttribute("data-element-id");l!==e&&ni.has(r)&&s.push({id:l,exportValue:o,domElement:r})}return s}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}}class $d extends Vt{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(e.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action),r=!0):t.attachment?(this.#e(s,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(this.#n(s,t.setOCGState),r=!0):t.dest?(this._bindLink(s,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(s),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t()}_bindNamedAction(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),this.#t()}#e(t,e,s=null){t.href=this.linkService.getAnchorUrl(""),e.description&&(t.title=e.description),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,s),!1),this.#t()}#n(t,e){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(e.actions)){const o=s.get(r);o&&(t[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:r}}),!1))}t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){vt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{s?.();const{fields:r,refs:o,include:l}=e,u=[];if(r.length!==0||o.length!==0){const p=new Set(o);for(const v of r){const y=this._fieldObjects[v]||[];for(const{id:w}of y)p.add(w)}for(const v of Object.values(this._fieldObjects))for(const y of v)p.has(y.id)===l&&u.push(y)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const h=this.annotationStorage,f=[];for(const p of u){const{id:v}=p;switch(f.push(v),p.type){case"text":{const w=p.defaultValue||"";h.setValue(v,{value:w});break}case"checkbox":case"radiobutton":{const w=p.defaultValue===p.exportValues;h.setValue(v,{value:w});break}case"combobox":case"listbox":{const w=p.defaultValue||"";h.setValue(v,{value:w});break}default:continue}const y=document.querySelector(`[data-element-id="${v}"]`);if(y){if(!ni.has(y)){vt(`_bindResetFormAction - element not allowed: ${v}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class jm extends Vt{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class ii extends Vt{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return ge.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,s,r,o){s.includes("mouse")?t.addEventListener(s,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(s,l=>{if(s==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(s==="focus"){if(e.focused)return;e.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:o(l)}})})}_setEventListeners(t,e,s,r){for(const[o,l]of s)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,o,l,r),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":st.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||Om,o=t.style;let l;const u=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(f/(vl*r))||1,v=f/p;l=Math.min(r,h(v/vl))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);l=Math.min(r,h(f/vl))}o.fontSize=`calc(${l}px * var(--scale-factor))`,o.color=st.makeHexColor(s[0],s[1],s[2]),this.data.textAlignment!==null&&(o.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class Bm extends ii{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,s,r){const o=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=s),o.setValue(l.id,{[r]:s})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let s=null;if(this.renderForms){const r=t.getValue(e,{value:this.data.fieldValue});let o=r.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=r.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=u??o,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",u??o),this.data.doNotScroll&&(s.style.overflowX="hidden")),this.data.hasOwnCanvas&&(s.hidden=!0),ni.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=Os,this._setRequired(s,this.data.required),l&&(s.maxLength=l),s.addEventListener("input",p=>{t.setValue(e,{value:p.target.value}),this.setPropertyOnSiblings(s,"value",p.target.value,"value"),h.formattedValue=null}),s.addEventListener("resetform",p=>{const v=this.data.defaultFieldValue??"";s.value=h.userValue=v,h.formattedValue=null});let f=p=>{const{formattedValue:v}=h;v!=null&&(p.target.value=v),p.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",v=>{if(h.focused)return;const{target:y}=v;h.userValue&&(y.value=h.userValue),h.lastCommittedValue=y.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),s.addEventListener("updatefromsandbox",v=>{this.showElementAndHideCanvas(v.target);const y={value(w){h.userValue=w.detail.value??"",t.setValue(e,{value:h.userValue.toString()}),w.target.value=h.userValue},formattedValue(w){const{formattedValue:_}=w.detail;h.formattedValue=_,_!=null&&w.target!==document.activeElement&&(w.target.value=_),t.setValue(e,{formattedValue:_})},selRange(w){w.target.setSelectionRange(...w.detail.selRange)},charLimit:w=>{const{charLimit:_}=w.detail,{target:S}=w;if(_===0){S.removeAttribute("maxLength");return}S.setAttribute("maxLength",_);let x=h.userValue;!x||x.length<=_||(x=x.slice(0,_),S.value=h.userValue=x,t.setValue(e,{value:x}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:x,willCommit:!0,commitKey:1,selStart:S.selectionStart,selEnd:S.selectionEnd}}))}};this._dispatchEventFromSandbox(y,v)}),s.addEventListener("keydown",v=>{h.commitKey=1;let y=-1;if(v.key==="Escape"?y=0:v.key==="Enter"&&!this.data.multiLine?y=2:v.key==="Tab"&&(h.commitKey=3),y===-1)return;const{value:w}=v.target;h.lastCommittedValue!==w&&(h.lastCommittedValue=w,h.userValue=w,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:w,willCommit:!0,commitKey:y,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}}))});const p=f;f=null,s.addEventListener("blur",v=>{if(!h.focused||!v.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{value:y}=v.target;h.userValue=y,h.lastCommittedValue!==y&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:y,willCommit:!0,commitKey:h.commitKey,selStart:v.target.selectionStart,selEnd:v.target.selectionEnd}}),p(v)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",v=>{h.lastCommittedValue=null;const{data:y,target:w}=v,{value:_,selectionStart:S,selectionEnd:x}=w;let E=S,M=x;switch(v.inputType){case"deleteWordBackward":{const P=_.substring(0,S).match(/\w*[^\w]*$/);P&&(E-=P[0].length);break}case"deleteWordForward":{const P=_.substring(S).match(/^[^\w]*\w*/);P&&(M+=P[0].length);break}case"deleteContentBackward":S===x&&(E-=1);break;case"deleteContentForward":S===x&&(M+=1);break}v.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,change:y||"",willCommit:!1,selStart:E,selEnd:M}})}),this._setEventListeners(s,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],v=>v.target.value)}if(f&&s.addEventListener("blur",f),this.data.comb){const v=(this.data.rect[2]-this.data.rect[0])/l;s.classList.add("comb"),s.style.letterSpacing=`calc(${v}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell",this.data.hasOwnCanvas&&(s.hidden=!0);return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Hm extends ii{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class Um extends ii{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,s=e.id;let r=t.getValue(s,{value:e.exportValue===e.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(s,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return ni.add(o),o.setAttribute("data-element-id",s),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=e.fieldName,r&&o.setAttribute("checked",!0),o.setAttribute("exportValue",e.exportValue),o.tabIndex=Os,o.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const f of this._getElementsByName(u,s)){const p=h&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(s,{value:h})}),o.addEventListener("resetform",l=>{const u=e.defaultFieldValue||"Off";l.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(s,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class Vd extends ii{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,s=e.id;let r=t.getValue(s,{value:e.fieldValue===e.buttonValue}).value;if(typeof r=="string"&&(r=r!==e.buttonValue,t.setValue(s,{value:r})),r)for(const l of this._getElementsByName(e.fieldName,s))t.setValue(l.id,{value:!1});const o=document.createElement("input");if(ni.add(o),o.setAttribute("data-element-id",s),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=e.fieldName,r&&o.setAttribute("checked",!0),o.tabIndex=Os,o.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const f of this._getElementsByName(u,s))t.setValue(f.id,{value:!1});t.setValue(s,{value:h})}),o.addEventListener("resetform",l=>{const u=e.defaultFieldValue;l.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;o.addEventListener("updatefromsandbox",u=>{const h={value:f=>{const p=l===f.detail.value;for(const v of this._getElementsByName(f.target.name)){const y=p&&v.id===s;v.domElement&&(v.domElement.checked=y),t.setValue(v.id,{value:y})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class $m extends $d{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",s=>{this._dispatchEventFromSandbox({},s)})),t}}class Vm extends ii{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,s=t.getValue(e,{value:this.data.fieldValue}),r=document.createElement("select");ni.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=Os;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",p=>{const v=this.data.defaultFieldValue;for(const y of r.options)y.selected=y.value===v});for(const p of this.data.options){const v=document.createElement("option");v.textContent=p.displayValue,v.value=p.exportValue,s.value.includes(p.exportValue)&&(v.setAttribute("selected",!0),o=!1),r.append(v)}let l=null;if(o){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),r.prepend(p),l=()=>{p.remove(),r.removeEventListener("input",l),l=null},r.addEventListener("input",l)}const u=p=>{const v=p?"value":"textContent",{options:y,multiple:w}=r;return w?Array.prototype.filter.call(y,_=>_.selected).map(_=>_[v]):y.selectedIndex===-1?null:y[y.selectedIndex][v]};let h=u(!1);const f=p=>{const v=p.target.options;return Array.prototype.map.call(v,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",p=>{const v={value(y){l?.();const w=y.detail.value,_=new Set(Array.isArray(w)?w:[w]);for(const S of r.options)S.selected=_.has(S.value);t.setValue(e,{value:u(!0)}),h=u(!1)},multipleSelection(y){r.multiple=!0},remove(y){const w=r.options,_=y.detail.remove;w[_].selected=!1,r.remove(_),w.length>0&&Array.prototype.findIndex.call(w,x=>x.selected)===-1&&(w[0].selected=!0),t.setValue(e,{value:u(!0),items:f(y)}),h=u(!1)},clear(y){for(;r.length!==0;)r.remove(0);t.setValue(e,{value:null,items:[]}),h=u(!1)},insert(y){const{index:w,displayValue:_,exportValue:S}=y.detail.insert,x=r.children[w],E=document.createElement("option");E.textContent=_,E.value=S,x?x.before(E):r.append(E),t.setValue(e,{value:u(!0),items:f(y)}),h=u(!1)},items(y){const{items:w}=y.detail;for(;r.length!==0;)r.remove(0);for(const _ of w){const{displayValue:S,exportValue:x}=_,E=document.createElement("option");E.textContent=S,E.value=x,r.append(E)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(y)}),h=u(!1)},indices(y){const w=new Set(y.detail.indices);for(const _ of y.target.options)_.selected=w.has(_.index);t.setValue(e,{value:u(!0)}),h=u(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(v,p)}),r.addEventListener("input",p=>{const v=u(!0),y=u(!1);t.setValue(e,{value:v}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:y,changeEx:v,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):r.addEventListener("input",function(p){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Pl extends Vt{constructor(t){const{data:e,elements:s}=t;super(t,{isRenderable:Vt._hasPopupData(e)}),this.elements=s,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new Gm({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",e.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(s=>`${Nl}${s}`).join(",")),this.container}}class Gm{#t=this.#k.bind(this);#e=this.#C.bind(this);#n=this.#T.bind(this);#i=this.#S.bind(this);#r=null;#s=null;#l=null;#o=null;#c=null;#u=null;#d=null;#h=!1;#f=null;#a=null;#p=null;#m=null;#g=null;#v=null;#A=!1;constructor({container:t,color:e,elements:s,titleObj:r,modificationDate:o,contentsObj:l,richText:u,parent:h,rect:f,parentRect:p,open:v}){this.#s=t,this.#g=r,this.#l=l,this.#m=u,this.#u=h,this.#r=e,this.#p=f,this.#d=p,this.#c=s,this.#o=Ed.toDateObject(o),this.trigger=s.flatMap(y=>y.getElementsToTriggerPopup());for(const y of this.trigger)y.addEventListener("click",this.#i),y.addEventListener("mouseenter",this.#n),y.addEventListener("mouseleave",this.#e),y.classList.add("popupTriggerArea");for(const y of s)y.container?.addEventListener("keydown",this.#t);this.#s.hidden=!0,v&&this.#S()}render(){if(this.#f)return;const t=this.#f=document.createElement("div");if(t.className="popup",this.#r){const o=t.style.outlineColor=st.makeHexColor(...this.#r);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${o} 30%, white)`:t.style.backgroundColor=st.makeHexColor(...this.#r.map(u=>Math.floor(.7*(255-u)+u)))}const e=document.createElement("span");e.className="header";const s=document.createElement("h1");if(e.append(s),{dir:s.dir,str:s.textContent}=this.#g,t.append(e),this.#o){const o=document.createElement("span");o.classList.add("popupDate"),o.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),o.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),e.append(o)}const r=this.#y;if(r)Ud.render({xfaHtml:r,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const o=this._formatContents(this.#l);t.append(o)}this.#s.append(t)}get#y(){const t=this.#m,e=this.#l;return t?.str&&(!e?.str||e.str===t.str)&&this.#m.html||null}get#_(){return this.#y?.attributes?.style?.fontSize||0}get#b(){return this.#y?.attributes?.style?.color||null}#x(t){const e=[],s={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},r={style:{color:this.#b,fontSize:this.#_?`calc(${this.#_}px * var(--scale-factor))`:""}};for(const o of t.split(`
`))e.push({name:"span",value:o,attributes:r});return s}_formatContents({str:t,dir:e}){const s=document.createElement("p");s.classList.add("popupContent"),s.dir=e;const r=t.split(/(?:\r\n?|\n)/);for(let o=0,l=r.length;o<l;++o){const u=r[o];s.append(document.createTextNode(u)),o<l-1&&s.append(document.createElement("br"))}return s}#k(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#h)&&this.#S()}updateEdited({rect:t,popupContent:e}){this.#v||={contentsObj:this.#l,richText:this.#m},t&&(this.#a=null),e&&(this.#m=this.#x(e),this.#l=null),this.#f?.remove(),this.#f=null}resetEdited(){this.#v&&({contentsObj:this.#l,richText:this.#m}=this.#v,this.#v=null,this.#f?.remove(),this.#f=null,this.#a=null)}#P(){if(this.#a!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:s,pageX:r,pageY:o}}}=this.#u;let l=!!this.#d,u=l?this.#d:this.#p;for(const _ of this.#c)if(!u||st.intersect(_.data.rect,u)!==null){u=_.data.rect,l=!0;break}const h=st.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=l?u[2]-u[0]+5:0,v=h[0]+p,y=h[1];this.#a=[100*(v-r)/e,100*(y-o)/s];const{style:w}=this.#s;w.left=`${this.#a[0]}%`,w.top=`${this.#a[1]}%`}#S(){this.#h=!this.#h,this.#h?(this.#T(),this.#s.addEventListener("click",this.#i),this.#s.addEventListener("keydown",this.#t)):(this.#C(),this.#s.removeEventListener("click",this.#i),this.#s.removeEventListener("keydown",this.#t))}#T(){this.#f||this.render(),this.isVisible?this.#h&&this.#s.classList.add("focused"):(this.#P(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#C(){this.#s.classList.remove("focused"),!(this.#h||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#A=this.isVisible,this.#A&&(this.#s.hidden=!0)}maybeShow(){this.#A&&(this.#f||this.#T(),this.#A=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}}class Gd extends Vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=mt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const s=document.createElement("span");s.textContent=e,t.append(s)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Wm extends Vt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:e,height:s}=Dn(t.rect),r=this.svgFactory.create(e,s,!0),o=this.#t=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Xm extends Vt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:e,height:s}=Dn(t.rect),r=this.svgFactory.create(e,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",e-o),l.setAttribute("height",s-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class qm extends Vt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:e,height:s}=Dn(t.rect),r=this.svgFactory.create(e,s,!0),o=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",e/2),l.setAttribute("cy",s/2),l.setAttribute("rx",e/2-o/2),l.setAttribute("ry",s/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Wd extends Vt{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:s,popupRef:r}}=this;if(!e)return this.container;const{width:o,height:l}=Dn(t),u=this.svgFactory.create(o,l,!0);let h=[];for(let p=0,v=e.length;p<v;p+=2){const y=e[p]-t[0],w=t[3]-e[p+1];h.push(`${y},${w}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ym extends Wd{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Km extends Vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Gl extends Vt{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?mt.HIGHLIGHT:mt.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:s,borderStyle:r,popupRef:o}}=this,{transform:l,width:u,height:h}=this.#n(e,t),f=this.svgFactory.create(u,h,!0),p=this.#t=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",r.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",l);for(let v=0,y=s.length;v<y;v++){const w=this.svgFactory.createElement(this.svgElementName);this.#e.push(w),w.setAttribute("points",s[v].join(",")),p.append(w)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:s,rect:r}=t,o=this.#t;if(e>=0&&o.setAttribute("stroke-width",e||1),s)for(let l=0,u=this.#e.length;l<u;l++)this.#e[l].setAttribute("points",s[l].join(","));if(r){const{transform:l,width:u,height:h}=this.#n(this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Xd extends Vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=mt.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class Qm extends Vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Zm extends Vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Jm extends Vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class qd extends Vt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=mt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class tv extends Vt{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let s;e.hasAppearance||e.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),s.addEventListener("dblclick",this.#e.bind(this)),this.#t=s;const{isMac:r}=ge.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class ev{#t=null;#e=null;#n=new Map;#i=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:s,annotationEditorUIManager:r,page:o,viewport:l,structTreeLayer:u}){this.div=t,this.#t=e,this.#e=s,this.#i=u||null,this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#n.size>0}async#r(t,e){const s=t.firstChild||t,r=s.id=`${Nl}${e}`,o=await this.#i?.getAriaAttributes(r);if(o)for(const[l,u]of o)s.setAttribute(l,u);this.div.append(t),this.#t?.moveElementInDOM(this.div,t,s,!1)}async render(t){const{annotations:e}=t,s=this.div;ei(s,this.viewport);const r=new Map,o={data:null,layer:s,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Vl,annotationStorage:t.annotationStorage||new Bl,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const u=l.annotationType===Kt.POPUP;if(u){const p=r.get(l.id);if(!p)continue;o.elements=p}else{const{width:p,height:v}=Dn(l.rect);if(p<=0||v<=0)continue}o.data=l;const h=zm.create(o);if(!h.isRenderable)continue;if(!u&&l.popupRef){const p=r.get(l.popupRef);p?p.push(h):r.set(l.popupRef,[h])}const f=h.render();l.hidden&&(f.style.visibility="hidden"),await this.#r(f,l.id),h._isEditable&&(this.#n.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#s()}update({viewport:t}){const e=this.div;this.viewport=t,ei(e,{rotation:t.rotation}),this.#s(),e.hidden=!1}#s(){if(!this.#e)return;const t=this.div;for(const[e,s]of this.#e){const r=t.querySelector(`[data-annotation-id="${e}"]`);if(!r)continue;s.className="annotationContent";const{firstChild:o}=r;o?o.nodeName==="CANVAS"?o.replaceWith(s):o.classList.contains("annotationContent")?o.after(s):o.before(s):r.append(s)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}}const Jr=/\r\n?|\n/g;class Qt extends ut{#t;#e="";#n=`${this.id}-editor`;#i=null;#r;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Qt.prototype,e=o=>o.isEmpty(),s=On.TRANSLATE_SMALL,r=On.TRANSLATE_BIG;return _t(this,"_keyboardManager",new Fs([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:e}]]))}static _type="freetext";static _editorType=mt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||Qt._defaultColor||ut._defaultLineColor,this.#r=t.fontSize||Qt._defaultFontSize}static initialize(t,e){ut.initialize(t,e);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Et.FREETEXT_SIZE:Qt._defaultFontSize=e;break;case Et.FREETEXT_COLOR:Qt._defaultColor=e;break}}updateParams(t,e){switch(t){case Et.FREETEXT_SIZE:this.#s(e);break;case Et.FREETEXT_COLOR:this.#l(e);break}}static get defaultPropertiesToUpdate(){return[[Et.FREETEXT_SIZE,Qt._defaultFontSize],[Et.FREETEXT_COLOR,Qt._defaultColor||ut._defaultLineColor]]}get propertiesToUpdate(){return[[Et.FREETEXT_SIZE,this.#r],[Et.FREETEXT_COLOR,this.#t]]}#s(t){const e=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-this.#r)*this.parentScale),this.#r=r,this.#c()},s=this.#r;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Et.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#l(t){const e=r=>{this.#t=this.editorDiv.style.color=r},s=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Et.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Qt._internalPadding*t,-(Qt._internalPadding+this.#r)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(mt.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();let e=null;for(const s of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&s.nodeName==="BR"||(t.push(Qt.#u(s)),e=s);return t.join(`
`)}#c(){const[t,e]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,l=o.style.display,u=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/e):(this.width=s.height/t,this.height=s.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#o().trimEnd();if(t===e)return;const s=r=>{if(this.#e=r,!r){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#c()};this.addCommands({cmd:()=>{s(e)},undo:()=>{s(t)},mustExec:!1}),this.#c()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Qt._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,e;this.width&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${this.#r}px * var(--scale-factor))`,s.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),ra(this,this.div,["dblclick","keydown"]),this.width){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[f,p]=this.pageDimensions,[v,y]=this.pageTranslation;let w,_;switch(this.rotation){case 0:w=t+(l[0]-v)/f,_=e+this.height-(l[1]-y)/p;break;case 90:w=t+(l[0]-v)/f,_=e-(l[1]-y)/p,[u,h]=[h,-u];break;case 180:w=t-this.width+(l[0]-v)/f,_=e-(l[1]-y)/p,[u,h]=[-u,-h];break;case 270:w=t+(l[0]-v-this.height*p)/f,_=e+(l[1]-y-this.width*f)/p,[u,h]=[-h,u];break}this.setAt(w*r,_*o,u,h)}else this.setAt(t*r,e*o,this.width*r,this.height*o);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#u(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Jr,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:s}=e;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=Qt.#f(e.getData("text")||"").replaceAll(Jr,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!r.includes(`
`)){l.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:u,startOffset:h}=l,f=[],p=[];if(u.nodeType===Node.TEXT_NODE){const w=u.parentElement;if(p.push(u.nodeValue.slice(h).replaceAll(Jr,"")),w!==this.editorDiv){let _=f;for(const S of this.editorDiv.childNodes){if(S===w){_=p;continue}_.push(Qt.#u(S))}}f.push(u.nodeValue.slice(0,h).replaceAll(Jr,""))}else if(u===this.editorDiv){let w=f,_=0;for(const S of this.editorDiv.childNodes)_++===h&&(w=p),w.push(Qt.#u(S))}this.#e=`${f.join(`
`)}${r}${p.join(`
`)}`,this.#d();const v=new Range;let y=f.reduce((w,_)=>w+_.length,0);for(const{firstChild:w}of this.editorDiv.childNodes)if(w.nodeType===Node.TEXT_NODE){const _=w.nodeValue.length;if(y<=_){v.setStart(w,y),v.setEnd(w,y);break}y-=_}o.removeAllRanges(),o.addRange(v)}#d(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#h(){return this.#e.replaceAll(" "," ")}static#f(t){return t.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}static async deserialize(t,e,s){let r=null;if(t instanceof Gd){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:h,rotation:f,id:p,popupRef:v},textContent:y,textPosition:w,parent:{page:{pageNumber:_}}}=t;if(!y||y.length===0)return null;r=t={annotationType:mt.FREETEXT,color:Array.from(u),fontSize:l,value:y.join(`
`),position:w,pageIndex:_-1,rect:h.slice(0),rotation:f,id:p,deleted:!1,popupRef:v}}const o=await super.deserialize(t,e,s);return o.#r=t.fontSize,o.#t=st.makeHexColor(...t.color),o.#e=Qt.#f(t.value),o.annotationElementId=t.id||null,o._initialData=r,o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Qt._internalPadding*this.parentScale,s=this.getRect(e,e),r=ut._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),o={annotationType:mt.FREETEXT,color:r,fontSize:this.#r,value:this.#h(),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?o:this.annotationElementId&&!this.#a(o)?null:(o.id=this.annotationElementId,o)}#a(t){const{value:e,fontSize:s,color:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||t.value!==e||t.fontSize!==s||t.color.some((l,u)=>l!==r[u])||t.pageIndex!==o}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(this.deleted)return e;const{style:s}=e;s.fontSize=`calc(${this.#r}px * var(--scale-factor))`,s.color=this.#t,e.replaceChildren();for(const o of this.#e.split(`
`)){const l=document.createElement("div");l.append(o?document.createTextNode(o):document.createElement("br")),e.append(l)}const r=Qt._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:this.#e}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class K{static PRECISION=1e-4;toSVGPath(){Rt("Abstract method `toSVGPath` must be implemented.")}get box(){Rt("Abstract getter `box` must be implemented.")}serialize(t,e){Rt("Abstract method `serialize` must be implemented.")}static _rescale(t,e,s,r,o,l){l||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)l[u]=e+t[u]*r,l[u+1]=s+t[u+1]*o;return l}static _rescaleAndSwap(t,e,s,r,o,l){l||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)l[u]=e+t[u+1]*r,l[u+1]=s+t[u]*o;return l}static _translate(t,e,s,r){r||=new Float32Array(t.length);for(let o=0,l=t.length;o<l;o+=2)r[o]=e+t[o],r[o+1]=s+t[o+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,s,r,o){switch(o){case 90:return[1-e/s,t/r];case 180:return[1-t/s,1-e/r];case 270:return[e/s,1-t/r];default:return[t/s,e/r]}}static _normalizePagePoint(t,e,s){switch(s){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,s,r,o,l){return[(t+5*s)/6,(e+5*r)/6,(5*s+o)/6,(5*r+l)/6,(s+o)/2,(r+l)/2]}}class Zn{#t;#e=[];#n;#i;#r=[];#s=new Float32Array(18);#l;#o;#c;#u;#d;#h;#f=[];static#a=8;static#p=2;static#m=Zn.#a+Zn.#p;constructor({x:t,y:e},s,r,o,l,u=0){this.#t=s,this.#h=o*r,this.#i=l,this.#s.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=u,this.#u=Zn.#a*r,this.#c=Zn.#m*r,this.#d=r,this.#f.push(t,e)}isEmpty(){return isNaN(this.#s[8])}#g(){const t=this.#s.subarray(4,6),e=this.#s.subarray(16,18),[s,r,o,l]=this.#t;return[(this.#l+(t[0]-e[0])/2-s)/o,(this.#o+(t[1]-e[1])/2-r)/l,(this.#l+(e[0]-t[0])/2-s)/o,(this.#o+(e[1]-t[1])/2-r)/l]}add({x:t,y:e}){this.#l=t,this.#o=e;const[s,r,o,l]=this.#t;let[u,h,f,p]=this.#s.subarray(8,12);const v=t-f,y=e-p,w=Math.hypot(v,y);if(w<this.#c)return!1;const _=w-this.#u,S=_/w,x=S*v,E=S*y;let M=u,P=h;u=f,h=p,f+=x,p+=E,this.#f?.push(t,e);const N=-E/_,D=x/_,B=N*this.#h,H=D*this.#h;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([f+B,p+H],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([f-B,p-H],16),isNaN(this.#s[6])?(this.#r.length===0&&(this.#s.set([u+B,h+H],2),this.#r.push(NaN,NaN,NaN,NaN,(u+B-s)/o,(h+H-r)/l),this.#s.set([u-B,h-H],14),this.#e.push(NaN,NaN,NaN,NaN,(u-B-s)/o,(h-H-r)/l)),this.#s.set([M,P,u,h,f,p],6),!this.isEmpty()):(this.#s.set([M,P,u,h,f,p],6),Math.abs(Math.atan2(P-h,M-u)-Math.atan2(E,x))<Math.PI/2?([u,h,f,p]=this.#s.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((u+f)/2-s)/o,((h+p)/2-r)/l),[u,h,M,P]=this.#s.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((M+u)/2-s)/o,((P+h)/2-r)/l),!0):([M,P,u,h,f,p]=this.#s.subarray(0,6),this.#r.push(((M+5*u)/6-s)/o,((P+5*h)/6-r)/l,((5*u+f)/6-s)/o,((5*h+p)/6-r)/l,((u+f)/2-s)/o,((h+p)/2-r)/l),[f,p,u,h,M,P]=this.#s.subarray(12,18),this.#e.push(((M+5*u)/6-s)/o,((P+5*h)/6-r)/l,((5*u+f)/6-s)/o,((5*h+p)/6-r)/l,((u+f)/2-s)/o,((h+p)/2-r)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#r,e=this.#e;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#v();const s=[];s.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?s.push(`L${t[r+4]} ${t[r+5]}`):s.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#y(s);for(let r=e.length-6;r>=6;r-=6)isNaN(e[r])?s.push(`L${e[r+4]} ${e[r+5]}`):s.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);return this.#A(s),s.join(" ")}#v(){const[t,e,s,r]=this.#t,[o,l,u,h]=this.#g();return`M${(this.#s[2]-t)/s} ${(this.#s[3]-e)/r} L${(this.#s[4]-t)/s} ${(this.#s[5]-e)/r} L${o} ${l} L${u} ${h} L${(this.#s[16]-t)/s} ${(this.#s[17]-e)/r} L${(this.#s[14]-t)/s} ${(this.#s[15]-e)/r} Z`}#A(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#y(t){const[e,s,r,o]=this.#t,l=this.#s.subarray(4,6),u=this.#s.subarray(16,18),[h,f,p,v]=this.#g();t.push(`L${(l[0]-e)/r} ${(l[1]-s)/o} L${h} ${f} L${p} ${v} L${(u[0]-e)/r} ${(u[1]-s)/o}`)}newFreeDrawOutline(t,e,s,r,o,l){return new Yd(t,e,s,r,o,l)}getOutlines(){const t=this.#r,e=this.#e,s=this.#s,[r,o,l,u]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let v=0,y=h.length-2;v<y;v+=2)h[v]=(this.#f[v]-r)/l,h[v+1]=(this.#f[v+1]-o)/u;if(h[h.length-2]=(this.#l-r)/l,h[h.length-1]=(this.#o-o)/u,isNaN(s[6])&&!this.isEmpty())return this.#_(h);const f=new Float32Array(this.#r.length+24+this.#e.length);let p=t.length;for(let v=0;v<p;v+=2){if(isNaN(t[v])){f[v]=f[v+1]=NaN;continue}f[v]=t[v],f[v+1]=t[v+1]}p=this.#x(f,p);for(let v=e.length-6;v>=6;v-=6)for(let y=0;y<6;y+=2){if(isNaN(e[v+y])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=e[v+y],f[p+1]=e[v+y+1],p+=2}return this.#b(f,p),this.newFreeDrawOutline(f,h,this.#t,this.#d,this.#n,this.#i)}#_(t){const e=this.#s,[s,r,o,l]=this.#t,[u,h,f,p]=this.#g(),v=new Float32Array(36);return v.set([NaN,NaN,NaN,NaN,(e[2]-s)/o,(e[3]-r)/l,NaN,NaN,NaN,NaN,(e[4]-s)/o,(e[5]-r)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(e[16]-s)/o,(e[17]-r)/l,NaN,NaN,NaN,NaN,(e[14]-s)/o,(e[15]-r)/l],0),this.newFreeDrawOutline(v,t,this.#t,this.#d,this.#n,this.#i)}#b(t,e){const s=this.#e;return t.set([NaN,NaN,NaN,NaN,s[4],s[5]],e),e+=6}#x(t,e){const s=this.#s.subarray(4,6),r=this.#s.subarray(16,18),[o,l,u,h]=this.#t,[f,p,v,y]=this.#g();return t.set([NaN,NaN,NaN,NaN,(s[0]-o)/u,(s[1]-l)/h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,v,y,NaN,NaN,NaN,NaN,(r[0]-o)/u,(r[1]-l)/h],e),e+=24}}class Yd extends K{#t;#e=new Float32Array(4);#n;#i;#r;#s;#l;constructor(t,e,s,r,o,l){super(),this.#l=t,this.#r=e,this.#t=s,this.#s=r,this.#n=o,this.#i=l,this.lastPoint=[NaN,NaN],this.#o(l);const[u,h,f,p]=this.#e;for(let v=0,y=t.length;v<y;v+=2)t[v]=(t[v]-u)/f,t[v+1]=(t[v+1]-h)/p;for(let v=0,y=e.length;v<y;v+=2)e[v]=(e[v]-u)/f,e[v+1]=(e[v+1]-h)/p}toSVGPath(){const t=[`M${this.#l[4]} ${this.#l[5]}`];for(let e=6,s=this.#l.length;e<s;e+=6){if(isNaN(this.#l[e])){t.push(`L${this.#l[e+4]} ${this.#l[e+5]}`);continue}t.push(`C${this.#l[e]} ${this.#l[e+1]} ${this.#l[e+2]} ${this.#l[e+3]} ${this.#l[e+4]} ${this.#l[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,s,r],o){const l=s-t,u=r-e;let h,f;switch(o){case 0:h=K._rescale(this.#l,t,r,l,-u),f=K._rescale(this.#r,t,r,l,-u);break;case 90:h=K._rescaleAndSwap(this.#l,t,e,l,u),f=K._rescaleAndSwap(this.#r,t,e,l,u);break;case 180:h=K._rescale(this.#l,s,e,-l,u),f=K._rescale(this.#r,s,e,-l,u);break;case 270:h=K._rescaleAndSwap(this.#l,s,r,-l,-u),f=K._rescaleAndSwap(this.#r,s,r,-l,-u);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(t){const e=this.#l;let s=e[4],r=e[5],o=s,l=r,u=s,h=r,f=s,p=r;const v=t?Math.max:Math.min;for(let w=6,_=e.length;w<_;w+=6){if(isNaN(e[w]))o=Math.min(o,e[w+4]),l=Math.min(l,e[w+5]),u=Math.max(u,e[w+4]),h=Math.max(h,e[w+5]),p<e[w+5]?(f=e[w+4],p=e[w+5]):p===e[w+5]&&(f=v(f,e[w+4]));else{const S=st.bezierBoundingBox(s,r,...e.slice(w,w+6));o=Math.min(o,S[0]),l=Math.min(l,S[1]),u=Math.max(u,S[2]),h=Math.max(h,S[3]),p<S[3]?(f=S[2],p=S[3]):p===S[3]&&(f=v(f,S[2]))}s=e[w+4],r=e[w+5]}const y=this.#e;y[0]=o-this.#n,y[1]=l-this.#n,y[2]=u-o+2*this.#n,y[3]=h-l+2*this.#n,this.lastPoint=[f,p]}get box(){return this.#e}newOutliner(t,e,s,r,o,l=0){return new Zn(t,e,s,r,o,l)}getNewOutline(t,e){const[s,r,o,l]=this.#e,[u,h,f,p]=this.#t,v=o*f,y=l*p,w=s*f+u,_=r*p+h,S=this.newOutliner({x:this.#r[0]*v+w,y:this.#r[1]*y+_},this.#t,this.#s,t,this.#i,e??this.#n);for(let x=2;x<this.#r.length;x+=2)S.add({x:this.#r[x]*v+w,y:this.#r[x+1]*y+_});return S.getOutlines()}}class Rl{#t;#e;#n=[];#i=[];constructor(t,e=0,s=0,r=!0){let o=1/0,l=-1/0,u=1/0,h=-1/0;const f=10**-4;for(const{x,y:E,width:M,height:P}of t){const N=Math.floor((x-e)/f)*f,D=Math.ceil((x+M+e)/f)*f,B=Math.floor((E-e)/f)*f,H=Math.ceil((E+P+e)/f)*f,Z=[N,B,H,!0],it=[D,B,H,!1];this.#n.push(Z,it),o=Math.min(o,N),l=Math.max(l,D),u=Math.min(u,B),h=Math.max(h,H)}const p=l-o+2*s,v=h-u+2*s,y=o-s,w=u-s,_=this.#n.at(r?-1:-2),S=[_[0],_[2]];for(const x of this.#n){const[E,M,P]=x;x[0]=(E-y)/p,x[1]=(M-w)/v,x[2]=(P-w)/v}this.#t=new Float32Array([y,w,p,v]),this.#e=S}getOutlines(){this.#n.sort((e,s)=>e[0]-s[0]||e[1]-s[1]||e[2]-s[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#c(e)),this.#l(e)):(this.#o(e),t.push(...this.#c(e)));return this.#r(t)}#r(t){const e=[],s=new Set;for(const l of t){const[u,h,f]=l;e.push([u,h,l],[u,f,l])}e.sort((l,u)=>l[1]-u[1]||l[0]-u[0]);for(let l=0,u=e.length;l<u;l+=2){const h=e[l][2],f=e[l+1][2];h.push(f),f.push(h),s.add(h),s.add(f)}const r=[];let o;for(;s.size>0;){const l=s.values().next().value;let[u,h,f,p,v]=l;s.delete(l);let y=u,w=h;for(o=[u,f],r.push(o);;){let _;if(s.has(p))_=p;else if(s.has(v))_=v;else break;s.delete(_),[u,h,f,p,v]=_,y!==u&&(o.push(y,w,u,w===h?h:f),y=u),w=w===h?f:h}o.push(y,w)}return new nv(r,this.#t,this.#e)}#s(t){const e=this.#i;let s=0,r=e.length-1;for(;s<=r;){const o=s+r>>1,l=e[o][0];if(l===t)return o;l<t?s=o+1:r=o-1}return r+1}#l([,t,e]){const s=this.#s(t);this.#i.splice(s,0,[t,e])}#o([,t,e]){const s=this.#s(t);for(let r=s;r<this.#i.length;r++){const[o,l]=this.#i[r];if(o!==t)break;if(o===t&&l===e){this.#i.splice(r,1);return}}for(let r=s-1;r>=0;r--){const[o,l]=this.#i[r];if(o!==t)break;if(o===t&&l===e){this.#i.splice(r,1);return}}}#c(t){const[e,s,r]=t,o=[[e,s,r]],l=this.#s(r);for(let u=0;u<l;u++){const[h,f]=this.#i[u];for(let p=0,v=o.length;p<v;p++){const[,y,w]=o[p];if(!(f<=y||w<=h)){if(y>=h){if(w>f)o[p][1]=f;else{if(v===1)return[];o.splice(p,1),p--,v--}continue}o[p][2]=h,w>f&&o.push([e,f,w])}}}return o}}class nv extends K{#t;#e;constructor(t,e,s){super(),this.#e=t,this.#t=e,this.lastPoint=s}toSVGPath(){const t=[];for(const e of this.#e){let[s,r]=e;t.push(`M${s} ${r}`);for(let o=2;o<e.length;o+=2){const l=e[o],u=e[o+1];l===s?(t.push(`V${u}`),r=u):u===r&&(t.push(`H${l}`),s=l)}t.push("Z")}return t.join(" ")}serialize([t,e,s,r],o){const l=[],u=s-t,h=r-e;for(const f of this.#e){const p=new Array(f.length);for(let v=0;v<f.length;v+=2)p[v]=t+f[v]*u,p[v+1]=r-f[v+1]*h;l.push(p)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class Ml extends Zn{newFreeDrawOutline(t,e,s,r,o,l){return new iv(t,e,s,r,o,l)}}class iv extends Yd{newOutliner(t,e,s,r,o,l=0){return new Ml(t,e,s,r,o,l)}}class ze{#t=null;#e=null;#n;#i=null;#r=!1;#s=!1;#l=null;#o;#c=null;#u=null;#d;static#h=null;static get _keyboardManager(){return _t(this,"_keyboardManager",new Fs([[["Escape","mac+Escape"],ze.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ze.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ze.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ze.prototype._moveToPrevious],[["Home","mac+Home"],ze.prototype._moveToBeginning],[["End","mac+End"],ze.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#s=!1,this.#d=Et.HIGHLIGHT_COLOR,this.#l=t):(this.#s=!0,this.#d=Et.HIGHLIGHT_DEFAULT_COLOR),this.#u=t?._uiManager||e,this.#o=this.#u._eventBus,this.#n=t?.color||this.#u?.highlightColors.values().next().value||"#FFFF98",ze.#h||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=this.#u._signal;t.addEventListener("click",this.#m.bind(this),{signal:e}),t.addEventListener("keydown",this.#p.bind(this),{signal:e});const s=this.#e=document.createElement("span");return s.className="swatch",s.setAttribute("aria-hidden",!0),s.style.backgroundColor=this.#n,t.append(s),t}renderMainDropdown(){const t=this.#i=this.#f();return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}#f(){const t=document.createElement("div"),e=this.#u._signal;t.addEventListener("contextmenu",Ye,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[s,r]of this.#u.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",r),o.title=s,o.setAttribute("data-l10n-id",ze.#h[s]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=r,o.setAttribute("aria-selected",r===this.#n),o.addEventListener("click",this.#a.bind(this,r),{signal:e}),t.append(o)}return t.addEventListener("keydown",this.#p.bind(this),{signal:e}),t}#a(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:this.#d,value:t})}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const e=t.target.getAttribute("data-color");e&&this.#a(e,t)}_moveToNext(t){if(!this.#v){this.#m(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#v&&this._hideDropdownFromKeyboard();return}this.#v||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#v){this.#m(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#v){this.#m(t);return}this.#i.lastChild?.focus()}#p(t){ze._keyboardManager.exec(this,t)}#m(t){if(this.#v){this.hideDropdown();return}if(this.#r=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#g.bind(this),{signal:this.#u.combinedSignal(this.#c)})),this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#f();this.#t.append(e)}#g(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#c?.abort(),this.#c=null}get#v(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#v){this.#l?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#u.highlightColors.values();for(const s of this.#i.children)s.setAttribute("aria-selected",e.next().value===t)}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class $t extends ut{#t=null;#e=0;#n;#i=null;#r=null;#s=null;#l=null;#o=0;#c=null;#u=null;#d=null;#h=!1;#f=null;#a;#p=null;#m="";#g;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=mt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=$t.prototype;return _t(this,"_keyboardManager",new Fs([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||$t._defaultColor,this.#g=t.thickness||$t._defaultThickness,this.#a=t.opacity||$t._defaultOpacity,this.#n=t.boxes||null,this.#v=t.methodOfCreation||"",this.#m=t.text||"",this._isDraggable=!1,t.highlightId>-1?(this.#h=!0,this.#y(t),this.#P()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#l=t.focusNode,this.#o=t.focusOffset,this.#A(),this.#P(),this.rotate(this.rotation))}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:this.#g,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#A(){const t=new Rl(this.#n,.001);this.#u=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#u.box;const e=new Rl(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=e.getOutlines();const{lastPoint:s}=this.#s;this.#f=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:e,clipPathId:s}){this.#u=t;const r=1.5;if(this.#s=t.getNewOutline(this.#g/2+r,.0025),e>=0)this.#d=e,this.#i=s,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:$t.#S(this.#u.box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:$t.#S(this.#s.box,p),path:{d:this.#s.toSVGPath()}})}const[o,l,u,h]=t.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=u,this.height=h;break;case 90:{const[p,v]=this.parentDimensions;this.x=l,this.y=1-o,this.width=u*v/p,this.height=h*p/v;break}case 180:this.x=1-o,this.y=1-l,this.width=u,this.height=h;break;case 270:{const[p,v]=this.parentDimensions;this.x=1-l,this.y=o,this.width=u*v/p,this.height=h*p/v;break}}const{lastPoint:f}=this.#s;this.#f=[(f[0]-o)/u,(f[1]-l)/h]}static initialize(t,e){ut.initialize(t,e),$t._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Et.HIGHLIGHT_DEFAULT_COLOR:$t._defaultColor=e;break;case Et.HIGHLIGHT_THICKNESS:$t._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#f}updateParams(t,e){switch(t){case Et.HIGHLIGHT_COLOR:this.#_(e);break;case Et.HIGHLIGHT_THICKNESS:this.#b(e);break}}static get defaultPropertiesToUpdate(){return[[Et.HIGHLIGHT_DEFAULT_COLOR,$t._defaultColor],[Et.HIGHLIGHT_THICKNESS,$t._defaultThickness]]}get propertiesToUpdate(){return[[Et.HIGHLIGHT_COLOR,this.color||$t._defaultColor],[Et.HIGHLIGHT_THICKNESS,this.#g||$t._defaultThickness],[Et.HIGHLIGHT_FREE,this.#h]]}#_(t){const e=(o,l)=>{this.color=o,this.#a=l,this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:o,"fill-opacity":l}}),this.#r?.updateColor(o)},s=this.color,r=this.#a;this.addCommands({cmd:e.bind(this,t,$t._defaultOpacity),undo:e.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Et.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)}#b(t){const e=this.#g,s=r=>{this.#g=r,this.#x(r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Et.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(this.#r=new ze({editor:this}),t.addColorPicker(this.#r)),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#M())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#M())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#k(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#P(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#k():t&&(this.#P(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#x(t){if(!this.#h)return;this.#y({highlightOutlines:this.#u.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,s]=this.parentDimensions;this.setDims(this.width*e,this.height*s)}#k(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#P(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#u.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#a},rootClass:{highlight:!0,free:this.#h},path:{d:this.#u.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#i))}static#S([t,e,s,r],o){switch(o){case 90:return[1-e-r,t,r,s];case 180:return[1-t-s,1-e-r,s,r];case 270:return[e,1-t-s,r,s]}return[t,e,s,r]}rotate(t){const{drawLayer:e}=this.parent;let s;this.#h?(t=(t-this.rotation+360)%360,s=$t.#S(this.#u.box,t)):s=$t.#S([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:s,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:$t.#S(this.#s.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#m&&(t.setAttribute("aria-label",this.#m),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#T.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i;const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),ra(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#T(t){$t._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#C(!0);break;case 1:case 3:this.#C(!1);break}}#C(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#l,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#h||this.#C(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#M(){return this.#h?this.rotation:0}#N(){if(this.#h)return null;const[t,e]=this.pageDimensions,[s,r]=this.pageTranslation,o=this.#n,l=new Float32Array(o.length*8);let u=0;for(const{x:h,y:f,width:p,height:v}of o){const y=h*t+s,w=(1-f)*e+r;l[u]=l[u+4]=y,l[u+1]=l[u+3]=w,l[u+2]=l[u+6]=y+p*t,l[u+5]=l[u+7]=w-v*e,u+=8}return l}#F(t){return this.#u.serialize(t,this.#M())}static startHighlighting(t,e,{target:s,x:r,y:o}){const{x:l,y:u,width:h,height:f}=s.getBoundingClientRect(),p=new AbortController,v=t.combinedSignal(p),y=w=>{p.abort(),this.#w(t,w)};window.addEventListener("blur",y,{signal:v}),window.addEventListener("pointerup",y,{signal:v}),window.addEventListener("pointerdown",Re,{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",Ye,{signal:v}),s.addEventListener("pointermove",this.#E.bind(this,t),{signal:v}),this._freeHighlight=new Ml({x:r,y:o},[l,u,h,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#E(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#w(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,s){let r=null;if(t instanceof Xd){const{data:{quadPoints:_,rect:S,rotation:x,id:E,color:M,opacity:P,popupRef:N},parent:{page:{pageNumber:D}}}=t;r=t={annotationType:mt.HIGHLIGHT,color:Array.from(M),opacity:P,quadPoints:_,boxes:null,pageIndex:D-1,rect:S.slice(0),rotation:x,id:E,deleted:!1,popupRef:N}}else if(t instanceof Gl){const{data:{inkLists:_,rect:S,rotation:x,id:E,color:M,borderStyle:{rawWidth:P},popupRef:N},parent:{page:{pageNumber:D}}}=t;r=t={annotationType:mt.HIGHLIGHT,color:Array.from(M),thickness:P,inkLists:_,boxes:null,pageIndex:D-1,rect:S.slice(0),rotation:x,id:E,deleted:!1,popupRef:N}}const{color:o,quadPoints:l,inkLists:u,opacity:h}=t,f=await super.deserialize(t,e,s);f.color=st.makeHexColor(...o),f.#a=h||1,u&&(f.#g=t.thickness),f.annotationElementId=t.id||null,f._initialData=r;const[p,v]=f.pageDimensions,[y,w]=f.pageTranslation;if(l){const _=f.#n=[];for(let S=0;S<l.length;S+=8)_.push({x:(l[S]-y)/p,y:1-(l[S+1]-w)/v,width:(l[S+2]-l[S])/p,height:(l[S+1]-l[S+5])/v});f.#A(),f.#P(),f.rotate(f.rotation)}else if(u){f.#h=!0;const _=u[0],S={x:_[0]-y,y:v-(_[1]-w)},x=new Ml(S,[0,0,p,v],1,f.#g/2,!0,.001);for(let P=0,N=_.length;P<N;P+=2)S.x=_[P]-y,S.y=v-(_[P+1]-w),x.add(S);const{id:E,clipPathId:M}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:x.toSVGPath()}},!0,!0);f.#y({highlightOutlines:x.getOutlines(),highlightId:E,clipPathId:M}),f.#P()}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getRect(0,0),s=ut._colorManager.convert(this.color),r={annotationType:mt.HIGHLIGHT,color:s,opacity:this.#a,thickness:this.#g,quadPoints:this.#N(),outlines:this.#F(e),pageIndex:this.pageIndex,rect:e,rotation:this.#M(),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!this.#I(r)?null:(r.id=this.annotationElementId,r)}#I(t){const{color:e}=this._initialData;return t.color.some((s,r)=>s!==e[r])}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class sv{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,s]of Object.entries(t))this.updateProperty(e,s)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Rt("Not implemented")}}class lt extends ut{#t=null;#e;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#r=null;static#s=NaN;static#l=null;static#o=null;static#c=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,t.drawOutlines&&(this.#u(t),this.#f())}#u({drawOutlines:t,drawId:e,drawingOptions:s}){this.#t=t,this._drawingOptions||=s,e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#m(t.box)}#d(t,e){const{id:s}=e.drawLayer.draw(lt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s}static _mergeSVGProperties(t,e){const s=new Set(Object.keys(t));for(const[r,o]of Object.entries(e))s.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){Rt("Not implemented")}static get typesMap(){Rt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,e),this._currentParent&&(lt.#n.updateProperty(s,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,e[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,e[r]]);return t}_updateProperty(t,e,s){const r=this._drawingOptions,o=r[e],l=u=>{r.updateProperty(e,u);const h=this.#t.updateProperty(e,u);h&&this.#m(h),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:l.bind(this,s),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,lt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,lt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g(t,e)})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,lt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#h(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#m(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#h()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#h(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#a([t,e,s,r]){const{parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[e,1-t,s*(l/o),r*(o/l)];case 180:return[1-t,1-e,s,r];case 270:return[1-e,t,s*(l/o),r*(o/l)];default:return[t,e,s,r]}}#p(){const{x:t,y:e,width:s,height:r,parentDimensions:[o,l],rotation:u}=this;switch(u){case 90:return[1-e,t,s*(o/l),r*(l/o)];case 180:return[1-t,1-e,s,r];case 270:return[e,1-t,s*(o/l),r*(l/o)];default:return[t,e,s,r]}}#m(t){if([this.x,this.y,this.width,this.height]=this.#a(t),this.div){this.fixAndSetPosition();const[e,s]=this.parentDimensions;this.setDims(this.width*e,this.height*s)}this._onResized()}#g(){const{x:t,y:e,width:s,height:r,rotation:o,parentRotation:l,parentDimensions:[u,h]}=this;switch((o*4+l)/90){case 1:return[1-e-r,t,r,s];case 2:return[1-t-s,1-e-r,s,r];case 3:return[e,1-t-s,r,s];case 4:return[t,e-s*(u/h),r*(h/u),s*(u/h)];case 5:return[1-e,t,s*(u/h),r*(h/u)];case 6:return[1-t-r*(h/u),1-e,r*(h/u),s*(u/h)];case 7:return[e-s*(u/h),1-t-r*(h/u),s*(u/h),r*(h/u)];case 8:return[t-s,e-r,s,r];case 9:return[1-e,t-s,r,s];case 10:return[1-t,1-e,s,r];case 11:return[e-r,1-t,r,s];case 12:return[t-r*(h/u),e,r*(h/u),s*(u/h)];case 13:return[1-e-s*(u/h),t-r*(h/u),s*(u/h),r*(h/u)];case 14:return[1-t,1-e-s*(u/h),r*(h/u),s*(u/h)];case 15:return[e,1-t,s*(u/h),r*(h/u)];default:return[t,e,s,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,lt._mergeSVGProperties({bbox:this.#g()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#m(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const e=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal";const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,e,s,r,o){Rt("Not implemented")}static startDrawing(t,e,s,r){const{target:o,offsetX:l,offsetY:u,pointerId:h,pointerType:f}=r;if(lt.#l&&lt.#l!==f)return;const{viewport:{rotation:p}}=t,{width:v,height:y}=o.getBoundingClientRect(),w=lt.#i=new AbortController,_=t.combinedSignal(w);if(lt.#s||=h,lt.#l??=f,window.addEventListener("pointerup",S=>{lt.#s===S.pointerId?this._endDraw(S):lt.#o?.delete(S.pointerId)},{signal:_}),window.addEventListener("pointercancel",S=>{lt.#s===S.pointerId?this._currentParent.endDrawingSession():lt.#o?.delete(S.pointerId)},{signal:_}),window.addEventListener("pointerdown",S=>{lt.#l===S.pointerType&&((lt.#o||=new Set).add(S.pointerId),lt.#n.isCancellable()&&(lt.#n.removeLastElement(),lt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",Ye,{signal:_}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:_}),o.addEventListener("touchmove",S=>{S.timeStamp===lt.#c&&Re(S)},{signal:_}),t.toggleDrawing(),e._editorUndoBar?.hide(),lt.#n){t.drawLayer.updateProperties(this._currentDrawId,lt.#n.startNew(l,u,v,y,p));return}e.updateUIForDefaultProperties(this),lt.#n=this.createDrawerInstance(l,u,v,y,p),lt.#r=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(lt.#r.toSVGProperties(),lt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(lt.#c=-1,!lt.#n)return;const{offsetX:e,offsetY:s,pointerId:r}=t;if(lt.#s===r){if(lt.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,lt.#n.add(e,s)),lt.#c=t.timeStamp,Re(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,lt.#n=null,lt.#r=null,lt.#l=null,lt.#c=NaN),lt.#i&&(lt.#i.abort(),lt.#i=null,lt.#s=NaN,lt.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t&&e.drawLayer.updateProperties(this._currentDrawId,lt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=lt.#n,r=this._currentDrawId,o=s.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(r,s.setLastElement(o))},undo:()=>{e.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:Et.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Et.DRAW_STEP),!lt.#n.isEmpty()){const{pageDimensions:[s,r],scale:o}=e,l=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:lt.#n.getOutlines(s*o,r*o,o,this._INNER_MARGIN),drawingOptions:lt.#r,mustBeCommitted:!t});return this._cleanup(!0),l}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,s,r,o,l){Rt("Not implemented")}static async deserialize(t,e,s){const{rawDims:{pageWidth:r,pageHeight:o,pageX:l,pageY:u}}=e.viewport,h=this.deserializeDraw(l,u,r,o,this._INNER_MARGIN,t),f=await super.deserialize(t,e,s);return f.createDrawingOptions(t),f.#u({drawOutlines:h}),f.#f(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,s]=this.pageTranslation,[r,o]=this.pageDimensions;return this.#t.serialize([e,s,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}}class rv{#t=new Float64Array(6);#e;#n;#i;#r;#s;#l="";#o=0;#c=new ma;#u;#d;constructor(t,e,s,r,o,l){this.#u=s,this.#d=r,this.#i=o,this.#r=l,[t,e]=this.#h(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e],this.#n=[{line:u,points:this.#s}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#r=e)}#h(t,e){return K._normalizePoint(t,e,this.#u,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#s.length<=10}add(t,e){[t,e]=this.#h(t,e);const[s,r,o,l]=this.#t.subarray(2,6),u=t-o,h=e-l;return Math.hypot(this.#u*u,this.#d*h)<=2?null:(this.#s.push(t,e),isNaN(s)?(this.#t.set([o,l,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([s,r,o,l,t,e],0),this.#e.push(...K.createBezierPoints(s,r,o,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const s=this.add(t,e);return s||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,s,r,o){this.#u=s,this.#d=r,this.#i=o,[t,e]=this.#h(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:l,points:this.#s}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#s=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#l="";for(let t=0,e=this.#n.length;t<e;t++){const{line:s,points:r}=this.#n[t];this.#e=s,this.#s=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#l}}}toSVGPath(){const t=K.svgRound(this.#e[4]),e=K.svgRound(this.#e[5]);if(this.#s.length===2)return this.#l=`${this.#l} M ${t} ${e} Z`,this.#l;if(this.#s.length<=6){const r=this.#l.lastIndexOf("M");this.#l=`${this.#l.slice(0,r)} M ${t} ${e}`,this.#o=6}if(this.#s.length===4){const r=K.svgRound(this.#e[10]),o=K.svgRound(this.#e[11]);return this.#l=`${this.#l} L ${r} ${o}`,this.#o=12,this.#l}const s=[];this.#o===0&&(s.push(`M ${t} ${e}`),this.#o=6);for(let r=this.#o,o=this.#e.length;r<o;r+=6){const[l,u,h,f,p,v]=this.#e.slice(r,r+6).map(K.svgRound);s.push(`C${l} ${u} ${h} ${f} ${p} ${v}`)}return this.#l+=s.join(" "),this.#o=this.#e.length,this.#l}getOutlines(t,e,s,r){const o=this.#n.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#n,t,e,s,this.#i,this.#r,r),this.#t=null,this.#e=null,this.#n=null,this.#l=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class ma extends K{#t;#e=0;#n;#i;#r;#s;#l;#o;#c;build(t,e,s,r,o,l,u){this.#r=e,this.#s=s,this.#l=r,this.#o=o,this.#c=l,this.#n=u??0,this.#i=t,this.#h()}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${K.svgRound(e[4])} ${K.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12){t.push(`L${K.svgRound(e[10])} ${K.svgRound(e[11])}`);continue}for(let s=6,r=e.length;s<r;s+=6){const[o,l,u,h,f,p]=e.subarray(s,s+6).map(K.svgRound);t.push(`C${o} ${l} ${u} ${h} ${f} ${p}`)}}return t.join("")}serialize([t,e,s,r],o){const l=[],u=[],[h,f,p,v]=this.#d();let y,w,_,S,x,E,M,P,N;switch(this.#o){case 0:N=K._rescale,y=t,w=e+r,_=s,S=-r,x=t+h*s,E=e+(1-f-v)*r,M=t+(h+p)*s,P=e+(1-f)*r;break;case 90:N=K._rescaleAndSwap,y=t,w=e,_=s,S=r,x=t+f*s,E=e+h*r,M=t+(f+v)*s,P=e+(h+p)*r;break;case 180:N=K._rescale,y=t+s,w=e,_=-s,S=r,x=t+(1-h-p)*s,E=e+f*r,M=t+(1-h)*s,P=e+(f+v)*r;break;case 270:N=K._rescaleAndSwap,y=t+s,w=e+r,_=-s,S=-r,x=t+(1-f-v)*s,E=e+(1-h-p)*r,M=t+(1-f)*s,P=e+(1-h)*r;break}for(const{line:D,points:B}of this.#i)l.push(N(D,y,w,_,S,o?new Array(D.length):null)),u.push(N(B,y,w,_,S,o?new Array(B.length):null));return{lines:l,points:u,rect:[x,E,M,P]}}static deserialize(t,e,s,r,o,{paths:{lines:l,points:u},rotation:h,thickness:f}){const p=[];let v,y,w,_,S;switch(h){case 0:S=K._rescale,v=-t/s,y=e/r+1,w=1/s,_=-1/r;break;case 90:S=K._rescaleAndSwap,v=-e/r,y=-t/s,w=1/r,_=1/s;break;case 180:S=K._rescale,v=t/s+1,y=-e/r,w=-1/s,_=1/r;break;case 270:S=K._rescaleAndSwap,v=e/r+1,y=t/s+1,w=-1/r,_=-1/s;break}if(!l){l=[];for(const E of u){const M=E.length;if(M===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(M===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const P=new Float32Array(3*(M-2));l.push(P);let[N,D,B,H]=E.subarray(0,4);P.set([NaN,NaN,NaN,NaN,N,D],0);for(let Z=4;Z<M;Z+=2){const it=E[Z],gt=E[Z+1];P.set(K.createBezierPoints(N,D,B,H,it,gt),(Z-2)*3),[N,D,B,H]=[B,H,it,gt]}}}for(let E=0,M=l.length;E<M;E++)p.push({line:S(l[E].map(P=>P??NaN),v,y,w,_),points:S(u[E].map(P=>P??NaN),v,y,w,_)});const x=new ma;return x.build(p,s,r,1,h,f,o),x}#u(t=this.#c){const e=this.#n+t/2*this.#l;return this.#o%180===0?[e/this.#r,e/this.#s]:[e/this.#s,e/this.#r]}#d(){const[t,e,s,r]=this.#t,[o,l]=this.#u(0);return[t+o,e+l,s-2*o,r-2*l]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#i){if(r.length<=12){for(let u=4,h=r.length;u<h;u+=6){const[f,p]=r.subarray(u,u+2);t[0]=Math.min(t[0],f),t[1]=Math.min(t[1],p),t[2]=Math.max(t[2],f),t[3]=Math.max(t[3],p)}continue}let o=r[4],l=r[5];for(let u=6,h=r.length;u<h;u+=6){const[f,p,v,y,w,_]=r.subarray(u,u+6);st.bezierBoundingBox(o,l,f,p,v,y,w,_,t),o=w,l=_}}const[e,s]=this.#u();t[0]=Math.min(1,Math.max(0,t[0]-e)),t[1]=Math.min(1,Math.max(0,t[1]-s)),t[2]=Math.min(1,Math.max(0,t[2]+e)),t[3]=Math.min(1,Math.max(0,t[3]+s)),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,s]=this.#u();this.#c=t;const[r,o]=this.#u(),[l,u]=[r-e,o-s],h=this.#t;return h[0]-=l,h[1]-=u,h[2]+=2*l,h[3]+=2*u,h}updateParentDimensions([t,e],s){const[r,o]=this.#u();this.#r=t,this.#s=e,this.#l=s;const[l,u]=this.#u(),h=l-r,f=u-o,p=this.#t;return p[0]-=h,p[1]-=f,p[2]+=2*h,p[3]+=2*f,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(K.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${K.svgRound(t)} ${K.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let s=0,r=0,o=0,l=0,u=0,h=0;switch(this.#e){case 90:r=e/t,o=-t/e,u=t;break;case 180:s=-1,l=-1,u=t,h=e;break;case 270:r=-e/t,o=t/e,h=e;break;default:return""}return`matrix(${s} ${r} ${o} ${l} ${K.svgRound(u)} ${K.svgRound(h)})`}getPathResizingSVGProperties([t,e,s,r]){const[o,l]=this.#u(),[u,h,f,p]=this.#t;if(Math.abs(f-o)<=K.PRECISION||Math.abs(p-l)<=K.PRECISION){const S=t+s/2-(u+f/2),x=e+r/2-(h+p/2);return{path:{"transform-origin":`${K.svgRound(t)} ${K.svgRound(e)}`,transform:`${this.rotationTransform} translate(${S} ${x})`}}}const v=(s-2*o)/(f-2*o),y=(r-2*l)/(p-2*l),w=f/s,_=p/r;return{path:{"transform-origin":`${K.svgRound(u)} ${K.svgRound(h)}`,transform:`${this.rotationTransform} scale(${w} ${_}) translate(${K.svgRound(o)} ${K.svgRound(l)}) scale(${v} ${y}) translate(${K.svgRound(-o)} ${K.svgRound(-l)})`}}}getPathResizedSVGProperties([t,e,s,r]){const[o,l]=this.#u(),u=this.#t,[h,f,p,v]=u;if(u[0]=t,u[1]=e,u[2]=s,u[3]=r,Math.abs(p-o)<=K.PRECISION||Math.abs(v-l)<=K.PRECISION){const x=t+s/2-(h+p/2),E=e+r/2-(f+v/2);for(const{line:M,points:P}of this.#i)K._translate(M,x,E,M),K._translate(P,x,E,P);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${K.svgRound(t)} ${K.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(s-2*o)/(p-2*o),w=(r-2*l)/(v-2*l),_=-y*(h+o)+t+o,S=-w*(f+l)+e+l;if(y!==1||w!==1||_!==0||S!==0)for(const{line:x,points:E}of this.#i)K._rescale(x,_,S,y,w,x),K._rescale(E,_,S,y,w,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${K.svgRound(t)} ${K.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],s){const[r,o]=s,l=this.#t,u=t-l[0],h=e-l[1];if(this.#r===r&&this.#s===o)for(const{line:f,points:p}of this.#i)K._translate(f,u,h,f),K._translate(p,u,h,p);else{const f=this.#r/r,p=this.#s/o;this.#r=r,this.#s=o;for(const{line:v,points:y}of this.#i)K._rescale(v,u,h,f,p,v),K._rescale(y,u,h,f,p,y);l[2]*=f,l[3]*=p}return l[0]=t,l[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${K.svgRound(t)} ${K.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${K.svgRound(t[0])} ${K.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Wl extends sv{#t;constructor(t){super(),this.#t=t,super.updateProperties({fill:"none",stroke:ut._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this.#t.realScale),super.updateSVGProperty(t,e)}clone(){const t=new Wl(this.#t);return t.updateAll(this),t}}class Xl extends lt{static _type="ink";static _editorType=mt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0}static initialize(t,e){ut.initialize(t,e),this._defaultDrawingOptions=new Wl(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return _t(this,"typesMap",new Map([[Et.INK_THICKNESS,"stroke-width"],[Et.INK_COLOR,"stroke"],[Et.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,s,r,o){return new rv(t,e,s,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,s,r,o,l){return ma.deserialize(t,e,s,r,o,l)}static async deserialize(t,e,s){let r=null;if(t instanceof Gl){const{data:{inkLists:l,rect:u,rotation:h,id:f,color:p,opacity:v,borderStyle:{rawWidth:y},popupRef:w},parent:{page:{pageNumber:_}}}=t;r=t={annotationType:mt.INK,color:Array.from(p),thickness:y,opacity:v,paths:{points:l},boxes:null,pageIndex:_-1,rect:u.slice(0),rotation:h,id:f,deleted:!1,popupRef:w}}const o=await super.deserialize(t,e,s);return o.annotationElementId=t.id||null,o._initialData=r,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:s}=this;e.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:s}){this._drawingOptions=Xl.getDefaultDrawingOptions({stroke:st.makeHexColor(...t),"stroke-width":e,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:s,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":l,"stroke-width":u}}=this,h={annotationType:mt.INK,color:ut._colorManager.convert(o),opacity:l,thickness:u,paths:{lines:e,points:s},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?h:this.annotationElementId&&!this.#t(h)?null:(h.id=this.annotationElementId,h)}#t(t){const{color:e,thickness:s,opacity:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((l,u)=>l!==e[u])||t.thickness!==s||t.opacity!==r||t.pageIndex!==o}renderAnnotationElement(t){const{points:e,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:e}),null}}class ql extends ut{#t=null;#e=null;#n=null;#i=null;#r=null;#s="";#l=null;#o=null;#c=!1;#u=!1;static _type="stamp";static _editorType=mt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#r=t.bitmapFile}static initialize(t,e){ut.initialize(t,e)}static get supportedTypes(){return _t(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(e=>`image/${e}`))}static get supportedTypesStr(){return _t(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,e){e.pasteEditor(mt.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#d(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#c=t.isSvg),t.file&&(this.#s=t.file.name),this.#a()}#h(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#l){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:l}=t||this.copyCanvas(null,null,!0).imageData,u=await s.guess({name:"altText",request:{data:r,width:o,height:l,channels:r.length/(o*l)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),e&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#f(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(s=>this.#d(s,!0)).finally(()=>this.#h());return}if(this.#i){const s=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(s).then(r=>this.#d(r)).finally(()=>this.#h());return}if(this.#r){const s=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(s).then(r=>this.#d(r)).finally(()=>this.#h());return}const t=document.createElement("input");t.type="file",t.accept=ql.supportedTypesStr;const e=this._uiManager._signal;this.#n=new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#d(r)}s()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:e})}).finally(()=>this.#h()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#l?.remove(),this.#l=null,this.#o&&(clearTimeout(this.#o),this.#o=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#f();return}super.rebuild(),this.div!==null&&(this.#e&&this.#l===null&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#r||this.#e)}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;if(this.width&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),this.#t?this.#a():this.#f(),this.width&&!this.annotationElementId){const[s,r]=this.parentDimensions;this.setAt(t*s,e*r,this.width*s,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#o!==null&&clearTimeout(this.#o);const t=200;this.#o=setTimeout(()=>{this.#o=null,this.#m()},t)}#a(){const{div:t}=this;let{width:e,height:s}=this.#t;const[r,o]=this.pageDimensions,l=.75;if(this.width)e=this.width*r,s=this.height*o;else if(e>l*r||s>l*o){const p=Math.min(l*r/e,l*o/s);e*=p,s*=p}const[u,h]=this.parentDimensions;this.setDims(e*u/r,s*h/o),this._uiManager.enableWaiting(!1);const f=this.#l=document.createElement("canvas");f.setAttribute("role","img"),this.addContainer(f),this.width=e/r,this.height=s/o,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#u||(this.parent.addUndoableEditor(this),this.#u=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&f.setAttribute("aria-label",this.#s)}copyCanvas(t,e,s=!1){t||(t=224);const{width:r,height:o}=this.#t,l=new Cl;let u=this.#t,h=r,f=o,p=null;if(e){if(r>e||o>e){const B=Math.min(e/r,e/o);h=Math.floor(r*B),f=Math.floor(o*B)}p=document.createElement("canvas");const y=p.width=Math.ceil(h*l.sx),w=p.height=Math.ceil(f*l.sy);this.#c||(u=this.#p(y,w));const _=p.getContext("2d");_.filter=this._uiManager.hcmFilter;let S="white",x="#cfcfd8";this._uiManager.hcmFilter!=="none"?x="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(S="#8f8f9d",x="#42414d");const E=15,M=E*l.sx,P=E*l.sy,N=new OffscreenCanvas(M*2,P*2),D=N.getContext("2d");D.fillStyle=S,D.fillRect(0,0,M*2,P*2),D.fillStyle=x,D.fillRect(0,0,M,P),D.fillRect(M,P,M,P),_.fillStyle=_.createPattern(N,"repeat"),_.fillRect(0,0,y,w),_.drawImage(u,0,0,u.width,u.height,0,0,y,w)}let v=null;if(s){let y,w;if(l.symmetric&&u.width<t&&u.height<t)y=u.width,w=u.height;else if(u=this.#t,r>t||o>t){const x=Math.min(t/r,t/o);y=Math.floor(r*x),w=Math.floor(o*x),this.#c||(u=this.#p(y,w))}const S=new OffscreenCanvas(y,w).getContext("2d",{willReadFrequently:!0});S.drawImage(u,0,0,u.width,u.height,0,0,y,w),v={width:y,height:w,data:S.getImageData(0,0,y,w).data}}return{canvas:p,width:h,height:f,imageData:v}}#p(t,e){const{width:s,height:r}=this.#t;let o=s,l=r,u=this.#t;for(;o>2*t||l>2*e;){const h=o,f=l;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const p=new OffscreenCanvas(o,l);p.getContext("2d").drawImage(u,0,0,h,f,0,0,o,l),u=p.transferToImageBitmap()}return u}#m(){const[t,e]=this.parentDimensions,{width:s,height:r}=this,o=new Cl,l=Math.ceil(s*t*o.sx),u=Math.ceil(r*e*o.sy),h=this.#l;if(!h||h.width===l&&h.height===u)return;h.width=l,h.height=u;const f=this.#c?this.#t:this.#p(l,u),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,l,u)}getImageForAltText(){return this.#l}#g(t){if(t){if(this.#c){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#c){const[e,s]=this.pageDimensions,r=Math.round(this.width*e*Fi.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*Fi.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(r,o);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,o),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,s){let r=null;if(t instanceof qd){const{data:{rect:_,rotation:S,id:x,structParent:E,popupRef:M},container:P,parent:{page:{pageNumber:N}}}=t,D=P.querySelector("canvas"),B=s.imageManager.getFromCanvas(P.id,D);D.remove();const H=(await e._structTree.getAriaAttributes(`${Nl}${x}`))?.get("aria-label")||"";r=t={annotationType:mt.STAMP,bitmapId:B.id,bitmap:B.bitmap,pageIndex:N-1,rect:_.slice(0),rotation:S,id:x,deleted:!1,accessibilityData:{decorative:!1,altText:H},isSvg:!1,structParent:E,popupRef:M}}const o=await super.deserialize(t,e,s),{rect:l,bitmap:u,bitmapUrl:h,bitmapId:f,isSvg:p,accessibilityData:v}=t;f&&s.imageManager.isValidId(f)?(o.#e=f,u&&(o.#t=u)):o.#i=h,o.#c=p;const[y,w]=o.pageDimensions;return o.width=(l[2]-l[0])/y,o.height=(l[3]-l[1])/w,o.annotationElementId=t.id||null,v&&(o.altTextData=v),o._initialData=r,o.#u=!!r,o}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:mt.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=this.#g(!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const u=this.#v(s);if(u.isSame)return null;u.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,e===null)return s;e.stamps||=new Map;const l=this.#c?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:l,serialized:s}),s.bitmap=this.#g(!1);else if(this.#c){const u=e.stamps.get(this.#e);l>u.area&&(u.area=l,u.serialized.bitmap.close(),u.serialized.bitmap=this.#g(!1))}return s}#v(t){const{pageIndex:e,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===e,o=(t.accessibilityData?.alt||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}}class pn{#t;#e=!1;#n=null;#i=null;#r=null;#s=new Map;#l=!1;#o=!1;#c=!1;#u=null;#d=null;#h=null;#f=null;#a;static _initialized=!1;static#p=new Map([Qt,Xl,ql,$t].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:s,structTreeLayer:r,accessibilityManager:o,annotationLayer:l,drawLayer:u,textLayer:h,viewport:f,l10n:p}){const v=[...pn.#p.values()];if(!pn._initialized){pn._initialized=!0;for(const y of v)y.initialize(p,t)}t.registerEditorTypes(v),this.#a=t,this.pageIndex=e,this.div=s,this.#t=o,this.#n=l,this.viewport=f,this.#h=h,this.drawLayer=u,this._structTree=r,this.#a.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#a.getMode()===mt.NONE}updateToolbar(t){this.#a.updateToolbar(t)}updateMode(t=this.#a.getMode()){switch(this.#y(),t){case mt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case mt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case mt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const s of pn.#p.values())e.toggle(`${s._type}Editing`,t===s._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#a.setEditingState(t)}addCommands(t){this.#a.addCommands(t)}cleanUndoStack(t){this.#a.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const s of this.#s.values())s.enableEditing(),s.show(!0),s.annotationElementId&&(this.#a.removeChangedExistingAnnotation(s),t.add(s.annotationElementId));if(!this.#n){this.#c=!1;return}const e=this.#n.getEditableAnnotations();for(const s of e){if(s.hide(),this.#a.isDeletedAnnotationElement(s.data.id)||t.has(s.data.id))continue;const r=await this.deserialize(s);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1}disable(){this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const r of this.#s.values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){t.set(r.annotationElementId,r);continue}else e.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}if(this.#n){const r=this.#n.getEditableAnnotations();for(const o of r){const{id:l}=o.data;if(this.#a.isDeletedAnnotationElement(l))continue;let u=e.get(l);if(u){u.resetAnnotationElement(o),u.show(!1),o.show();continue}u=t.get(l),u&&(this.#a.addChangedExistingAnnotation(u),u.renderAnnotationElement(o)&&u.show(!1)),o.show()}}this.#y(),this.isEmpty&&(this.div.hidden=!0);const{classList:s}=this.div;for(const r of pn.#p.values())s.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#a.getActive()!==t&&this.#a.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#a.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#m.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#m(t){this.#a.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:s}=ge.platform;if(t.button!==0||t.ctrlKey&&s)return;this.#a.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),$t.startHighlighting(this,this.#a.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#a._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#a.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#s.set(t.id,t);const{annotationElementId:e}=t;e&&this.#a.isDeletedAnnotationElement(e)&&this.#a.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#a.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#a.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#a.addDeletedAnnotationElement(t.annotationElementId),ut.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#a.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#a.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#r&&(t._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#a._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),s=()=>{t.remove()};this.addCommands({cmd:e,undo:s,mustExec:!1})}getNextId(){return this.#a.getId()}get#g(){return pn.#p.get(this.#a.getMode())}combinedSignal(t){return this.#a.combinedSignal(t)}#v(t){const e=this.#g;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#g?.canCreateNewEmptyEditor()}pasteEditor(t,e){this.#a.updateToolbar(t),this.#a.updateMode(t);const{offsetX:s,offsetY:r}=this.#A(),o=this.getNextId(),l=this.#v({parent:this,id:o,x:s,y:r,uiManager:this.#a,isCentered:!0,...e});l&&this.add(l)}async deserialize(t){return await pn.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#a)||null}createAndAddNewEditor(t,e,s={}){const r=this.getNextId(),o=this.#v({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#a,isCentered:e,...s});return o&&this.add(o),o}#A(){const{x:t,y:e,width:s,height:r}=this.div.getBoundingClientRect(),o=Math.max(0,t),l=Math.max(0,e),u=Math.min(window.innerWidth,t+s),h=Math.min(window.innerHeight,e+r),f=(o+u)/2-t,p=(l+h)/2-e,[v,y]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:v,offsetY:y}}addNewEditor(){this.createAndAddNewEditor(this.#A(),!0)}setSelected(t){this.#a.setSelected(t)}toggleSelected(t){this.#a.toggleSelected(t)}unselect(t){this.#a.unselect(t)}pointerup(t){const{isMac:e}=ge.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&this.#l&&(this.#l=!1,!(this.#g?.isDrawer&&this.#g.supportMultipleDrawings))){if(!this.#e){this.#e=!0;return}if(this.#a.getMode()===mt.STAMP){this.#a.unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){if(this.#a.getMode()===mt.HIGHLIGHT&&this.enableTextSelection(),this.#l){this.#l=!1;return}const{isMac:e}=ge.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#l=!0,this.#g?.isDrawer){this.startDrawingSession(t);return}const s=this.#a.getActive();this.#e=!s||s.isEmpty()}startDrawingSession(t){if(this.div.focus(),this.#u){this.#g.startDrawing(this,this.#a,!1,t);return}this.#a.setCurrentDrawingSession(this),this.#u=new AbortController;const e=this.#a.combinedSignal(this.#u);this.div.addEventListener("blur",({relatedTarget:s})=>{s&&!this.div.contains(s)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#g.startDrawing(this,this.#a,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#u?(this.#a.setCurrentDrawingSession(null),this.#u.abort(),this.#u=null,this.#d=null,this.#g.endDrawing(t)):null}findNewParent(t,e,s){const r=this.#a.findParent(e,s);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#u?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#u&&this.#g.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#a.getActive()?.parent===this&&(this.#a.commitOrRemove(),this.#a.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const t of this.#s.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#a.removeLayer(this)}#y(){for(const t of this.#s.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,ei(this.div,t);for(const e of this.#a.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#a.commitOrRemove(),this.#y();const e=this.viewport.rotation,s=t.rotation;if(this.viewport=t,ei(this.div,{rotation:s}),e!==s)for(const r of this.#s.values())r.rotate(s)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#a.viewParameters.realScale}}class fe{#t=null;#e=0;#n=new Map;#i=new Map;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#n.size>0)for(const e of this.#n.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return _t(this,"_svgFactory",new Vl)}static#r(t,[e,s,r,o]){const{style:l}=t;l.top=`${100*s}%`,l.left=`${100*e}%`,l.width=`${100*r}%`,l.height=`${100*o}%`}#s(){const t=fe._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#l(t,e){const s=fe._svgFactory.createElement("clipPath");t.append(s);const r=`clip_${e}`;s.setAttribute("id",r),s.setAttribute("clipPathUnits","objectBoundingBox");const o=fe._svgFactory.createElement("use");return s.append(o),o.setAttribute("href",`#${e}`),o.classList.add("clip"),r}#o(t,e){for(const[s,r]of Object.entries(e))r===null?t.removeAttribute(s):t.setAttribute(s,r)}draw(t,e=!1,s=!1){const r=this.#e++,o=this.#s(),l=fe._svgFactory.createElement("defs");o.append(l);const u=fe._svgFactory.createElement("path");l.append(u);const h=`path_p${this.pageIndex}_${r}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(r,u);const f=s?this.#l(l,h):null,p=fe._svgFactory.createElement("use");return o.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(o,t),this.#n.set(r,o),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,e){const s=this.#e++,r=this.#s(),o=fe._svgFactory.createElement("defs");r.append(o);const l=fe._svgFactory.createElement("path");o.append(l);const u=`path_p${this.pageIndex}_${s}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const v=fe._svgFactory.createElement("mask");o.append(v),h=`mask_p${this.pageIndex}_${s}`,v.setAttribute("id",h),v.setAttribute("maskUnits","objectBoundingBox");const y=fe._svgFactory.createElement("rect");v.append(y),y.setAttribute("width","1"),y.setAttribute("height","1"),y.setAttribute("fill","white");const w=fe._svgFactory.createElement("use");v.append(w),w.setAttribute("href",`#${u}`),w.setAttribute("stroke","none"),w.setAttribute("fill","black"),w.setAttribute("fill-rule","nonzero"),w.classList.add("mask")}const f=fe._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${u}`),h&&f.setAttribute("mask",`url(#${h})`);const p=f.cloneNode();return r.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#n.set(s,r),s}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:s,bbox:r,rootClass:o,path:l}=e,u=typeof t=="number"?this.#n.get(t):t;if(u){if(s&&this.#o(u,s),r&&fe.#r(u,r),o){const{classList:h}=u;for(const[f,p]of Object.entries(o))h.toggle(f,p)}if(l){const f=u.firstChild.firstChild;this.#o(f,l)}}}updateParent(t,e){if(e===this)return;const s=this.#n.get(t);s&&(e.#t.append(s),this.#n.delete(t),e.#n.set(t,s))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#n.get(t).remove(),this.#n.delete(t))}destroy(){this.#t=null;for(const t of this.#n.values())t.remove();this.#n.clear(),this.#i.clear()}}globalThis.pdfjsTestingUtils={HighlightOutliner:Rl};dt.AbortException;dt.AnnotationEditorLayer;dt.AnnotationEditorParamsType;dt.AnnotationEditorType;dt.AnnotationEditorUIManager;dt.AnnotationLayer;dt.AnnotationMode;dt.ColorPicker;dt.DOMSVGFactory;dt.DrawLayer;dt.FeatureTest;var av=dt.GlobalWorkerOptions;dt.ImageKind;dt.InvalidPDFException;dt.MissingPDFException;dt.OPS;dt.OutputScale;dt.PDFDataRangeTransport;dt.PDFDateString;dt.PDFWorker;dt.PasswordResponses;dt.PermissionFlag;dt.PixelsPerInch;dt.RenderingCancelledException;dt.TextLayer;dt.TouchManager;dt.UnexpectedResponseException;dt.Util;dt.VerbosityLevel;dt.XfaLayer;dt.build;dt.createValidAbsoluteUrl;dt.fetchData;var ov=dt.getDocument;dt.getFilenameFromUrl;dt.getPdfFilenameFromUrl;dt.getXfaPageViewport;dt.isDataScheme;dt.isPdfFile;dt.noContextMenu;dt.normalizeUnicode;dt.setLayerDimensions;dt.shadow;dt.stopEvent;var lv=dt.version;av.workerSrc=`//unpkg.com/pdfjs-dist@${lv}/build/pdf.worker.min.js`;const uv=async g=>{try{if(!g||g.type!=="application/pdf")throw new Error("Please select a valid PDF file");const t=await g.arrayBuffer(),s=await ov({data:t}).promise;let r="";const o=s.numPages;for(let h=1;h<=o;h++)try{const v=(await(await s.getPage(h)).getTextContent()).items.map(y=>y.str).join(" ");r+=v+`
`}catch(f){console.warn(`Error extracting text from page ${h}:`,f)}if(!r||r.trim().length===0)throw new Error("No text content found in the PDF");let l={},u={};try{l=await s.getMetadata(),u=l?.info||{}}catch(h){console.warn("Could not extract PDF metadata:",h)}return{text:r.trim(),pages:o,info:u,metadata:l}}catch(t){throw console.error("PDF parsing error:",t),t.name==="PasswordException"?new Error("This PDF is password protected. Please provide the password."):t.name==="InvalidPDFException"?new Error("The selected file is not a valid PDF or is corrupted."):t.message.includes("Worker")?new Error("PDF processing worker failed to load. Please refresh the page and try again."):t.message.includes("timeout")?new Error("PDF processing timed out. The file might be too large or complex."):new Error(`Failed to parse PDF: ${t.message}`)}},cv=g=>{if(!g)return{isValid:!1,error:"No file selected"};if(g.type!=="application/pdf")return{isValid:!1,error:"Please select a PDF file"};const t=10*1024*1024;return g.size>t?{isValid:!1,error:"File size must be less than 10MB"}:{isValid:!0,error:null}},hv=g=>{if(g===0)return"0 Bytes";const t=1024,e=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(g)/Math.log(t));return parseFloat((g/Math.pow(t,s)).toFixed(2))+" "+e[s]},dv=({onPDFTextExtracted:g,onError:t})=>{const[e,s]=je.useState(!1),[r,o]=je.useState(!1),[l,u]=je.useState(null),[h,f]=je.useState(null),p=je.useCallback(async E=>{try{const M=cv(E);if(!M.isValid){t(M.error);return}u(E),o(!0);const P=await uv(E);f(P),g(P.text)}catch(M){t(M.message),u(null),f(null)}finally{o(!1)}},[g,t]),v=E=>{const M=E.target.files[0];M&&p(M)},y=E=>{E.preventDefault(),s(!0)},w=E=>{E.preventDefault(),s(!1)},_=E=>{E.preventDefault(),s(!1);const M=E.dataTransfer.files;M.length>0&&p(M[0])},S=()=>{u(null),f(null),g("")},x=()=>{document.getElementById("pdf-file-input").click()};return U.jsxs("div",{className:"pdf-upload-container",children:[U.jsx("h3",{style:{marginBottom:"15px",color:"#333"},children:"PDF Upload"}),U.jsx("input",{id:"pdf-file-input",type:"file",accept:".pdf",onChange:v,style:{display:"none"}}),!l&&U.jsx("div",{className:`drag-drop-area ${e?"drag-over":""}`,onDragOver:y,onDragLeave:w,onDrop:_,onClick:x,children:U.jsxs("div",{className:"drag-drop-content",children:[U.jsx("div",{className:"upload-icon",children:"📄"}),U.jsxs("p",{className:"drag-drop-text",children:[U.jsx("strong",{children:"Click to select"})," or drag and drop a PDF file here"]}),U.jsx("p",{className:"drag-drop-hint",children:"Supports PDF files up to 10MB"})]})}),l&&U.jsxs("div",{className:"selected-file",children:[U.jsxs("div",{className:"file-info",children:[U.jsx("div",{className:"file-icon",children:"📄"}),U.jsxs("div",{className:"file-details",children:[U.jsx("h4",{className:"file-name",children:l.name}),U.jsx("p",{className:"file-size",children:hv(l.size)}),h&&U.jsxs("p",{className:"file-pages",children:[h.pages," page",h.pages!==1?"s":""]})]})]}),U.jsx("div",{className:"file-actions",children:U.jsx("button",{className:"button secondary",onClick:S,disabled:r,children:"Remove"})})]}),r&&U.jsxs("div",{className:"processing-state",children:[U.jsx("div",{className:"spinner"}),U.jsx("p",{children:"Processing PDF..."})]}),h&&U.jsxs("div",{className:"pdf-metadata",children:[U.jsx("h4",{style:{marginBottom:"10px",color:"#666"},children:"PDF Information"}),U.jsxs("div",{className:"metadata-grid",children:[U.jsxs("div",{className:"metadata-item",children:[U.jsx("span",{className:"metadata-label",children:"Title:"}),U.jsx("span",{className:"metadata-value",children:h.info?.Title||"Untitled"})]}),U.jsxs("div",{className:"metadata-item",children:[U.jsx("span",{className:"metadata-label",children:"Author:"}),U.jsx("span",{className:"metadata-value",children:h.info?.Author||"Unknown"})]}),U.jsxs("div",{className:"metadata-item",children:[U.jsx("span",{className:"metadata-label",children:"Pages:"}),U.jsx("span",{className:"metadata-value",children:h.pages})]}),h.info?.Subject&&U.jsxs("div",{className:"metadata-item",children:[U.jsx("span",{className:"metadata-label",children:"Subject:"}),U.jsx("span",{className:"metadata-value",children:h.info.Subject})]})]})]})]})},fv=()=>{const[g,t]=je.useState(""),[e,s]=je.useState([]),[r,o]=je.useState(""),[l,u]=je.useState(""),[h,f]=je.useState("manual"),p=P=>{t(P.target.value),f("manual"),u("")},v=P=>{t(P),f("pdf"),u("")},y=P=>{u(P)},w=()=>{t(""),s([]),f("manual"),u("")},_=()=>{r&&!e.includes(r)&&(s([...e,r]),o(""))},S=P=>{s(e.filter(N=>N!==P))},x=je.useCallback((P,N)=>{navigator.clipboard.writeText(P).then(()=>{alert(`Copied text with ${N} spacing!`)}).catch(()=>{const D=document.createElement("textarea");D.value=P,document.body.appendChild(D),D.select(),document.execCommand("copy"),document.body.removeChild(D),alert(`Copied text with ${N} spacing!`)})},[]),M=(P=>{if(!P||P.trim().length===0)return{words:0,characters:0,spaces:0};const N=P.trim().split(/\s+/).length,D=P.length,B=(P.match(/ /g)||[]).length;return{words:N,characters:D,spaces:B}})(g);return U.jsxs("div",{className:"container",children:[U.jsxs("div",{className:"header",children:[U.jsx("h1",{children:"AI Content Humanizer"}),U.jsx("p",{children:"Transform your text using Unicode whitespace characters to potentially evade AI content detection tools"})]}),l&&U.jsxs("div",{className:"error-message",children:[U.jsx("span",{className:"error-icon",children:"⚠️"}),l,U.jsx("button",{className:"error-close",onClick:()=>u(""),style:{background:"none",border:"none",color:"inherit",cursor:"pointer",marginLeft:"10px"},children:"×"})]}),U.jsx("div",{className:"card",children:U.jsx(dv,{onPDFTextExtracted:v,onError:y})}),U.jsxs("div",{className:"card",children:[U.jsxs("h2",{children:["Text Input ",h==="pdf"&&U.jsx("span",{className:"source-badge",children:"From PDF"})]}),U.jsxs("div",{className:"stats",children:[U.jsxs("span",{children:["Words: ",M.words]}),U.jsxs("span",{children:["Characters: ",M.characters]}),U.jsxs("span",{children:["Spaces: ",M.spaces]})]}),U.jsx("textarea",{className:"textarea",value:g,onChange:p,placeholder:"Enter your text here or upload a PDF above to experiment with Unicode spacing..."})]}),U.jsxs("div",{className:"card",children:[U.jsx("h2",{children:"Controls & Actions"}),U.jsx("div",{className:"button-group",children:U.jsx("button",{className:"button danger",onClick:w,children:"Clear Text"})}),U.jsx("h3",{style:{marginTop:"20px",marginBottom:"15px"},children:"Custom Unicode Spacing"}),U.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"15px",flexWrap:"wrap"},children:[U.jsxs("select",{value:r,onChange:P=>o(P.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ced4da"},children:[U.jsx("option",{value:"",children:"Select spacing type"}),Object.keys(ta).map(P=>U.jsx("option",{value:P,children:P},P))]}),U.jsx("button",{className:"button",onClick:_,children:"Add"})]}),U.jsxs("div",{style:{marginBottom:"15px"},children:[U.jsx("p",{style:{fontSize:"14px",color:"#6c757d",marginBottom:"10px"},children:"Selected combinations:"}),U.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[e.map(P=>U.jsxs("span",{style:{background:"#e3f2fd",color:"#1976d2",padding:"4px 12px",borderRadius:"20px",fontSize:"12px",cursor:"pointer",border:"1px solid #bbdefb"},onClick:()=>S(P),children:[P," ×"]},P)),e.length===0&&U.jsx("span",{style:{color:"#6c757d",fontStyle:"italic"},children:"No custom combinations selected"})]})]}),U.jsx("h3",{style:{marginTop:"20px",marginBottom:"15px"},children:"Quick Copy with Different Spacing"}),U.jsx("div",{className:"button-group",children:Object.entries(ta).map(([P,N])=>U.jsx("button",{className:"button secondary",onClick:()=>x(g.split(" ").join(N),P),children:P},P))})]}),U.jsxs("div",{className:"card",children:[U.jsx("h2",{children:"Transformed Output"}),U.jsx("h3",{style:{marginTop:"20px",marginBottom:"15px"},children:"Text Transformations"}),U.jsx("div",{className:"output-grid",children:Object.entries(ta).map(([P,N])=>U.jsxs("div",{className:"output-item",children:[U.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[U.jsx("h3",{children:P}),U.jsx("span",{style:{fontSize:"10px",color:"#6c757d",fontFamily:"monospace"},children:rg(N)})]}),U.jsx("div",{className:"output-text",children:g?g.split(" ").join(N):"Enter some text to see the transformation"}),U.jsx("p",{style:{fontSize:"12px",color:"#6c757d",textAlign:"center",margin:"10px 0"},children:sg[P]}),U.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:U.jsx("button",{className:"button",style:{padding:"6px 12px",fontSize:"12px"},onClick:()=>x(g.split(" ").join(N),P),children:"Copy"})})]},P))}),U.jsx("h3",{style:{marginTop:"30px",marginBottom:"15px"},children:"Custom Spacing Output"}),U.jsxs("div",{className:"output-item",children:[U.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[U.jsx("h3",{children:"Combined Unicode Spacing"}),U.jsx("div",{style:{display:"flex",gap:"5px"},children:e.map(P=>U.jsx("span",{style:{background:"#e3f2fd",color:"#1976d2",padding:"2px 8px",borderRadius:"12px",fontSize:"10px",border:"1px solid #bbdefb"},children:P},P))})]}),U.jsx("div",{className:"output-text",children:g&&e.length>0?td(e,g,!1):g?"Select custom spacing combinations":"Enter some text and select custom spacing combinations"}),U.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:"10px"},children:U.jsx("button",{className:"button",onClick:()=>{if(g&&e.length>0){const P=td(e,g,!1);x(P,"Custom")}},disabled:!g||e.length===0,children:"Copy Custom"})})]})]})]})};ig.createRoot(document.getElementById("root")).render(U.jsx(Kp.StrictMode,{children:U.jsx(fv,{})}));
